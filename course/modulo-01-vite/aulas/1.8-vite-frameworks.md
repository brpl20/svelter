# 1.8 â€” Vite para Diferentes Frameworks

> Entenda como o Vite se integra com React, Vue e Svelte, preparando-se para o restante do curso.

## Objetivos da Aula

- Entender como plugins de framework funcionam
- Comparar a integraÃ§Ã£o do Vite com React, Vue e Svelte
- Configurar um projeto Svelte com Vite (preparaÃ§Ã£o para o prÃ³ximo mÃ³dulo)
- Conhecer o `vite-plugin-svelte` em detalhes

---

## Como Plugins de Framework Funcionam

Cada framework precisa de transformaÃ§Ãµes especÃ­ficas:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 PLUGINS DE FRAMEWORK                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  React (.jsx/.tsx)                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚    JSX       â”‚â”€â”€â”€â–¶â”‚   Babel ou   â”‚â”€â”€â”€â–¶â”‚  JavaScript  â”‚         â”‚
â”‚  â”‚  <App />     â”‚    â”‚    esbuild   â”‚    â”‚  React.createElement() â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                     â”‚
â”‚  Vue (.vue)                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   SFC Vue    â”‚â”€â”€â”€â–¶â”‚   @vue/      â”‚â”€â”€â”€â–¶â”‚  JavaScript  â”‚         â”‚
â”‚  â”‚  <template>  â”‚    â”‚ compiler-sfc â”‚    â”‚  + CSS       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                     â”‚
â”‚  Svelte (.svelte)                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Componente   â”‚â”€â”€â”€â–¶â”‚   Svelte     â”‚â”€â”€â”€â–¶â”‚  JavaScript  â”‚         â”‚
â”‚  â”‚  Svelte      â”‚    â”‚  Compiler    â”‚    â”‚  Vanilla     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Vite + React

### Setup

```bash
npm create vite@latest meu-app-react -- --template react
# ou com TypeScript
npm create vite@latest meu-app-react -- --template react-ts
```

### ConfiguraÃ§Ã£o

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [
    react({
      // OpÃ§Ãµes do Babel
      babel: {
        plugins: ['@emotion/babel-plugin']
      },
      // Fast Refresh
      fastRefresh: true
    })
  ]
})
```

### Alternativa: React + SWC (mais rÃ¡pido)

```bash
npm create vite@latest meu-app -- --template react-swc
```

```javascript
import react from '@vitejs/plugin-react-swc'

export default defineConfig({
  plugins: [react()]
})
```

### Estrutura TÃ­pica

```
src/
â”œâ”€â”€ App.jsx
â”œâ”€â”€ main.jsx
â”œâ”€â”€ index.css
â””â”€â”€ components/
    â””â”€â”€ Button.jsx
```

```jsx
// main.jsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
)
```

---

## Vite + Vue

### Setup

```bash
npm create vite@latest meu-app-vue -- --template vue
# ou com TypeScript
npm create vite@latest meu-app-vue -- --template vue-ts
```

### ConfiguraÃ§Ã£o

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [
    vue({
      // OpÃ§Ãµes do compilador Vue
      template: {
        compilerOptions: {
          // Tratar tags com hÃ­fen como custom elements
          isCustomElement: (tag) => tag.includes('-')
        }
      }
    })
  ]
})
```

### Estrutura TÃ­pica

```
src/
â”œâ”€â”€ App.vue
â”œâ”€â”€ main.js
â”œâ”€â”€ style.css
â””â”€â”€ components/
    â””â”€â”€ Button.vue
```

```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import './style.css'

createApp(App).mount('#app')
```

```vue
<!-- App.vue -->
<script setup>
import { ref } from 'vue'
const count = ref(0)
</script>

<template>
  <button @click="count++">Count: {{ count }}</button>
</template>

<style scoped>
button { color: blue; }
</style>
```

---

## Vite + Svelte â­

Este Ã© o foco do nosso curso!

### Setup

```bash
npm create vite@latest meu-app-svelte -- --template svelte
# ou com TypeScript
npm create vite@latest meu-app-svelte -- --template svelte-ts
```

### ConfiguraÃ§Ã£o BÃ¡sica

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import { svelte } from '@sveltejs/vite-plugin-svelte'

export default defineConfig({
  plugins: [svelte()]
})
```

### ConfiguraÃ§Ã£o AvanÃ§ada

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import { svelte } from '@sveltejs/vite-plugin-svelte'

export default defineConfig({
  plugins: [
    svelte({
      // OpÃ§Ãµes do compilador Svelte
      compilerOptions: {
        // Modo de desenvolvimento
        dev: true,

        // CSS em arquivo separado ou injetado
        css: 'injected', // 'external' | 'injected' | 'none'

        // Habilitar runes (Svelte 5)
        runes: true,

        // Gerar cÃ³digo acessÃ­vel
        accessors: false,

        // Preservar espaÃ§os em branco
        preserveWhitespace: false
      },

      // PrÃ©-processadores
      preprocess: [
        // vitePreprocess() // Para TypeScript, SCSS, etc.
      ],

      // Hot Module Replacement
      hot: {
        // Preservar estado local durante HMR
        preserveLocalState: true
      },

      // ExtensÃµes de arquivo
      extensions: ['.svelte'],

      // Modo de emissÃ£o de CSS
      emitCss: true
    })
  ]
})
```

### Estrutura de um Projeto Svelte

```
meu-app-svelte/
â”œâ”€â”€ index.html
â”œâ”€â”€ package.json
â”œâ”€â”€ svelte.config.js          # ConfiguraÃ§Ã£o do Svelte
â”œâ”€â”€ vite.config.js            # ConfiguraÃ§Ã£o do Vite
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.svelte            # Componente raiz
â”‚   â”œâ”€â”€ main.js               # Ponto de entrada
â”‚   â”œâ”€â”€ app.css               # Estilos globais
â”‚   â”œâ”€â”€ lib/                  # Componentes reutilizÃ¡veis
â”‚   â”‚   â””â”€â”€ Counter.svelte
â”‚   â””â”€â”€ vite-env.d.ts         # Tipos do Vite (TS)
â””â”€â”€ public/
    â””â”€â”€ vite.svg
```

### Arquivos Principais

```html
<!-- index.html -->
<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meu App Svelte</title>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
```

```javascript
// src/main.js
import './app.css'
import App from './App.svelte'

const app = new App({
  target: document.getElementById('app')
})

export default app
```

```svelte
<!-- src/App.svelte -->
<script>
  import Counter from './lib/Counter.svelte'

  let name = 'mundo'
</script>

<main>
  <h1>OlÃ¡, {name}!</h1>
  <Counter />
</main>

<style>
  main {
    text-align: center;
    padding: 2rem;
  }

  h1 {
    color: #ff3e00;
  }
</style>
```

```svelte
<!-- src/lib/Counter.svelte -->
<script>
  let count = 0

  function increment() {
    count += 1
  }
</script>

<button on:click={increment}>
  Cliques: {count}
</button>

<style>
  button {
    font-size: 1.5rem;
    padding: 0.5rem 1rem;
    cursor: pointer;
  }
</style>
```

---

## Comparativo: O Mesmo Componente

### React

```jsx
// Counter.jsx
import { useState } from 'react'
import './Counter.css'

export function Counter() {
  const [count, setCount] = useState(0)

  return (
    <button onClick={() => setCount(c => c + 1)}>
      Cliques: {count}
    </button>
  )
}
```

### Vue

```vue
<!-- Counter.vue -->
<script setup>
import { ref } from 'vue'
const count = ref(0)
</script>

<template>
  <button @click="count++">
    Cliques: {{ count }}
  </button>
</template>

<style scoped>
button { /* estilos */ }
</style>
```

### Svelte

```svelte
<!-- Counter.svelte -->
<script>
  let count = 0
</script>

<button on:click={() => count++}>
  Cliques: {count}
</button>

<style>
  button { /* estilos - escopo automÃ¡tico! */ }
</style>
```

### ComparaÃ§Ã£o

| Aspecto | React | Vue | Svelte |
|---------|-------|-----|--------|
| **Estado** | `useState` hook | `ref()` | `let` simples |
| **Eventos** | `onClick` | `@click` | `on:click` |
| **InterpolaÃ§Ã£o** | `{valor}` | `{{ valor }}` | `{valor}` |
| **CSS** | Externo/CSS-in-JS | `<style scoped>` | `<style>` (escopo auto) |
| **Bundle** | Runtime React | Runtime Vue | Zero runtime |

---

## PrÃ©-processadores com Svelte

### InstalaÃ§Ã£o do vitePreprocess

```bash
npm install -D @sveltejs/vite-plugin-svelte
npm install -D sass  # Para SCSS
npm install -D typescript  # Para TS
```

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import { svelte } from '@sveltejs/vite-plugin-svelte'

export default defineConfig({
  plugins: [
    svelte({
      preprocess: vitePreprocess()
    })
  ]
})
```

### Usando TypeScript

```svelte
<!-- Componente.svelte -->
<script lang="ts">
  interface User {
    name: string
    age: number
  }

  export let user: User

  let count: number = 0
</script>

<p>{user.name} tem {user.age} anos</p>
```

### Usando SCSS

```svelte
<!-- Componente.svelte -->
<style lang="scss">
  $primary: #ff3e00;

  button {
    background: $primary;

    &:hover {
      background: darken($primary, 10%);
    }
  }
</style>
```

---

## svelte.config.js

AlÃ©m do `vite.config.js`, projetos Svelte tÃªm um arquivo de configuraÃ§Ã£o especÃ­fico:

```javascript
// svelte.config.js
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte'

export default {
  // PrÃ©-processadores (TS, SCSS, etc)
  preprocess: vitePreprocess(),

  // OpÃ§Ãµes do compilador
  compilerOptions: {
    // Svelte 5 runes
    runes: true
  },

  // Avisos a ignorar
  onwarn: (warning, handler) => {
    // Ignora avisos de acessibilidade especÃ­ficos
    if (warning.code === 'a11y-click-events-have-key-events') return
    handler(warning)
  },

  // ExtensÃµes de arquivo
  extensions: ['.svelte']
}
```

---

## ğŸ¯ Mini-Projeto: Migrando para Svelte

Vamos criar a versÃ£o Svelte do nosso Dashboard!

### Passo 1: Criar Projeto Svelte

```bash
# Na pasta do curso
npm create vite@latest dashboard-svelte -- --template svelte

cd dashboard-svelte
npm install
```

### Passo 2: Configurar Aliases

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import { svelte } from '@sveltejs/vite-plugin-svelte'
import path from 'path'

export default defineConfig({
  plugins: [svelte()],

  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@components': path.resolve(__dirname, './src/components'),
      '@utils': path.resolve(__dirname, './src/utils')
    }
  },

  server: {
    port: 3000,
    open: true
  }
})
```

### Passo 3: Componente PerformanceCard

```svelte
<!-- src/components/PerformanceCard.svelte -->
<script>
  export let titulo = ''
  export let valor = 0
  export let unidade = 'ms'
</script>

<div class="performance-card">
  <h3 class="card-title">{titulo}</h3>
  <p class="card-value">
    {valor}<span class="card-unit">{unidade}</span>
  </p>
</div>

<style>
  .performance-card {
    background: #242424;
    border-radius: 12px;
    padding: 1.5rem;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .performance-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
  }

  .card-title {
    font-size: 0.875rem;
    color: #a0a0a0;
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .card-value {
    font-size: 2rem;
    font-weight: 700;
    color: #4ade80;
    margin: 0;
  }

  .card-unit {
    font-size: 0.875rem;
    color: #a0a0a0;
    margin-left: 0.25rem;
  }
</style>
```

### Passo 4: Componente App Principal

```svelte
<!-- src/App.svelte -->
<script>
  import { onMount } from 'svelte'
  import PerformanceCard from '@components/PerformanceCard.svelte'

  let metricas = {
    domReady: 0,
    pageLoad: 0,
    fcp: 'N/A',
    renderTime: 0
  }

  const inicioRender = performance.now()

  onMount(() => {
    // Calcula tempo de render
    metricas.renderTime = (performance.now() - inicioRender).toFixed(2)

    // Espera pÃ¡gina carregar para mÃ©tricas completas
    window.addEventListener('load', () => {
      const timing = performance.timing
      metricas.domReady = timing.domContentLoadedEventEnd - timing.navigationStart
      metricas.pageLoad = timing.loadEventEnd - timing.navigationStart

      // FCP
      const paintEntries = performance.getEntriesByType('paint')
      const fcp = paintEntries.find(e => e.name === 'first-contentful-paint')
      metricas.fcp = fcp ? fcp.startTime.toFixed(2) : 'N/A'
    })
  })
</script>

<div class="dashboard">
  <header class="header">
    <img src="/vite.svg" class="logo" alt="Vite logo" />
    <h1>Dashboard Svelte</h1>
    <p class="subtitle">Agora com o poder do Svelte! âš¡</p>
  </header>

  <main class="main">
    <section class="section">
      <h2>ğŸ“Š MÃ©tricas de Performance</h2>
      <div class="cards-grid">
        <PerformanceCard titulo="DOM Ready" valor={metricas.domReady} />
        <PerformanceCard titulo="Page Load" valor={metricas.pageLoad} />
        <PerformanceCard titulo="FCP" valor={metricas.fcp} />
        <PerformanceCard titulo="Render" valor={metricas.renderTime} />
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>Feito com Svelte + Vite</p>
  </footer>
</div>

<style>
  :global(body) {
    margin: 0;
    font-family: Inter, system-ui, -apple-system, sans-serif;
    background-color: #0f0f0f;
    color: #ffffff;
  }

  .dashboard {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .logo {
    width: 80px;
    height: 80px;
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  .header h1 {
    font-size: 2.5rem;
    margin: 1rem 0 0.5rem;
    background: linear-gradient(135deg, #ff3e00, #ff8a00);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .subtitle {
    color: #a0a0a0;
    margin: 0;
  }

  .section {
    margin-bottom: 2rem;
  }

  .section h2 {
    margin-bottom: 1rem;
    font-size: 1.25rem;
    color: #a0a0a0;
  }

  .cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
  }

  .footer {
    margin-top: 3rem;
    text-align: center;
    color: #666;
  }
</style>
```

### Passo 5: Testar

```bash
npm run dev
# Acesse http://localhost:3000

npm run build
# Observe: bundle MUITO menor que React/Vue!
```

---

## âœ… Desafio da Aula

### Objetivo
Adicionar um componente Counter interativo ao Dashboard Svelte.

### InstruÃ§Ãµes

1. Crie `src/components/Counter.svelte`
2. O contador deve ter botÃµes de + e -
3. Adicione o componente ao App.svelte
4. **BÃ´nus:** Adicione uma animaÃ§Ã£o quando o valor muda

### Spec de VerificaÃ§Ã£o

- [ ] O contador aparece no dashboard
- [ ] Clicar em + aumenta o valor
- [ ] Clicar em - diminui o valor
- [ ] **BÃ´nus:** HÃ¡ animaÃ§Ã£o visual na mudanÃ§a

### SoluÃ§Ã£o

<details>
<summary>ğŸ” Clique para ver a soluÃ§Ã£o</summary>

```svelte
<!-- src/components/Counter.svelte -->
<script>
  let count = 0

  function increment() {
    count += 1
  }

  function decrement() {
    count -= 1
  }
</script>

<div class="counter-card">
  <h3>Contador Interativo</h3>
  <div class="counter-display">
    <button on:click={decrement} class="btn-minus">âˆ’</button>
    <span class="count" class:bump={count !== 0}>{count}</span>
    <button on:click={increment} class="btn-plus">+</button>
  </div>
</div>

<style>
  .counter-card {
    background: #242424;
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
  }

  h3 {
    margin: 0 0 1rem;
    color: #a0a0a0;
    font-size: 0.875rem;
    text-transform: uppercase;
  }

  .counter-display {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
  }

  button {
    width: 48px;
    height: 48px;
    border: none;
    border-radius: 50%;
    font-size: 1.5rem;
    cursor: pointer;
    transition: transform 0.1s, background 0.2s;
  }

  button:hover {
    transform: scale(1.1);
  }

  button:active {
    transform: scale(0.95);
  }

  .btn-plus {
    background: #4ade80;
    color: #000;
  }

  .btn-minus {
    background: #ef4444;
    color: #fff;
  }

  .count {
    font-size: 3rem;
    font-weight: 700;
    min-width: 80px;
    color: #fff;
    transition: transform 0.1s;
  }

  .count.bump {
    animation: bump 0.1s ease-out;
  }

  @keyframes bump {
    50% { transform: scale(1.2); }
  }
</style>
```

No App.svelte, adicione:
```svelte
<script>
  import Counter from '@components/Counter.svelte'
</script>

<!-- Na section -->
<Counter />
```

</details>

---

## ğŸ‰ ConclusÃ£o do MÃ³dulo 1

ParabÃ©ns! VocÃª completou o MÃ³dulo 1 sobre **Fundamentos do Vite**.

### O que vocÃª aprendeu

- âœ… Por que o Vite Ã© mais rÃ¡pido que bundlers tradicionais
- âœ… Arquitetura de ESModules nativos e HMR
- âœ… CriaÃ§Ã£o e estrutura de projetos Vite
- âœ… ConfiguraÃ§Ã£o avanÃ§ada com `vite.config.js`
- âœ… Sistema de plugins e criaÃ§Ã£o de plugins customizados
- âœ… VariÃ¡veis de ambiente e mÃºltiplos modos
- âœ… Build de produÃ§Ã£o e otimizaÃ§Ã£o
- âœ… IntegraÃ§Ã£o com diferentes frameworks (React, Vue, Svelte)

### PrÃ³ximos passos

No **MÃ³dulo 2**, vamos fazer uma comparaÃ§Ã£o profunda entre **Svelte e React**, entendendo as diferenÃ§as filosÃ³ficas e prÃ¡ticas entre os dois frameworks.

---

**PrÃ³ximo mÃ³dulo:** [MÃ³dulo 2 â€” Svelte vs React: Entendendo as DiferenÃ§as](../modulo-02-svelte-vs-react/)
