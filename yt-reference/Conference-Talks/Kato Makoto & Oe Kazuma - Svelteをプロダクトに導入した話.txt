はい では始めたいと思います よろしくお願いしますはじめまして 今日のLTEはですね 株式会社Lチームライフデザインの私 加藤普段もMKEENというハンドルネームでやってます後半は同じ会社の大江くんと一緒にやらせてもらうと思います よろしくお願いします今日はですね スベルトをプロダクトに導入した話というお題でスベルトのサイトをですね 今日まで約10ヶ月運用したお話をしたいと思います前半はですね スベルトをプロダクトに導入した背景とか導入までにチームで取り組んだことを 発表したいと思います後半は大江君からサイトに使った技術スタックとそのメリットデメリットなどを 副表したいと思いますこの発表を通じてですね日本でもスベルトを使った事例が 増えるきっかけになったらいいなと思いますよろしくお願いします私 名前は加藤誠と言いまして普段は子供が泥団子を持ったMキンというハンドルネームで活動してますフロントエンド開発もしますしスポジで使うバックエンドのAPIとかも使って開発してますそれ以上あまり自分のことは言うことないですが進みたいと思います早速ですねこちらがですね スベルトを使ったサイトになってます花夢という結婚式場情報サイトのサービスでお客様が結婚指輪とか婚約指輪を探して店舗に来店の予約をすることができるサービスになってます花夢はですね 2016年からサービス展開しててすでに5年以上経過しているので今後もシステムを早くスケールしていく上でフロントエンドとバックエンドを分離していくということに徹底しましたまず私たちは技術選定フェーズでSvelteとViewtートリアクトの比較表を作成しましたこれは最初に思いつくことですよねでもそれがどれも一長一短あって決めることができませんでしたどうしたかというとやっぱり最終的には学習コストが低いスベルトに決定したんですがその理由というのが当時私たちのチームにはですねフロントエンドに強いメンバーがいなかったりしたしあとはマークアップできるデザイナーもいたのでその方たちの受けが良かったというところで私たちの組織に一番合っていたというのが理由になりますスベルトに仮でやってみようと決定してからはですねチームメンバーがスベルトへの心理的障壁を感じないようにゆっくり複雄させようと思いました具体的には聞いた記事を執筆してスベルトはこれから来る記述だぞという感じをですね醸成していったっていうのとあとは勉強会を開いてスベルトのチュートリアルをみんなでやってみたりあとはですね大江くんがですねスベルトのパーカーを自分で作ってですね手に持っているのはスベルトのステッカーなんですがロゴのこれをみんなに配って普及してましたロゴの仕様をこれ仕様許可取ったの?とか聞いたらリッチハリスさんにもう許可取ってます?とかって言ってすごいびっくりしたのを覚えてますでですねまたいきなりプロダクトに組み込むっていうことはすごいリスクが大きかったのでログイン画面とクラット機能を備えた社内用アプリを作っていきましたここまでは順調そうに見えるんですが今実際本番のプロダクトに導入しようとなると開発にしてみて分かったこともあってエコシステムが未成熟というところは少し寄せていったんですが実際に社内アプリを作っている時にも何度かコンポーネントライブラリを入れ替えたりSSRしたくてサッパーを最初使っていたんですがちょうど使い始めた時にスベルトサミットでスベルトキットの発表があってサッパーズデッドとかっていうのが出てきて覚えてもらうしようみたいな感じにあったのを覚えてます次にですね 調査コストが大きいことが挙げられますネット情報が少ないので問題が発生した時にすぐに解決できなかったりしましたあと当時はドキュメントがありませんでしたなんですが今はですねコミュニティの皆さんが爆速で翻訳いただいているので本当に感謝していますここにもたくさんのメンバーがいると思いますトムアムさん初めてコントリビューターの方々本当にありがとうございました本題に戻りますが他にも検証できていないこともたくさんあったので実際最終的にはHGMグループ内で実績のあるリアクトとかビューの方がいいんじゃないかっていう声も出てくるようになったんですがそこでちょっと消極的な感じになっていったところHMグループ内のリードエンジニアの方に相談したところいくつかアドバイスをもらいましたエコシステムが未成熟っていうことに関しては自分たちで作ってみてもいいんじゃないかという話がありましたこれ後で大江君からお話があります次に未検証のリスクを課題評価するなというところで作ってみないとどんな問題起こるか分からないしリアクトかビューがうまくいっていない時っていいなと思えるんですけど実際同じ問題が起きるだろうし社内アプリ作ってきてその問題を乗り越えてきたというところもあったのでそこはそんなに気にしなくていいんじゃないかというところを意見いただきましたそして最後に早く失敗して早く試して早く失敗しろっていう言葉をいただいて実際新しい技術を使いたい気持ちとか好きな気持ちっていうのを大事にしていいよっていうところとそういう試せる組織でやりたいよねっていうところを言っていただいてすごい気持ちが楽になったのを覚えてます本当にクリティカルな問題が起きたらそのときにリアクトかビューに切り替えたりそれまでは全力でスベルトをやり切ってみていいよっていうことを言ってもらえてすごい導入が加速したようなことを覚えていますこのようなアドバイスをもらってスベルトを導入することに決まってじゃあ実際どこから始めようかと考えた時に私たちのサービスで小さく始めることができるのが結婚指輪情報サービスだったというのがあります私からの発表は以上ですありがとうございました大江君にこの後パトンタッチしますはいこれ聞こえますかねこのまま引き続き僕からバトンタッチしてもらってやると思います共有できたかなはい じゃあ話していきますここからですね 加藤さんからバトンタッチをして株式会社HMライフデザインの大江が発表したいと思います先ほど自己紹介でも話したんですが普段加藤さんと同じチームでエンジニアとして働いていてバックエンドも書きますけど最近はずっとフロントエンドを書かせていただいてるっていう感じになってますさっきすごい勉強会だったりとか僕が滑ると本当に結構2年前とかですかね見つけた時にすごい好きになって会社でいいものだからやっぱりみんなに広めたいし使いたいなみたいなところでああいう勉強会だったりステッカー作ったりっていうところで直接ツイッターでリッチハリスさんにステッカーとか作って社内に配りたいよっていうのを伝えていいですよっていうので心よく言っていただいて作るんだっていう経緯があります普段ツイッターとかGitHubとかKitaとかこの大江一間でやってますのでぜひフォローとよろしくお願いします早速本題に入っていくんですが 実際にスベルトを導入してからの技術スタッグやったりメリット・デメリットみたいなところを話していきますさっき紹介してもらった結婚指輪の情報サービスでスベルトを採用して最初の技術スタッグこちらになります当時はスベルトキットがなくて サッパーも開発が止まっている状況だったのでその当時活発に開発をしていた 今もRootify3頑張ってますけどRootifyというルーティングライブラリを採用しましたこれでSPAで構築をしましてでもSPAだとGooglebotなどが正確に評価してくれないのではないかっていう不安を

あったのでRenderTronというレンダラーを導入してBot向けには静的なHTMLを返すというような工夫もしました次にスペリトリ作ってみて辛いところなんですが先ほども言ってたところではありますしもしかしたら皆さんも感じているところじゃないかなと思っているんですがリアクトとかビューのような定番のライブラリだったりメンテされ続けているライブラリって少ないのは事実だというふうに思っていますまず定番のライブラリがないので基本的にこういうライブラリ探すときに使った方法としてはまず検索エンジンで調べるかSvelte Societyの方で調べるとかMade with Speltで調べるかを使って使いたいライブラリを探していましたそれで僕らはSEOのメタタグとかを管理するようなライブラリを探していたんですがそれで探した時に自分たちに求める機能があるライブラリがなかったので今あるようなライブラリにコミットするっていう手もあったかなとは思いますがすぐ欲しかったですし自分たちが機能を作っていきたいっていうものもあったので自分でこのスベルトメタタグスというライブラリを作ることにしましたこれはスベルトキットを試したいっていう意味も込めてスベルトキットで構築をしましたその後に後々公開して開発していく中でツベルトのブログでも紹介していただいたっていうのもあると思いますけど現在スター数100を超えて僕自身初めてライブラリ作ったんですけど思ったより多くの方に使っていただいてすごい嬉しく思っていますこの経験からですねライブラリとかプラグインっていうのは違う人が作ってくれるっていうのは待つんじゃなくて自分たちで作り上げていかないとスベルト自体盛り上がっていかないのかなっていうところを思ったのでこれからも少しでもスベルトの界隈に貢献することができたらなというふうに思っています次にスベルトで作ってみて嬉しいところですが嬉しいところはやっぱり開発体験の良さですねリアクトとかビューでも僕は書いたことあるんですけどスベルトが一番直感的で記述量も少なくていいなっていうふうに実感をしていますあとですね先ほども軽く話ありましたけど弊社のデザイナーはHTMLとかCSSのコーディング業務も行うんですがあまりリアクトとかビューみたいなフレームワークに慣れてる方が少なくてすごいリアクトやビューを試してもらうときにすごい拒否反応が起きてしまったっていうのがありますまずそういうスベルトをHTMLライクで書けるってところですごく拒否反応少なく一緒に書いていくうちに簡単なページとかでも一人で作れるようになって実際今一緒にデザイナーもスベルトを使って仕事をしています次にですねスベルトキットの移行について話します先ほど紹介した構成でリリース後私たちの技術力不足な面もあるかなとは思ってますがサービスワーカーがうまく制御できなかったりとかリリース後にノットファウンドとか品質進発してしまったりとかしてしまってユーザ体験を損なってしまったことがありましたその時にどうしようかなって悩んでいたんですがその時にまだベータ版ではありますがベルトキットの機能が充実してきていてそろそろ採用してもいいかもしれないなっていうところを弊社のテクリードエンジニアと相談をしてスベルトキットに移行することが決まりましたスベルトキット移行後の技術スタックはこちらですスベルトキット移行してSPAからSSRの構成に変更しましたCSSフレームワークもTalewind CSS使ってたんですけどWindy CSSに乗り換えてテスティングツールも最近出ましたけどジェストからBテストに乗り換えてNPMもPNPMに乗り換えました結構これ挑戦的な構成になっているかなと思いますが以前起きていた不具合も現状起きておらず開発体験もすごく上がりましたしユーザー体験もかなり向上することができたんじゃないかなという風に思っています次にこれが スペルトキット 移行前と移行後のライトスコアの比較ですこれはスマートフォーム向けの数値になっていてパソコン向けの数値っていうのは ほぼ満点に近いスコアでいますまだこの広告とか計測系のスタートパーティスクリプトが最適化しきれていない箇所があってオールグリーンになってないんですけどかなり改善することができました最後にスベルトキットはまだベータ版ではありますけど実際にプロダクション環境で動かすところまで来ることができましたなかなか事例がないと導入するのに躊躇してしまったりすることがあるかなと思いますけど今回一つ事例を作ることができたんじゃないかなというふうに思っています皆さんの会社とかでもスベルトを導入する背中を少しでも押せればなというふうに思っていますはい 以上ですご清聴ありがとうございましたありがとうございましたありがとうございました 本当にこれもすごく面白い発表で質問ありますかなければ私質問ありますスペルトキットアダプター使っていますねそれはどのアダプターを使っていますか僕から今アダプタノードを使っています今は今その花夢のサイトっていうのはさっき説明ちょっとありましたけどちょっと古いというかある程度歴史のあるサービスになっていてここで実際の花夢のサイトと今回作った結婚指輪の情報サービスっていうのは違うもので作られていてそのあたりもちょっといろいろややこしいんですがそういうのもあるので本当だったら多分アダプターバーセルだったりクラウドフレアワーカーとか使った方がもっとパフォーマンスは上がるかもしれないですけどそういういろいろ事情があってアダプターノードでノードの環境で動かしているという感じになっています本当にアダプターがスペルトキットの強いところだと思いますのでノードも多分使いやすいと思いますしあといつか変えることになったら簡単に変えたりできますし本当にそれがいいなと思ってます多分今の現状に満足してないっていうかまたノードから変えるタイミングって絶対今後来るかなと思ってるのでそのタイミングですぐ乗り換えれるっていうのはとてもいいなというふうに実感しているところですありがとうございます質問は他にありますかはいいいですか大丈夫ですもちろんお願いしますWindy CSSを採用されているということなんですがスウェルトキットに導入したとき導入するのでタイルウィンドウと比べて特別な操作があったりとかしたりするんですか特別な操作って言いますかテイルウィンドウからするときそうですテイルウィンドウからちょっと質問があるですねもともとテールウィンドウがあったものをWindy CSSに切り替えたんですかそうですねもともとテールウィンドウCSS使っていてそこからWindy CSSに切り替えたんですけどここをちょっとライトニングトークの時間の問題であんまりあとスベルトと関係ないかなっていうところで省かせてもらったんですけどちょっと説明するともともとテールウィンドウCSSを使っていてその分には結構比較的満足はしていたんですがHMRが遅いみたいなところがあってあとテールウィンドウだと開発してる時にすごいちらつきとかが起こったりとかもしかしたら今は起こらないかもしれないですけど当時起こっていたりとかしたのでそこでちょっと開発体験が悪いなっていう実感もありましたその時にこのWindy CSSっていうのが出てきてそのあたりを解決したようなライブラリですしあと僕が思っていたのは結構Talewind CSSって

CSSのプラグインなのでいろいろ設定だったりとかあとCSS NanoとかAuto Prefixerとかいろいろそのあたりのライブラリを入れないといけないっていう面もあると思うんですけどこのWindy CSSだとそういうのを入れずに1個入れればいいっていうところがそのあたりの結構依存関係が少ない依存関係はなかったはずなので そのあたりがいいところなのかなと思って採用しました今は結構使っていろいろ Windy CSSにしか使えない書き方とかもいろいろあってそのあたりが結構気に入ってる面もありますTalewind CSS使ってる方とかは 一回見てもらえればすごい面白いかなと思ってます1個デメリットとして感じてるのはテールウィンドCSSだと使ってる人が多いのでPSLintのプラグインだったりとか最近プリティアの発表をしてましたけどそのあたりの周辺のものがあんまり充実していないかなっていうところは1個懸念点としてはありますそれ以外の開発体験としてはすごくいいので1回使ってみることをお勧めしますねありがとうございます今の話聞いて画面使ってみたくなりましたねすごい開発体験はいいと思いますBテストはどうですかBテストもかなりまだベータ版ですよね導入されたんですか結構最近導入して結構スウェルトキットでテスト系導入したことがある人って分かると思うんですけどそのBitの関係で結構設定が難しかったりとかするんですよねそのあたりが結構ややこしいなって思っていたのでBtest導入したっていうのもありますでも今Btest導入してもちょっと滑るときって完全に対応しきれてない部分とかもあるのでこれはちょっとBandyにお勧めできるかってちょっと怪しいんですけど今僕らのプロダクトだと結構E2Eやってるところもあって単体テストがあまりこれは悪いところかもしれないですけどかけない部分もあるのでそこまで影響がなかったっていうのがあります今後開発がBテスト進んでくると結構スベルトキットと合わせるとすごく相性がいいものになるんじゃないかなと思っているのでかなり期待はしていますわかりました ありがとうございます今コメント欄にウィンリーにしてよかったなって僕が思ったところを一つだけ挙げましたがレスポンシブになってくるとどんどん見づらくなっていくんですがそういったものを一つに固まることができるのでWinlyだと可読性がすごく良くなったなというのは感じますしあとVSコードの拡張機能にもWinlyの拡張機能があるのでちゃんとファイル保存したときに相当かけてくれたりというのでそのあたりもフォールの報酬も良いなとは思いますあともう一個ウィンディのいいところすごいスベルトの話だけどウィンディの足立ちしてるって話なんですけどすごいデザイナーから好評だったのは開発時のDevToolsでそのまま変えれるんですよねTailwindは多分対応しないと思うんですけど生成…なんだろうDevTools上でクラスを変えた時にTailwindだと反映されなくて1回ビルドしないと多分反映されないと思うんですけどインディーだと開発環境上でそのクラスを変更したときにすぐに反映されるみたいなところがあるのでDevTools上で1回UI変えてみたいなみたいなところで変えてみてそれを実際のコードに反映するみたいなご機嫌もできるところが結構いいなと思っています