 So welcome to the first Svienna of 2024. Thanks for the organizer to let me talk today. I will make a quick introduction and my talk is based around the first project I made with SvelteKit And I would like to share my experience with it, what I found might be useful for people to use and basically to share my own experience. So perhaps you noticed with this crazy introduction, but I'm an interactive developer. So basically, what does it mean? I do front-end development, except I focus a lot on interaction and animation on a website, which means if there is any backend developer in the room, it won't be so much interesting for you. But who knows? But anyway, so like, yeah, I studied in France and I'm freelancing for five years now. And I came in Vienna, I arrived in Vienna five years ago. And as I said, I work with agencies both in Austria, in Germany, and most of the time in France. because I'm French, so that's quite convenient. And I make websites mostly like portfolio or interactive websites for like a museum, for a special event, for something that needs a little bit more artistic and visual. Sorry? Yeah, visual touch overall. And for all of those projects, usually so far, I used Next.js but now I decided to switch but why did I decide to switch to Svelkit now so after coming here like two three times I felt I should give it a try and I also find that when I use React for interactive website it can be a bit a pain in the ass because if you don't really know when the DOM is rendered and when it not if you can control all the parameters and sometimes you feel it a bit like a magic box then it gets hard that you have an animation popping and then suddenly it doesn't work because the element is already out of the DOM and so on. And so when I started to look a bit into SvelteKit, it felt like those problematics could be solved and I felt I would give it a try. I also had like an opportunity to work on a small project for a colleague who is a graphic designer so there is not a big scope but it was the opportunity for me to use SvelteKit there so the project, the stack of the project is built, is based on SvelteKit of course on Sanity so that's headless CMS that's really convenient Does anybody have you used it before or heard about it before? Okay. So, like, it's really convenient for developers because you build the whole CMS just in the code directly. And, like, the big advantage of it is the query language to get the content. So you can directly get the fields that you want. And you can make, like, a word demo, like, word the objects that you receive. So what you get in the front end is like a really nice object that you can work with that's already been treated and so on. Like their query language is called Grok. And it's really powerful. So I can only recommend to use it. I use a Jisapp. So that's like a JavaScript animation library and also 3GS. So it's a library to do WebGL. So 3D on the web. I can now show you, like give you an overview of the website. Nice. I would just, I worked, I have to do it like that. So I hope the internet is still working, yeah. So in terms of content, it's like a portfolio where you have different projects that the designer worked with. It's like a nice gallery. Whenever you go to a project, you can see more information, little bits of content, like some different images and directly see some credits when it been worked with other people And you can also discover further projects and navigate through the projects There is a shop, but I won't talk about this because it's only hosted externally on some Squarespace, so it's not really relevant here. And yeah, all other pages are content images. So everything is coming from sanity. And I also, everything is aligned on the grid because, yeah, designers love grid. So when it's perfectly aligned, it's even better. So as you can see, it's like pretty small project. On this thing? The line? I press G, yeah. The G keyboard like grid. so whenever like the designer I shared the website to like the client you didn't know it existed it's custom it's custom because it's based on like the grid settings that I said about the beginning and so it's just like an overview and then usually I disable it when I go into production. But yeah, it depends. And there is also like a small archive page for all like previous work that she did. And you can like browse through it. And yeah, so like pretty simple website. So it's like really convenient to start to use SvelteKit with it. Nice. So I use it with the, I set it up with like the basic command line interface to create a SvelteKit project. I decided to put like all my folders into the lib folder because when you import them with SvelteKit, you have this dollar lib and it's like always targeting whatever is in this whoever is in this folder. So it's convenient to quickly access to everything else. And what I want to share also is like a few use cases that I encounter when I did the project and that might be relevant And we will see together how to use SvelteKit to tackle those problematics And the first one is using client viewport size. So when you do front-end development and more interactive website, you should always be aware of the size of the viewport that you're using to keep both the CSS and the JavaScript synchronized. So you always have the same grid to detect if you're in a mobile device or not. And also, you might need to know the size of the window in many components, but you don't want to add an event listener in each of those components. So you put it in a store, which I will show you on the code, and then it's only called one time, and you can use it everywhere. Yes. Okay, so what I did here is big enough. I want to just do it up like this. There. So what I did here is I used the readable function of this field store because it's not something that I want to set me, myself, as a user because it's depending only on the viewport. I pass in like a base default value for like for the server side because of course on the server side we don't have access to the window so to make sure nothing breaks I have like default values and in the start function I have I check if I'm on like the client side only if I'm on the client side I have like an event listener on the window resize, okay, which is calling handle resize. And basically it sets all my store to those parameters which are based on the window width or height, depending on what I want. I said previously that I use the JavaScript grid, so this is why I have those kind of values to know how wide is a column or something. And when I, of course, when I resize, everything gets updated. Yeah. And then like I call also in the

 stop function. So if nobody is listening to this store anymore, I remove like the event listener. So it's cleaned up properly. Yeah. So this is how I use like the, yeah, the viewport store. So every component is also all the time aware of the, of the size of the The second one is I added lazy loading to the assets. So using SvelteAction. So SvelteAction is a function when you attach it to a component. It's a function that takes this node in parameter and it's running when it's mounted. And in my case, it was really relevant for lazy loading assets. So I don't want all the sets that are out of view to be loaded directly. directly and I want only probably you saw on the website. My mouse, all right. You saw on the website if I go to like an image you can see that I mean now everything is loaded because I loaded them before but So what I do is I load first a low-quality version of the image, and when it's coming to the viewport, I load the full image, and then I replace it dynamically with JavaScript. So if I go back here, like, perhaps... Yeah, so this is cached. But, like, you can see that it's loading when the more I browse, it's loading. So it keeps the page to be able to load fast, and then you don't have so much image loading in the background that you can see, so it's smoothing the user experience. And in order to do this... Let's find the mouse. Okay. In order to do this I have a component that called async image It taking like a cover as props The cover contains the URL of the final image And also like the, it's like a base 64 URL of a low quality image placeholder. And what I do is, so like the first source of the image is this placeholder. when I use the lazy load, I tell my lazy load observer to observe this node. And once it's entering into the viewport, I replace the source with the final URL that I have here. For those who don't know what's the intersection observer, You tell the windows to look into a node, and if the node is intersecting in the viewport, depending on some root margin that you put. So for now, it means if it's 600 pixels under the DOM, under the viewport, let's say. Like let's say the image is here, 600 pixels below. It will start. It will be triggered. So when I get the node, I can get the final URL in the SRC. I create a new image. I create a new image. I put the final URL in this image. And when it's loaded, I change the SRC of the node into the URL. And then the image pops in. So yeah, this is like how to use only using an action. So when it's mounted, I have the proper images that's shown. What's priority loading? Priority loading, it's like props I can pass. So whenever I want an image not to have this low quality and then a nice image. Do you think it's on the top? Yeah, for example, yeah. Then I can pass these props, and it will be like the lazy load will be deactivated directly. So I can have like a control over if it's shown or not. Something that I realized and I will talk about it now is for example I have this component okay I have an image in it It already lazy load and it happening once the component is mounted Whenever it receives a new cover, the action won't be triggered because it's triggered only once the component is mounted. and what I realized is if one of the options that you pass to your action is updated then like the function that you have then your action will be updated again and this is what I did here so I put my observer into a function it's called first because when it's mounted and then in the return function I have like a cleanup and also an update. So whenever one of the options here is updated, like this gets triggered once again. So it allows me to have only one component. And if the image changed over the time, then the action is re-triggered again. Something interesting I can show. so the this low quality image is sent to me by sanity whenever the client put an image into an image field I can query both the URL and also a low quality of this image it's not something I do or the client does it's already integrated in the CMS that's why I can have both and do all of this process right there So something I can show that's relevant to both the lazy loading here and the store is... Let me find where I put it somewhere. To the component. Okay, for example here. I don't care about the warning. This is still a work in progress. So I use this component that I had presented before, the async image. And I pass as the cover the low quality and also a final URL. What I can do with sanity is I can build the URL of the asset So I can crop it on the fly to use like a smaller image and not for example on mobile to have a super big image because you never can control what the client upload so this is kind of it's a helper to prevent it so I have a function that I can use where I pass the final URL I pass it the width that I want the device pixel ratio of the device and then it's generating me at the end a full URL of it. And like the image width that I have here is a little helper that I built, which is based both on the viewport that I presented before and I get the size if on this top, I want it to be on two column, tablet three column and mobile four column. So it already knows the exact pixel and value of the image that I need. So I am sure to always load like pixel perfect images. And whenever, perhaps some of you can ask, whenever you resize the window, what happens? So whenever you resize the window, of course, this gets set. And all like the image width changes as well. That's why it's debounced. So every 100 milliseconds, like this, new images will be called. of course i can enhance it later so if you load the bigger image and then you get smaller the image doesn't get uh refetched again because it doesn't make sense something that you usually want when you build a interactive portfolio is like the page transition So when you go from one page to the other, you have a fade-in, fade-out, or some animation and something that's just not really nice to use. And it's also smoother for the user experience to have a nice page transition. This is where on-navigating comes in. So in SvelteKit, onNavigating is a function that gets called whenever you change a route, either from a page or from a component as well. It doesn't need to be in a page. And if you return...

 a promise to it. It will wait until that promise is fulfilled until switching to the page. So that allows you to build a complex animation or out animation. You put it in a promise and when your animation is finished, then you can switch to another page. This is something that I did. you can see here if I go back to the portfolio if I switch the page you have an out animation and when it's out it's changing the route and you arrive to another page and in terms of code it's behaving like this so I have a on navigate function that's directly called from app navigation so it's a built in function from spell kit. And I check if I'm really going out of the home, then I return this WebGL app where I handle all my 3D assets, my 3D scene, and I call transition out, which is a promise. And once it's finished, then of course the promise is fulfilled. It's returned, and then you can switch to the next page. I made this here and I made this also for another page. So all the project page, it's always like slash project slash the slug of the project. And I had the issue where I go from this page to another project then it doesn't get triggered. And actually when I see so I had to flag it and whenever I have the navigation if it's the same slug for example if you just reload the page then it doesn't get triggered and then I check if I'm also going out of the page then it's the same I'm returning like a gzapp function so it's the animation library. And then I have some parameters to animate it out. And this is what you can see if I go from one project to another Yeah it like fading in fading out So it's quite convenient to build some nice effects, some transition. What I did here is rather simple, but you can see only based on the promise, you're going to build really complex stuff. Yeah, moving on. The last use case I want to talk about is like the in function. So in SvelteKit, it's whenever an element is added to the DOM, then you can run a function. And it's nice when you have some effects when you are clicking on a button and something has to pop in, then you can control what animation you want to play. I mean, whatever function you want to play. It doesn't have to be an animation. And you've seen it, for example. If I go here, then you can see in the cursor, there is some text that's appearing. And it's something, actually, I do with this in transition. I'll show you the code directly. So it's something that's right there. Okay. You can see that this is my Svelte component. Whenever the cursor, so I made the state of the cursor globally because it can be called from anywhere. and whenever it receives a title, I can open here, I split the title because I want to animate it letter by letter. So I split the string into different characters and I put them in spans so I can animate them. And here you have the keyword that I talked about. So whenever this gets added to the DOM, then it will call the labelIn function. I have the labelIn function here so it receives the node on which it attached to Here I can just select all the characters that I want because this is based on what I called before. So I select every span, and then I have my function with GreenSock, where I select those letters and I translate them from plus 15 to zero. so you have this effect. And the effect is staggered, so they all start one after the other. It's not like all one block, but it's one after the other. And so this is like my twin made with GZAP. But what SvelteKit is expecting is that in the function you call, you have a return object in which you can pass in the delay. So how long after the DOM, how long after it's added in the DOM the function is called. The animation is called. You can add an easing that's already included in Svelte. But because I already have an easing in my function here, I want the animation to play linearly because I handle the easing elsewhere. I can pass in the duration that I set in my twin with GZAP. So the only downside is here it's in seconds, but Svelkit expects milliseconds, so that's why I have to make the multiplication. So sometimes I had to work a little around to really fine-tune the stuff. And you return also a tick line, which is a method, And what it does is it's going from 0 to 1, following the easing, following the duration that you give it. And because I want my twin to play, I set the progress from 0 to 1, and then the animation plays following every parameter that's set here. You can also have an out function whenever you want the element is going out of the DOM. but I didn't put it here because I didn't need to. So this is, I think, quite convenient. Somehow I tried to have like only some to do it only with CSS but the animation didn play so I don really understood why but when I used SvelteKit properties while using SvelteKit, then of course everything works properly. And you can make this, yeah, this works for every type of elements that you add to the DOM that you remove. Yeah, the little feedbacks that I have that I can share while I did this website is that the on-navigating function gets triggered on all pages or components. So before I thought if I go from page A to page B, it will only get triggered on page A and page B, but actually it gets triggered everywhere. So I have some animations running from page C that I don't know where it's coming from. So that's why you have to check where you're coming from, to which URL if the parameters are the same. Also, the Svelte action are called when the options are changed. So I talked before about this low-quality image that didn't get replaced when the props change. But since now you change the option as well, you pass to the action, then it gets called again. and also something that I find a little annoying but I'm expecting perhaps some answers to this is I used to work with folders and like index.js file and once you import like the folder it directly detects the index.js file and it's taking it I had errors so many times because when I want to import a component I have to call like slash grid slash grid.svelte. But perhaps there is some stuff we can find to fix this. And more overall, the feedback is that the dev server is super fast. That's really nice to use coming from Next.js. I don't need to explain more. But this is super fast. and also you directly have the network address. So it shows me both like I work the website or like the local server is available on localhost slash 3000 and also like my network address. So for example, if I take my

 phone and I type in my they are both connected to the same Wi-Fi. I can see the website on my phone directly. And this is of course when you do front-end development, you always want to see on your phone what it looks like. And what I really appreciate is the light feeling of SvelteKit that it's super easy to use. You don't feel like there is like some magic tricks behind or some big black box where some stuff are happening and you don't really know where you go or what you get or you never question really your results if you follow the documentation it's more yeah like the developer experience it's much nicer than React I can say because I use React quite a lot and there is no like a problem of re-rendering and you don't know why it's re-rendering and then you get some results, some unexpected results and your head gets super crazy. So that's more the experience, just react. So yeah, that's wrapping up my talk and feel free to ask some questions. Thank you. Is there any question? Are you planning on pushing to the browser history or altering it from interaction? What do you mean? So when you're navigating through the pictures, are you pushing to the browser history or what happens? Ah, okay. Yeah, this I could do. Now it's not just some page, but for SEO purpose, I could create a custom page for this. I have a question. These pictures are all over on the website. If it's over on the website, I think it's already going through Bob Cross. What do we? The question regarding this gallery here or the whole website? It's behaving like I expected. Okay, okay. So it not really a question Yeah okay Yeah I have one I was just wondering about the Spanify function Yeah. How did you do that? Is that something that's built in? Yeah, it's not something that's built in. It's part of some helpers that I use. and yeah it's this function yeah so like I there is like I like I take the string and then I check every character and it depends if I want like how many spans do I want depending on the animation and and then it's returning me like you have one span per word and then per letter you can have one span too. This is something I did lately because I had some problem. I did a website that was in Chinese and the split didn't work properly on some characters. That's what I had to change some stuff and adapt it, yeah. So you're kind of building your own library of teleperfections for future projects? Yeah, this is something I reuse through like every project. I mean, especially like the Spanify is super convenient for projects like this. But I have this for text, but also for like some mathematic question if I want to like alert a value and not for like when I want to animate and make some easings and so on. Yeah. I have a question. I see you use GSEP because probably you have experience with GSEP. Would you be able to achieve similar or the same result just using Svelte animations? Or what can you do with Svelte animations? Svelte transitions? Because as far as I've seen, Svelte transitions, is, I mean, like all the built-in are only like fade in, fade out, some stuff. So you're quite limited already You can use CSS animation Like when I did what I did here you can like have a CSS animation. So yes, you don't always need GZAP definitely, but because I had also like the slider at the beginning and I wanted to tweak some value because with GZAP you can, basically if you have an object with some value you can put them any way you want so when you use like something that's not really related to svelte it's really nice to to have something to to use yeah so for the for the three js things yeah yeah yeah definitely yeah um if i check uh I don't know, it just isn't actually on the right. Yeah, like for example, like the introduction timeline that you see here. This is made with GZAP because I like the easing, the curve, like the value that I update, and I have to pick some stuff here and there. you need to have like some... Theoretically, we could use this inside the, how's it called, between store or how's it called? There's this twin store that you can put different easings for the... In the transition. In the transition. Oh, yeah. Yeah, I think it's like here, like this that you're talking about. Yeah, exactly. Yeah, you can make it with built-in animation. So if we would have, for example, extended power3.out and svelte easing, then maybe using gset wouldn't be even less than a lot. Yeah, like for example, I assume this could be like linear easing. But here you would put something similar to this. You can try to find the middle point. I mean, yeah, with GZAP, of course, this is a simple example because it's like just a couple of characters that you animate like this. But if you want something like a bit more complex, you might need something like a library I mean it kind of makes sense in GZAP right that you line up a bunch of promises and then you kind of wait for one thing to stop and you build out your timeline. I think that's a little more complicated. Yeah, yeah, yeah. For the page transition, when you are waiting for a promise, you can make your whole timeline with GSEP, and it's returning your promise, and then you can be on top of that. Yeah. Yeah? Can you show us how the side looks on mobile? Any other questions? Yeah, so I mean, it's working well as well. You can pay now. It still needs like a little some fine tuning for like a bit more animation but basically it's the whole same thing. Can you show the grid again? So you have the same number of columns? No, before I had 12 and here I have 8. I have for mobile and desktop I have different number of columns. So whenever I switch, there is always like a breakpoint. Yeah. I have a question. Yeah. You mentioned before that you have default values for the server server rendering. Do you experience any sort of flickering or is it not noticeable when loading the page on like different viewports? I don't notice some flickering. Only sometimes when I did like with the cursor and like this effect, sometimes I can see like the something flickers. But when I load it like client side, there is no flickering. No, no. Just problems with fade in. By the time it's not visible and then visible, which probably happens in the background.

 So if you refresh, it's capacity zero probably. Yeah. I mean, this you might flicker like this, or? It's probably not flicker like this, but I mean, if you assume you set the defaults to a desktop page, and you load it on mobile, then there would be a frame potentially where it's on the desktop page. If you have animations like these, they hide it really nicely. Yeah, yeah, yeah. It's part of the overall package. Some other questions? I think you're very well aware how you present the fonts in everything. How do you make sure that they are loaded on the presentation without any fonts? Good question. I mean, here there is no problem because, of course, I have the fonts and they are cached already. Just have a really long preloader. No, I just have, I think in terms of font, I just use something like this. Like the phone display fallback yeah But no nothing This is local font so it will be in SSR Yeah if you use the local so if the font is already on the machine then the font is not loaded by the... I doubt that you don't have Bazel. I think you choose your fonts very precisely, because that's how I imagine you design your website. And that's fonts that's usually not on the device of the user. Yeah, yeah, yeah. There is some loading shenanigans going on. But it's probably because there is loading animation in the beginning we don't see. And this is great. It's very clever. Yeah, yeah. Thank you. It's not really the purpose, but it solves a lot of problems. I mean, then you just have to load the images for the .. Yeah, yeah, yeah. But even the images here, you have their preloading while you see the logo, and then you have the animation that's kicking in. And I also have, I don't know how much images there is on the slider, but many. But I don't wait until all of them are loaded, so I start playing the animation. I think I load only the first six that are on the first that you see at first, and then the rest is loading in the background. Can you see the longer while the wait first six Yeah OK so if the internet is slow you see longer for longer Yeah this is something I could add some progress bar or something It's fine. It's super fast anyway. I was just here. Yeah, any other question? How did you do this library? Did you do this yourself or did you do some kind of library? I mean the carousel, but moving image carousel. Yeah, I mean, the library I use is 3GS. Actually, it doesn't need to be anything 3D. But at the beginning, I was hoping to have something a bit more tweaky, but the client didn't accept. So, like, yeah, this is like, I have a slider with real images and titles in the DOM. And then I get the images and their position, and I make the 3D scene on top of that. And you don't see the images of the DOM, but actually the ones in the canvas. And before, yeah, I had some stuff where when you scroll. So when it's like this is too much, but it's always nice to have a little organic feeling. But yeah when I showed the website like yeah it didn go that much So it doesn need to be like full 3D but like you can do something like 2D but yeah it homemade but I use GZEP to actually calculate like when the picture goes out of the screen how much I have to send it back there so they are all staying aligned and no matter how you scroll they all have their own function, image per image, like how much they need to translate before going back at the end. And then you can have this infinity too. That works, yeah, in both directions. How do you get that? Do you use the regular scroll-up interaction? Or how does it work? Yeah, yeah, yeah. Usually the page would try to scroll beyond the... Wouldn't you have overscore when you'd scroll? It's because I set like overflow hidden on the HTML or on the body. So it takes like you don't have overscroll. But you have to have the scroll gesture? I mean, it's the real event. It's not the scroll. Because if there is no scroll bar, you can't scroll. But it's just like the real event. So whenever you have the mouse, yeah. Or the touch event too, yeah. Thank you.