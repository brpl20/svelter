よろしくお願いします ちょっと簡単な発表をさせてもらえればと思います今日はスベルトのデバッグ方法を ご紹介できたらいいんじゃないかと思って発表させていただきます今日は簡単に僕の自己紹介 自己紹介もあったんでもうあれなんですけど簡単にした後にデバッグ方法 簡単に紹介した後で 今日はなんかライトニングトークなんで あんまり深い話というかいっぱいの話はできないので 学習資料とか 僕が個人的に参考になったものでもし皆さんがまだご覧になってないものがあったら それも参考になるかなというふうに思いますのでそれを紹介させていただきたいと思いますで 一個ちょっと僕お伺いしてみたいことがあってそのJavaScriptとかTypeScriptのライブラリとかって 作成したことってどのぐらいの方がいらっしゃるのかなっていうのは ちょっと気になったんですよねもしある方とかいたらハンズアップとかしていただけるとなんですけどそういう方ってどれくらいいらっしゃるんですかダビデさんはあるってことですね2人今何人かいて3人4人半分くらいの方があるってことですねそういう方にとってはもしかしたらあんまり知ってるよって内容で終わってしまう可能性はあるんですけど逆にこういうデバッグの方法もあるよとかがあったらぜひ教えていただけると嬉しいななんて思います個人的に去年僕Javaとかもやってるんですけどログ4Jの脆弱性があったりとかあとColors.jsで作者の人がすごい大変なことになっちゃったみたいなことがあったと思うんですけど普段僕らって何気なくオープンソース使ってると思うんですけどオープンソースを使うって意思決定した時点でいざという時自分でオープンソースの中も見て問題を解決できるって必要はあるんじゃないかなと思ってスベルトをもし使うんだったらデバッグ方法も分かっているとそれに越したことはないんじゃないかなという風なのがまずモチベーションです今日はライトニングトークなんでその最初の一歩を発表させていただければなという風に思ってます自己紹介なんですけど株式会社フライルというスタートアップでエンジニアをしていますプロダクトマネージャー向けのサービスを提供している会社ですプロダクトマネージャーっていう言葉にもし興味がある方は一回ホームページとか見ていただけると嬉しいかなと思います趣味でスベルトのコントリビューターをしてますベースボール山って名前でやっていてたまにコミットしたりとかしてますあんまりよくわからないんですけど開発エコシステムとかコンパイラーとかそういうのとかリントとか何かそういうのに興味があったりしますで ここから本題なんですけどえっとありがとうございますえっと まあコメントを頂きましたありがとうごうございます本題なんですけどまずデバッグするにしても何はともあれSvelteのライブラリの準備をしなきゃいけないのでまずその前提を合わせるためにそのセジョンを説明するんですけどライブラリ開発した方はもちろん分かると思うんですけどリポジトリをSvelteのリポジトリをフォークしてからフォークしたリポジトリをチェックアウトしてNPMインストールしてNPMランビルドしてnpm devするとここまでは普段と一緒だと思うんですけど最後npm linkっていうコマンドを実行しますとこれが何かっていうと簡単に言えば簡単に言えばというかチェッカーとしたスペルトのリポジトリのこのディレクトリというかフォルダをグローバルのノードモジュールディレクトリにシンボリックリンクを作成するっていうコマンドでこれをすることで後で手元にあるスペルトを使えるようになると簡単に言えばそういうことになりますとこれだけなんですよねライブラリはフォークしてビルドしてNPMリンクするだけということでとても簡単だと思いますSveltoのアプリの側の準備なんですけどこれもいつもと同じようにSveltoのホームページにあるような内容をこなしてもらってさっきのシンボリックリンクを作成したSveltoをインストールするとNPMリンクSveltoっていうコマンドでリンクができますとNPMランデブをするとこれでもう手元に落としてきたスベルトを使ってアプリを起動するということがもうできるようになりますとここからが本題で今回デバッグ方法を大きくランタイム編とコンパイラ編という風に分けて紹介したいと思ってますとなんでかっていうと前提知識の一応念のため前提知識の共有なんですけれどもスベルトはコンパイラーということになっていてスベルトのファイルをJavaScriptに変換してバンドル.jsを作ると思いますとなのでこのコンパイルされたものBundle.js 今回これをランタイムと呼ぶことにしますけれどもこれに対してデバッグをしていくっていうプロセスとそのBundle.jsを作るためのコンパイルプロセスのデバッグっていう2つに分けて説明しようかなというふうに思ってますとでランタイムに関してはコンポーネントのライフサイクルを簡単に理解しておくといいんじゃないかと思っていて今回重要などこだけ抜粋するとCreateMountっていう関数によって最初のレンダリングを行ってアップデート関数によってDOMを更新してデスロイ関数によってDOMを削除すると一旦これだけ覚えておくとどうにかなると思いますでブラウザでデバッグランタイムのデバッグがブラウザでやるのが個人的にはいいと思うんですけれどもさっき言ったように全ての処理はバンドル.jsに詰まっているのでとにかくこの中を探せば全てが見つかるという風に思いますとなんですけどJavaScriptソースマップっていうのがあると思うんですけどスベルトは.スベルトっていうファイルをバンドル.jsに変換しているんでこのソースマップっていう機能を使っているとバンドル.jsの方じゃなくてスベルトのファイルのここを実行しますよみたいな感じでブラウザの便利機能というかがデバッグを支援してくれると思うんですけどそれがあると逆にBundle.jsの側でデバッグができないのでこれをオフにするというのがポイントだと思います簡単なデモなんですけどNPMなんでしたっけランデブしてアプリを実行した後に開発者ツールを開いてEnable JavaScript Source Mapってやつをオフにしますとこれ多分デフォルトでオンになってる人が多いんじゃないかなと思いますで 開発者コンソールのソースタブでビルドの下にこれちょっと今違うところ映っちゃってますけどBundle.jsっていうのがあるんですよねなのでそこで今回のデモだとCreateっていうファンクションの先頭とマウントとアップデートとデスロイのところにデバッグポイントを置きますとこれでブラウザリロードすると最初に表示されるときに最初にクリエイトが呼ばれて次にマウントが呼ばれてで表示された今度クリックドゼロタイムスってこのボタンを押すとアップデート関数が呼ばれるという風になっていますこれさえ分かればあとはこの中で何が起きているかを一生懸命島の子になって探せばあとはどうにかなるという風に思いますこのバンドル.jsっていうのはSvelteアプリのパブリックビルドフォルダ配下にあるんですけれどもこのバンドルとJSを書き換えればブラウザでも挙動が変わりますとなので今回例えばですけどハロースベルトってさっき出てたもんですけどここをハロースベルトをJapanに変えてみるっていう変更をしてみますそうすると保存するとホットモジュールリプレイスメントによってブラウザがリロードされてハロースベルトJapanが連れてくるというところでこれでランタイム側のデバッグっていうのはできるようになるんじゃないかというふうに思いますここまでのまとめなんですけれどもブラウザでデバッグする方が分かったということとBundle.jsを修正できるようになったとここまで分かるとコンパイラでアウトプットするコンパイラで何の処理をしているかよく分からないけど作られたBundle.jsといい感じに直すことができるようになったのでそのいい感じに直したBundle.jsを作るための今度コンパイラの処理を直していくというためのデバッグの方法を紹介していこうと思いますこれも簡単で今回VS Codeでやっていこうと思うんですけれどもLaunch.jsonっていうのを作ってあとデバッグしていくだけですとデバッグするときにスベルトの構造がよく分からなくて迷うことがあるんですけれどもとにかくコンパイル関数っていうのがあるんでここからデバッグを始めればどうにかなるというふうに思いますここでまた簡単な短い動画なんですけれども最初にVS CodeのデバッグのボタンからLaunch.jsonというファイルを作成してここで環境の選択というのができるのでNode.jsを今回は選択しますそうするとJSONファイルができるんでここの設定を若干変えますので 変えなきゃいけないのはプログラムっていうところConfigurationsの下にプログラムっていうのがあるので ここをロールアップに変えますとSvelteのコンパイラはロールアップっていうモジュールバンドラーを経由してSvelteのコンパイラが呼ばれるので このエンドポイントというかエントリーポイントというか これはロールアップを指定するとで、augment もpackage.jsonに書かれている内容をそのまま使う今回でいうと-cでコンフィグファイルはデフォルトのrollup.config.jsを使うということと-wでwatchをするというオプションを今回は設定しますこの状態で先ほどのcompileという関数のところこのnode-modules-high-cadのsveltoというところの下にcompiler.jsというファイルがあるのでここにコンパイルって関数があるのでここにデバッグポイントを今回置いてみることにしますこの状態でLaunch.programっていうところをこの左側の何ですかこのボタンからこれを実行するとここにブレイクポイントとかでブレイクされるとここを見るとソースに何が入ってるのかなとかそういうのが分かるようになるんであとはもう一個ずつプログラムを見ていけば原理的には全ての処理が理解できるはずいうことになりますはいでプログラムを実際に修正したらアプリをアプリっていうのは最初のコンパイラーの方じゃなくて我々が普段作るアプリの方ですねこれを再起動する必要がありますとNPMランディブをもう一回するとそうするとブラウザをリロードすると修正後のコンパイラーによって生成されたバンドルとJSがロードされて正しく修正されていればそれが見えるということになると思います最後に学習資料を簡単にご紹介したいと思うんですけれども僕が今まで良かったな 特に良かったなって思う資料を今回4つ紹介したいと思うんですけれども1個目がメンテナーによるスベルトのコンパイラーの解説っていうのがありますもう1個 日本語でもこれを解説してくださっている方がいて僕は日本語の方が読めるのでもちろんこっちの方が個人的に最初の取っ掛かりとしてすごい参考になったなというふうに思いましたということで今回スベルトのデバッグ方法を紹介したんですけれどもメンテナーはスベルトキットのデバッグ方法を解説している動画も出していたのでスベルトキットのデバッグをするときはこの動画が参考になると思いますこれは最後番外編で僕がスベルトを知ったのは去年の7月とかで結構もしかしたら遅めなんですけれどもそのきっかけになったYouTubeがあるのでもし皆様良ければ見てもらえるとなんか楽しいかもしれないですこのリンクは今Google Meetでも貼りますし一応Twitterとかでも貼っておくのでもしGoogle Meet終わった後に何だっけってなった場合はTwitterのツイートを見ていただけるとそこから終えるようにしておこうという風に思いますはい じゃあすいません 以上になります ありがとうございました