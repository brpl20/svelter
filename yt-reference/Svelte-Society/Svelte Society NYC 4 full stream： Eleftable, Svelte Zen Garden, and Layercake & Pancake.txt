 Okay, then welcome to the second... First? The program? And then... and how when it yeah basically first first next second Thank you. or more organizers just to play around with the framework and this meetup. It's kind of like a problem. But we try to do this once a month. And Vadim is responsible for all the branding. Yeah. I guess. First speaker, Michael. I'm going to also ask you to record. I'm going to walk you through it. That's why I'm going to screw this up. We get no audio. Thank you I'll use that. Okay. Yeah, it becomes a dissolve. That's cool, right? It doesn't. It can't be. Close that. Then you're going to and then this is where it gets what works no i'm talking about the third No. Sorry about this. We have to do set up. And also we should. Oh, see something? Yep. It seems to be a little bit. Yeah. So now you should record . I try to like produce videos so there are a lot more people who want to watch this here and here. provide you so so So basically, I'm just freaking out because the last time we did this, we used to have a new option. There we go. Yeah, so in case you ever have to screen record, just make sure you always record your song. And you only read, you only read. And then record. You're fine. All right, you record it. OK, cool. Great. Hey, guys. Hey, everybody. How's it going? Hey. One second. Does anybody know how to do this, where I can share just the slides, and I can get the notes? Yeah, you got a split screen. Can you do without? Yeah. Hey everybody. My name is Michael Adam Berry. I'm a developer. I'm going to do a lot of front-end stuff. I really love to do data visualization projects and different things like that. I'm fairly new to Svelte. I just first heard about it for the first time during the V3 release. At the time, I was pretty deep in the weeds of really digging into React hooks, so I wasn't really stoked about the idea of, I don't really want to learn a new framework, but the more I heard about it, the more it seemed like it was going to solve a lot of the pain points that I was specifically facing. A lot of those, especially being kind of difficult within React to do some what felt like should be pretty simple animations and different things like that. So I would try using a lot of refs and injecting a lot. So yeah, I basically gave it a shot, and now I've pretty much been building everything in this. And over the holidays we did my blog and website you still So at work too Huh At work too Really So like I said this is mainly what I do I these are some of the projects that personal projects I've looked for the setlist project that sizes performance history based on like the size of the form, and these are pieces of a data dashboard project. So, the goals of the talk, basically, today, like I said, I consider myself very much a beginner myself, but I do, so I want to preface it with that, but the goal is sort of twofold. The first is for, if there are any other beginners here, to sort of see my approach and how I went about creating something. the problems that I've solved using Spelt, and hopefully it'll be something inspiring to go make some dope shit. And then for advanced folks, for contributors, for people, for maintainers of Spelt, to see how newbies are approaching it from the documentation, how I went about building my first project to see how that process unfolds out in the wild. So I do need to say before I start that the source of the inspiration is really important for me to say today, especially because at least one of the people who made it is here, and I don't want him to think that I just ripped it off about acknowledging him. So this is a project that was in the Up Shop. It's a Game of Thrones make-your-own-chart project, and basically what it allows a user to do is to plot each character from Game of Thrones on an x-y-axis based on how beautiful on the y-axis they are and how good they are on the x-axis. So I was really kind of, I don't know, I was really pretty deep into the series at that point, so I thought it was really cool just as a fan of the show. And then also as someone interested in data visualizations and infographics, I thought it was a really interesting use and play on the idea of using the tools that viewers recognize to understand data, to include them in that process as a means to collect that data. Because essentially what this is actually is like a survey, right? It's collecting the same sort of data that could be collected in that process.

 in a form with a bunch of text inputs or drop downs or whatever, but instead you're including them to sort of build the chart and then visually map how they see candidates, how they think candidates should line up. So, it seemed like a great place to start for, you know, once I worked with the Svelte tutorial to sort of try to recreate this with a different, take a new spin on this for another group that has sort of relative values to crowdsource, to get information about relative values like morality or beauty. and I don't know if you know, but it's an election year and some of these people have since dropped out, but at the time that I made this, there were about over 20 candidates still in the election so I decided to sort of recreate it with, instead of beauty and morality, for the ideas of electability and likability, because if you've been following I'm sure you've read or heard or seen in the news that many voters say that electability is among one of their most paramount concerns when choosing a candidate in the Democratic primary. How about Iowa? Yesterday, I don't know, they even announced the... They started two. Two hours ago. Oh, good. Right on time. So, I guess right now, I'll just sort of So this is basically what I kind of designed, the things that I needed to accomplish with the application. I wanted to be able to handle some sense of some user authentication. I wanted to be able to accept the user input, in this case, click events, to render the results in a pleasing way, allow users to edit those results, save user submissions, render a comparison of user data with the mean total of submissions. So to compare what the user did to what the average day everyone did. So the tools I used to do this, I just whipped up a Firebase backend, basically. If you're not familiar, it's a cloud platform. By Google, it's free for the most part until you go viral and blah blah. And some of the concerns I wasn't too concerned about. And yeah, it made authentication super easy. They have a NoSQL cloud database that is really easy to configure Cool So before I talk you through the sort of components I made I guess we can just sort of demo the application. I'll sort of let you guys see what it was. So this is, assumes I'm already logged in, so I'll go in and log out. Cool. So. So all that's handled through Firebase, one of the biggest pros to that. Now we have some text. We have a link to the original inspiration. And then we can get started. So I'm just going to whip through this. These don't at all reflect my personal. But this was made really easy, as you can imagine, by many of the transition libraries that come free for Crystal. So the transition in to be able to use the fly and the scale methods, and then some easing functions to create those animations. So here's our results page of what we entered. So it looks like I've chosen a very swaggering Joe Biden, because he won, and then a disappointing Tom Steyer. I'd say can't hate Trump. And then similarly, oh wow, Tulsi Gabbard is my favorite. And Bernie Sanders is it. Cool. So, and then we have some tables here. And these use D3 interpolation functions to render color in descending order. And then these are, this is the editable portion. This allows us to say, oh, I didn't actually want Biden. I wanted Warren. And then because all this data is within a reactively declared variable, the data automatically updates in the interface. Cool. So now we can submit the data, which I think this UI design was bad because people keep forgetting to do this part. And now we can see how our rating lined up with all the other averages of how each candidate was viewed by performance So yeah that basically the application how it works And so how I'm going about doing this. So this is essentially the primary component. The app component, we declare some reactive variables, obviously the data. We have some conditional logic. If the user is signed in, we render a landing page. And then we also keep track of the status of the application to either render the plot for the users to plot their data or to render the score. And then within the score component lives the functionality to submit to the database and render the comparison screen. So, yeah, so the plot utilizes the on element directive to listen to pointer events on the board element. And then the built-in transitions, to this line and scale create animations with pre-defying easing functions. And it updates candidate data with the XY coordinates and updates status when the last candidate is clicked on in order to render the score. Cool. So yeah, this is kind of where most of the logic takes place in terms of really doing most of the scaling functions and transforming the DOM positions into a score. And also some of those interpolation functions for color values and things like that. And yeah, this also makes use of each end loops to render the results of each candidate reactive variables to implement and manage. Well yeah, calculates the average. It seems pretty straightforward, but you're welcome to go. All this code is open source. So you're welcome to check it out. Who's my cloud? Barry, it's my GitHub name. I don't know if I'll take this project any further. If anybody's interested in working on it, collaborating, has any ideas, I'd be happy to talk to you guys about it. Obviously, it's probably going to be a pretty long process, so there's different things that we could do, different sorts of visualizations, or projects we could work on surrounding the ongoing primary. One thing the app doesn't do at all is any routing so I played around a little bit with the SPA hash router package which is great Also once I redid my website and blog I used Zapper and that was awesome as well So if it builds out in functionality from here, I think I'd probably want to use Zapper. And yeah, these are just some ideas that I have of ways that it could be expanded upon if possible. But the goal is essentially just to be a fun way for users to be able to play around and also maybe engage some people around the election. Yeah, these are just my website. This is the project URL, my GitHub, and you can follow him on Twitter too. But thanks for listening, everybody. Thanks for letting me present. Yeah, and people can definitely play around with the code. I feel like you learn the most when you look at other people's code and see how they do stuff. And I guess that's what I'm doing. Also, thanks so much to Michael for stepping up. I asked him yesterday to talk about this, and you just stood up and took me up on it. and remember I should probably migrate to a different school but... okay so this is Svelte Zen Garden. It's just like a really random project that I undertook recently just because I got the inspiration. Okay so does everyone know what CSS ZenGarden is. So it's like this exercise where you can kind of sort of look through the same HTML, but everyone just applies different CSS, and you can see how different it is. And one of the, you know, and this is kind of like the, this was kind of like the hotness 10 years ago, and I was just looking at this and I was thinking, you know what would be better if we just did this, but it was spelled? So that's kind of what I did. And so I think one of the first things that I wanted to outline was how to do it differently. One of the things I definitely wanted to change was that the old site used

 PHP, and I do not want to use PHP, so I moved to Jackstack just partially because I work on Netlify, and the hosting is cheaper because it's all static sites. And then I also wanted to do live editing of CSS, so I wanted the thing to just update as I edited the CSS. And I wanted a shareable URL. That's something that I really enjoyed about the Svelte REPL, that you could save, it's actually a gist of whatever your code is and share it around, and it was just a very nice way to check or just to do a small demo without too much hassle. Okay, so the first thing I had to figure out was how to do dynamic CSS in Svelte. I wanted to do this, and I actually tried this because I was dumb enough to think it would work. So a Svelte single file component, if you've seen it, has a JavaScript section and a CSS section, and then has an HTML section. And I was like, oh, I can interpolate my JavaScript in HTML so I can do that in CSS. CSS, no. And this just gets directly printed to the style sheet, I guess, and that never changes again. So nope, that doesn't work. You could also try CSS variables. This is actually a proposal in Svelte for the last three years now. So instead of, just to drill down on what the difference is, here I'm actually giving the entire CSS string, whereas a CSS variable is just like, do you want a number, do you want a color, a much smaller thing, rather than you're setting entire properties at once. Anyway, so this is the proposed syntax, but it doesn't look likely that we'll get there. So the thing I came up with was CSS and JS in Svelte, and essentially using the Svelte head sort of component, attaching it onto the head of the document when the component mounts. So you have a special ID tag that you have there. And then when you render on mount, you sort of get it. And then you set inner HTML, obviously, about the CSS. It's kind of janky. I don't know if that's the best way to do it, but it worked. And I'm definitely aware that real CSS and JS libraries actually insert rules using the CSS style sheet method over there. But the problem is you have to parse rule by rule, and you can just dump entire chunks of CSS into your style sheet at once so I did not do that So let actually see well I had a demo Yeah, so that actually, my first two rules, and let's actually see a demo of that over here. So again, it's such a nice thing to have a REPL that you can just click on and see sample code. So it's only like 19 lines of code, and that gives you this little text box where you can edit the CSS that's applying to it. which is kind of fun. What other properties can I do? Everyone's favorite color. So, like, that's nice. I think customization of the web, like, we should not be held hostage, essentially, to the decisions that the designers made for us. If you know CSS, it's a superpower you can apply to every site. Anyway, so then I was like, all right, this is kind of ugly. I wanted syntax highlighting, right? This is kind of like, I don't know whether I'm right or not. It just looks like an error. So I wanted to apply some text highlighting. I only know three ways to do it. So Prism is kind of like the de facto blogging standard. Everyone in the Gatsby world uses it. Highlight.js also exists. I've never used it. And Monaco is the one that is used in VS Code. and it was all meant to do this to play around in Monaco. So I tried it out, except that that is the entirety of the docs, and there's no getting started. It's just like, here's the entire API reference. Good luck. So it took a while to figure out. So here's a simple Monaco example. This took me a couple hours to figure it out. That's where you need to go to figure it out, because they have sample code. They just don't tell you about it. And so basically it's a very simple, you import whatever is Monaco, and then on mount, you just mount the editor, and then you attach it to a DOM element. So the Monaco editor lives entirely outside as well. And when the component gets destroyed, you should also dispose of that editor as well. So that's a very simple flow to set up the editor, right? But then you also have to, oh, and it doesn't work with Role. Too bad. That's how to set up the editor, but then you also need to get data flowing to and from Svelte and Monaco. So then you have to do this syncing thing and it took another few minutes of research to figure out what exactly the API was to get there So if you ever need to do this that how you do it But I think anyone here who messes around with UI frameworks should understand when you hit the limits of the UI framework and you have to interact with something else. You should know how to sync data back and forth between them because it's a very common task. Cool, so we got like, we've grown our scope a little bit, we added syntax highlighting, and that's something I didn't start out with, but I was just like, I'm not happy live editing CSS, which is not syntax highlighted, and I still have to do my shareable URL. But then I was like, oh, what if life is draggable? Because I was like, I want to edit while I look at the thing I edit, and if it gets in the way, I want to move it around. And so I was like, oh, I remember something like this in the Svelte examples. And that's where I found Svelte actions. I've never used them. I still don't know what they are. But I clicked on the examples, right? And then, I mean, you know, when you learn Svelte, you just kind of go scroll through all of this and just see what it's capable of doing, especially for those who are in here. So in this one, it's like, it has like, you know, this amount of code. and it lets you drag and drop, right? Which is exactly what I want. I want a small little editor that I can move around the window. I can just drag and drop it around. Essentially, I think what actions are, again, correct me if I'm wrong, but what actions are, and so an action, right, gives you, basically exports all these methods. And it really binds some, I guess, custom events to adopt your element. So that when you import it, for example, this is the panelable action, and you just use panelable over here, you have new actions, you have new events that you can listen to. So I can use panelable over here, and I can listen to onPanStart. That's not a DOM event. That's a custom event that was emitted by the panelable action. And it's all pure JS over here, so meaning that none of this is actually solved specifically. specifically, like, it actually could work with or whatever else, their framework, except for React. So, yeah, so I implemented dragability with these lines of code which is ridiculous It so super easy So let actually try it out This is a deploy preview so it just like the initial working version So here's a very basic Zen garden, and let's actually try to do, for example, something like a body, what's a good CSS thing to mess around with? Maxwood? Yeah, 69 characters. What's a margin? Marketing or auto? Auto, of course, right? What else? Yeah, then you can drag it around if it gets in the way. You're like, I want this. What else? Huh? Sans Serif for the font? You know, I've never messed around with it. Comic Sans. Oh, of course. I'm sorry. Forgive me. Is it's font family, Comic Sans? Is that how it works? You know, I never handwrite. Comic Sans. I never handwrite my fonts. I just remind you. What was that? Maybe Mike. Excellent. Yeah, I never handwrite my fonts. I just copy and paste. Anyway, you see, you get this really nice functionality with the elements that we've just introduced, like CSS and JS, dragability, monocle. Good. I'm done, right? Nope. So I haven't implemented shareable URL, but my scope creeped a little bit. Dragable, fine. All right, let's implement a shareable URL. I stuck my CSS, that CSS string in a Svelte store that's right up top, the right little thing over there. And then I guess the way I did this, again, I don't know if it's right, but I was like, all right, I'm just gonna inspect CSS coming in. And if it looks like a URL, and I'm gonna try resolving that URL. If it looks like a URL, I'm gonna go fetch that URL from a gist. And then I'll get the contents of that gist and apply it as a style sheet to my site. All right, so basically it's this concept that every single site you can customize a style sheet and the site just remembers. So that's like theming for every site that you ever visit. So here's a gist, for example, that just contains a little bit of CSS, right, that I've just saved for myself. So now when I punch this in, Svelte knows how to go get it. I'll just copy this gist, and I'll delete the styling, and then I'll paste in the style sheet and then it goes in graphs at CSS. So it's like a nice way to do it.

 I guess have shareable URLs because I could also, instead of doing this manual pasting thing, I could just stick it in the URL bar and that includes the styling now. So it automatically resolves that styling. Eventually loads, if it loads, if I didn't break it. I mean, I'm just working at that point. Anyway. Did you do splash or was it supposed to be like question mark? It's supposed to be just a dragon. I was just supposed to tag it on there. Here, here's... I did a good example here. Oh, there we go. Path. Yeah, oh, path, yeah. I couldn't get that exact thing going on here. So yeah, so the base URL, and then you attach it like a path parameter with the gist of the CSS, and it applies that CSS on itself. Isn't that nice? That's an interesting customization technique. There is an once, of course, because I'm on HTTPS, and you're putting in another HTTPS domain, so you should set up a service function or something. If you want to figure that out, I can show you. Okay, cool. All right, so we implemented everything, and I was ready to send this out, and I was like, project done, pencils down. Except that I had this friend, and he was like, this is really cool, but I bet you could make this even cooler, because it's hard to figure out what element you're trying to style, right? You've got to go inspect the style sheet. How about if you don't do that, and you just hover over an element, and it tells you what element it is, what classes it has, what ID it has. Then I was like, nah, but then I'll be building Webflow. He was like, all right, fine, fine. And then I think 20 minutes later, I'll be like, yeah, but yeah, it'll be cool. And then 20 minutes later, I'll be like, haha. So you know, like, this kind of conversation you have, I think it's pretty fun. The kind of thing where you start out saying no, and then you're just, like, you're asking yourself if you're whipping out, just because it's too hard. It actually was a little hard for me, because I've never figured out, like, CSS that doesn't trigger a relay out. I know that exists. I don't know how to do that. But anyway, so I figured it out. I not going to teach CSS here but basically what I have right now is this editable thing and then you hover over it and it tells you what element you hovering over And it all done in Svelte and you can go check it out But one nice last effect that I can just show you, for example, here I have a page wrapper up there. So I'm going to say, for example, like, age wrapper, this way grid love grid the light's grid here light's right 1fr nothing you're saying one fraction to me more than another 1fr like this these technologies did not exist in the original CSS Sandgarden and like to redo them again it's so it's just fun it's just like let's just like we can remember what the web It's always about. Is there an explanation? All right, let's do. This would be great if you can just click on this. I think it adds a style. Right. Right. And if you want that, go to workflow.com. And then I always want to show up. Like, people don't realize that you can do in your gradient backgrounds. Use a semicolon instead of a colon. ah, it's fun. And ah, all right, terrible CSS. But it makes it fun again, because you can just drag things around and identify it. And it gives you that flow. And once you're done, you copy, paste into the gist, share it, whatever. I don't know. For me, messing around with Svelte reignites that passion for just messing around with raw HTML CSS JS and writing as close to the middle as possible. One final note. Monocle was pretty big. so it was 679 kilobytes and I just did this couple lines of change switching it to a dynamic import and I just cut it down to 11 kilobytes delivering all that functionality it's pretty good yeah so that's the full features I ended up with a lot more that I signed up for but it's a lot of fun you can see my full write up on my site swix.io or you can pay me on twitter and you can see the demos of it thank you I can take questions if anyone needs anything else. Yeah. So one of the things you were asking about CSS variables I didn try the new support for it but back in the old days it really hurt performance It still an impact Yes in the limit there is going to be an issue But so for stuff like theming, you're only going to change it once. Like how much, how many... It's kind of a static, pseudo-static. Right. Like, I mean you could actually use it for animations. The dragging uses the CSS variable. but like browser is pretty good at that these days so I would say only worry about it once you get there okay hello any other questions did you want to record audio alright I'm Michael Keller I'm a investigative reporter at the Times, and I have the pleasure of working with Rich Harris. I also make graphics and do various kind of data journals and things, and I want to talk about chart making, and a project I've organized, kind of a side project for, which is weird to think, like three years, making charts, that started out as D3 based, and then did a Svelte 2 version and just finished the Svelte 3 version, to talk about both the problem with chart making and then moving it into Svelte and kind of cool things that Svelte both does as a library like handling the state and reactivity that made a really cool choice for this type of problem and also like the component API in Svelte that also made it really nice to just build charts in this way. Does anyone, chart making is not what everyone does, but who has made charts and things generally? Okay, cool, that's pretty good. So I'll start with some history of the problem that I was trying to solve. This is around 2015 or so, I started getting a pattern of like, alright, charts are tedious. And we would generally build things in D3. And we would start, I'll show some code, mostly it's about structure as opposed to syntax. So I think it's showing too much of code to be very fun. So this is a general basic line chart. And kind of the background for making any chart is you got an extent to your data Your values go from 1980 to 2000 and then the whatever other Y values go from some other things And then you measure the DOM container and it's width and height. And you map your X extent in your data to the width, and your Y extent in the data to the height. And it's pretty much the whole thing. And when you think of it that way, it seems pretty simple, but it's really annoying to do over and over again. and it was compounded by the fact that you'd see all these examples online where they were in blocks if you're from the deep world and you'd say oh that seems really cool but it wouldn't have any of the architecture to be updated when you resize the screen which would just get really annoying and so you'd see this cool example and it works in blocks and you try and copy it into your project and you're like okay I actually have to re-architect all this stuff and identify all the things that are going to change when I update versus the stuff that's going to render and what clobbers, what updates, what mutates. And it was really annoying. So this is a basic chart, and this is kind of what you would get off a clock. So you have, we're just setting up some basic global variables, which is also the pattern, which wasn't great. Within your load data callback, you're measuring the extent of the data, your y extent, your x extent, setting that on your scale. This is your little line generator. and then make the path. Pretty simple. It works. But the issue is, you know, you open this up on its own, and you try and resize it, and it doesn't resize. And I remember I was talking to someone on our graphics team who was really, one of my previous job, who was really into doing things in Illustrator, and they were kind of getting into code. And they did this really cool kind of lollipop chart, otherwise known as a Cleveland dot clock chart. And they were super proud of it because they did it, And they were like, okay, Michael, can you help me make this responsive? And I was like, four hours. And they were just like, all the enthusiasm for using this new tool just drained out of them. I was like, this is really annoying. This is what, essentially what you do, this is the same chart, and you can see it's more code, and this is what you have to do to make it responsive. So you have, like, here's our load data callback. and we're setting chart data, because again, it's like global, it was kind of the paradigm here. You bake your chart, which renders the chart, then you set your values, and these are all various things,

 measuring the data, measuring the extent of the DOM. Render chart is the thing that actually is touching the DOM, drawing it all. You have to think about all this stuff, and it's annoying. And it's like, all right, on resize, do the on resize function, which you set the values, you render the chart. And it was just like, I know how this works, and I don't want to do it every time. And so I think that's a good opportunity. It was like, that is great for a library. I'll take a step back. So this is great. It's like, great, I want to make a charting library. there are many different approaches to this. And I think most of them, well, I'm not saying most of them, but I'll say there's two is kind of like the low level, which is what is kind of the D3 way, where it's like here's a bunch of utility functions and scales, and scales are just being the heart of any chart thing. You kind of add it, do it. You end up with this situation where you have to manage the architecture yourself as a user. Or you have the kind of like, anyone remember high charts? Yeah. Kind of like dates myself. Yeah, like high charts. Or like the Vega paradigm where it's like, all right, I don't want, I just want to say like scatterplot. Because it's kind of insane to like do all that for just a line chart. These are like pretty basic chart forms. You should be able to get some data, say I want a scatterplot, and you get a scatterplot. The problem then is it's very rare that you just have a chart that you reuse the same over and over again. There's always going to be like a little fiddly thing. There's going to be like label placement needs to be done special. Or like, the x-axis ticks need to be different. Like, no matter how many times everyone's like, we have a style guide. There is no style guide for x-axis ticks. It's always different every time. And so if you do that kind of like very high-level, high charts or vega scenario, you end up with kind of like this spec where it is kind of very, like I'm just typing out some JSON, but you have to learn, this is like a grammar of graphics implementation. all of this very specific vocabulary and concepts, like what is a series what is a tick what is a mark and it's really neat because you can get into it but then when someone is telling you oh, can you just like make a little tick in between the year to kind of show each month you're like, okay, I need to translate that into the language of the spec and that I find just even harder because like I kind of like well why did I learn all this thing I just know how to write a loop and I can place that on my scale So I didn want to do something that was super high as that which is what a lot of the charting libraries were Any questions so far? Sure. Trying to go back to that. Okay. So that's kind of the first two issues. One, low-level is kind of tedious. High-level, you lack customizability. The third issue we run into in the newsroom, we're building things on deadline. You have to decide, really at the beginning of the project often, what kind of technology we're going to use. Is this going to be like an HTML? Because if it's a column chart, you can just do it in divs, that's totally fine. Is it going to be SVG? It makes sense if you have a line. But then you're like, alright, this is an SVG, and then I have a little label for my line line annotation, and then an editor comes up at the last minute and they're like, actually, we want this different label that's like ten more words, and it needs a line break. And you're like, I have to implement line breaks in SVG for mobile and all that, and your editor, of course, doesn't really understand why a line break is so hard, and to their credit, it really shouldn't be, but it is. So I was like, I want to build something where those changes in language I can abstract away a little bit, so that if someone says, alright, we actually need a ton more data, and I think I should render this in Canvas as opposed to SVG, I can do that more easily, and I'm not working on alright, I can kind of do it, but I need to make a Canvas overlay that matches my D3 margin conventions, and that type of thing, which I'd done for a few charts, graphics, and it was fun and cool. I thought this could also be a way that we could just eliminate some of the differences here. so I ended up building Layer Cake which is Layer Cake.graphics you can check it out this is a little bit of the API it uses the idea is that the library itself uses spelt stores and spelt context to do all of that scale handling, it measures the extent of your data it measures the target div that your chart is going into does the scale for you, and then because these are all stores and reactive, you get all that resizing for free when the dimensions change, which is number one, like a great thing, it works really well with the spell reactivity The second part is the spell syntax of the component So you can see here we import a layer cake component from the library and then it exports the SVG HTML and Canvas wrappers. The idea was that it would be really declarative. I didn't want to repeat myself that much. So the main thing you're declaring is kind of like the X and Y accessors for your data. So if your data looks like this, you tell it, alright, get the X dimension on the X, Y dimension on the Y, here's the data. And then you can use the built-in layout wrappers, or what they're called, to put your components in there. Now one key thing is, you'll notice the axis, the line, the scatter, the labels are not part of layer cake. Those are components that live in your own project and are really up to the user to build. And that's because, I think, one, building libraries is fun. Maintaining libraries is really hard. And so you also lose that customizability. So by putting all those, you can't really build the end-all, be-all scatterplot component that's going to work for your project. So don't even try and do that. the user can start with a little bit of sample boilerplate, which is what that looks like, and then just start building off that to make it custom for them. So I'll show you a basic scatter plot. And then because all of the coordinate systems are synced between the SVG and HTML on canvas, it makes it really easy just to kind of move between them because you can add as many of these overlays as you want. So this is the main one. So this is an SVG scatter component. You use the svelte get context function with the keyword layer cake. And so you get your data, and you get this x get and y get function. And so this is really just what the starting scatter plot component would look like. xget goes into the data and grabs the x key from your accessor and then also applies your scale translation it also exposes just the accessor and just the scale if you wanted to use them separately but most often I use them together and in a lot of D3 code you see this just like nesting of like x you know d x x scale and I get confused like is x the x scale is x the accessor so it like this needs to be one Most often that the case but if you need them to separate there an escape hatch And the other thing so building it building it in D3 was all right but you didn't have this great, I think it's really nice to be able to start composing graphics like this. Because then from project to project, you can start reusing them more. You know you have a common starting point for each of them. As you're jumping off point, you know you're going to customize, but you can start just kind of composing them and it feels just much nicer. It's also nice because in Svelte 3, the exports are really cool. And that was one of the big changes from going from Svelte 2 to Svelte 3. I used to have this options object that was kind of annoying. And it was actually still a JavaScript API, So in this new version of Eric Cake, it's all as a component API. So you can start to build kind of this like canvas scatter component, export the R and the fill color, and you have kind of what's a pretty good beginning of a reusable scatterplug component. And it uses internally D3 scales. So you said it is expecting either an X, a Y, a Z, or an R accessor. you kind of get four. If there's a use case for more than four, let me know. It seems like four seems to be enough. And it uses D3 scales internally. You can pass in your own D3 scale, your own scale as long as it has like a, actually I think it's pretty open as long as it has like a domain and a range method on it. The idea was there, it was like I wanted this to be maintainable and just bite off as much as I could chew. And there's so many different use cases that D3 scales comes up with that I don't want to have to fit into my head, ordinal scales and all that. So it's time to work there. And I think that's pretty much it. And then so Rich is going to present on a similar charting library, which is really cool. And he gets at some of the SSR issues that I hadn't thought of with this. And then we'll talk about some of the, like, I think they're very compatible, some really cool techniques that he's thought of. And yeah, any questions? We'll do questions at the very end. So yeah, on the website there is more examples that show some interactivity. This is one that shows kind of the idea of, like, you can have a Canvas background if you don't want

 waste DOM elements on visual elements that don't need interactivity, whereas SVG is much easier to do hover stuff on than Canvas, so that's a use case for where you want to mix the two. You can do swoopy arrows, some other kind of tool tips, Voronoi, that's that legal dot plot. Animatings, this is when you want to switch between the domain of the specific data versus a global domain, and then some kind of other interactivity. with it. This is super cool. So all the implementation for all these examples is not going from the library. You're just coding it yourself. Right. Do any of them use D3 in user land? Can you do that if you wanted to get the data reactively and then have it run D3 code every time it changes? Yeah, I mean it's a spell component so whatever goes in that is totally up to you. It uses the layer kick slots. So it's just going to plop whatever goes into your component into that wrapper. So if you wanted to run some SVG stuff, you could have your own little SVG thing here. And I think I have some examples. I think this one has for the line generator. This one is using just constructing the line manually, but I have some in here that use D3 SVG generators. I mean, this is all using D3 projection. So that's an example of D3 Geo making the projection reactive. I built this one. I tried to build the examples on the website of thinking of what's a pretty good generalizable example. So this one kind of lets you pass in the projection name as an export. I think, yeah, the area uses D3. D3 shape. And also imports just a D3 scale to do the work and all stuff. That's using the area generator. Very cool. As someone who's worked with a lot of these libraries, I think there's a lot of wisdom in just taking on the data part, you know, and like you said, basically taking off the rest of the user land. Yeah, I think it was kind of like the nib of the pen, because that's really what you want to you want to worry your time around like what is actually touching the DOM and then let and Svelte does a great job of just handling the reactivity for you and then those wrappers just kind of give you some escape hatches of what technology what format am I using this in, and the margins. So you can do the SVG and then the axis bumps off the edge, so it just uses that, like, the P3 margin convention. How do you use it at work? Yeah, I've used a version of this sitting next to Rich. Rich makes great graphics, so I've only had to make a couple. what charts that is. But, let's see. I used... What was the headline of the... The Chan story? Yeah, YouTube wanted a Chan story. Flourishing business. YouTube news. This was the story I did that I did the charts for. This was the first... This was the Spelt 2 version, which was like, oh, Michael, you're running this story, by the way, also make the charts for it. And that was about six or eight months in or so to the job. I was like, I want to learn Spell. So I was like, alright, let me try and import the D3 layer cake into Spell. And it worked really well. So these are layer cake ones, which was really nice because you can start building it up. They all share the line component, but the color gets passed in as a prop, so that's reusable. Again, it's small multiples, so that's really lends itself well to the component style. And then there's like, you know, that line is one layer, and then the annotation and the arrow is another layer. So it was nice to compose it in that way. Fighting the good fight, that was it, right? Yeah. This was using what I learned was a not well-written and buggy version of Lara K3. three, these are all just awesome graphics. And then I made scary blind charts. But, yeah, so those are two. This isn't the version that is now published, because this version is not as good. But yeah. We'll have this much more. But that chart down there is made with layer tape. Yeah. So that's pretty, I mean, that's pretty custom. Like, if you try to do something like that with high charts, like, it would just be that. Yeah, yeah. And there was stuff in this where This was a little bit of a challenging, pretty simple chart. I guess that is assigned a good one where it kind of a challenging data set but a very simple visual But we had some data issues where you can see the y is over 150 And so we had some months where it was very very small but we still wanted that to show up So it wasn't like a pure mapping, so we kind of had to set a base, a floor of like one pixel. And so similar things where if you want to use like D3 path generators, like the defined method is really useful. or it's like if I don't have data or like here's a function that will tell you whether to draw data. You run into stuff like that all the time. It's a very simple chart format. Would the logarithmic charts work better for that? Logarithmic charts are really difficult I think for readers to understand. I think we also the visual effect of this was we wanted to show the massive increase so the narrative would have been a little counterproductive. It was flatter. Yeah, it's always really challenging when you get a data set that has those huge differences. And I think, yeah, you can talk, there was a log scale for some of the coronavirus stuff that you were particularly involved in that. You can speak to log and make scales in general and make a decision on that one. Yeah, it's tough. Just wondering, like, it seems like kind of high stress, like you mentioned all these deadlines. Do you need to have, like, a fallback option if whatever you have in your head doesn't work? Or are you just that good? Chart-wise, the first attempt never works, I don't think. You just kind of have to cobble together stuff that eventually does. But I think it's a good, it's kind of like the high stress often yields a good result because you have to constrain sometimes what you want to do, which in the end crystallizes it. At the end of the day, it's all about telling a specific story and a really clear story. and so that kind of like alright we really need to get something there how do we boil it down to that really simple idea just one last question so like this example where you do the annotated column it's kind of what you were talking about where you want to use HTML to render text so it takes care of wrapping exactly and I should have one of the real things that I wanted to do is like SVG chart HTML does text really great let's throw the HTML in there. But again, this is like a really, it gets complicated really quickly, because you have an SVG layer for the column a text layer and then arrows And the way I wrote this arrow I don know if you call it a library but the arrow component in here works really I don know if declaratively is the right word I don't know all the definitions of this works. All the other programmers and I am. But for me working, and take a step back, there's also a lot of people that do illustrator stuff, like charts in the newsroom, which is great. Why I've gravitated more towards the code approach is I do better when I just have to do things in one area, one spot, and then it cascades down. I'll make the chart once and then it can work for mobile, as opposed to let's do three different charts for different widths. There's a misspelling in this annotation now to change it across your files. I'm much worse at the ladder problem. What I designed for this example was the arrows attached to the text, the HTML text. So you can move the HTML text around, and the arrows will follow it. Because I always get annoyed when it's like, alright, I want to change the arrow, I want to change the text, which is constantly changing until another publication, and then I've got to change the arrows again. I've got to follow it. So then you not only have the column SVG layer, well you do those different layers, you have the column layer, the HTML layer, then the arrow SVG layer can read from the HTML annotation layer and kind of cascade down. Which for me I like better and it's kind of cool to have that only be done in one place. But yeah, so again, it's pretty simple. I'll have to say it's already simple, but having in those different components helps. You're saying if you change the text, the arrow would just stick to the edges of it. Yeah. Yeah, so I kind of wrote this little clip here where the annotations you define in this JSON object, and again, this is all outside the library. This is just however you want to build your components. You define where that text is based on percentages, and then it has an array of arrow objects, which can be clockwise. The source attaches to these options. You have a dx and dy, so you can fiddle with it, because you always need to fiddle with it. And you can apply the target. I think you can apply the target in percentages or pixels, I think is how I ended up doing it, but I think I always do it in percentages. Yes, this one has two arrows coming off of it. And so this is an example... The only difference if we were used to the D3 margin convention is I'd rename it to padding because margin just didn't really make any sense.

 The CSS padding paradigm is much closer to it. And then it's normally a linear scale, but you can pass in your own scale. So for a column, you may want to do a scale band or whatever. You can pass in your own. If you want to overwrite any of those built-in, kind of measuring the extensive things, you can pass in your own custom ones. This was a feature I often found for the line chart is a good example of this. If you want, for the area, obviously the y-axis you want to set a hard floor at zero, so the metric is showing in front zero, but you still want to get that automatic extent calculation, so you can say, set the y-domain at a floor of zero, but null for the max, and then it will just take what it needs up from your data. So I built in some things that for me as a user, I want to offload as much of that automatic calculation. Like if the library can calculate it, let it do that. And then me as a user, I'll just kind of add in a little bit of custom things that I need. Thanks. Thanks. I was going to use the same screen recording. Yeah. Okay, um, edit it later. See if I can turn off that sound. I think you said it should be smart. Yeah, it's probably actually, um, Browser discourse. Oh, yeah. So, this Game of Thrones thing that Michael pointed out earlier, I think it was the first thing that we did with Stull at the New York Times and you can tell that it was done in 2017 because Daenerys is still in the good quadrant. Although you go back every few months and she's shifted a little bit to the left. Okay, so today is not just Svelte Society in New York City, it's also happening in London today, a worldwide Svelte meetup extravaganza. And in a couple of weeks it going to be happening in Russia as well and the organiser of the Russian meetup asked if it could be called a video to set things off What do you say Sorry, I'll... What's Russian? Hi, I'll say it. Privet. Privet. Privet. Privet. Well, that means hello. Yeah, for sure. Okay. I see it. Okay, so I will say, in the video, I'll say on behalf of Svelte Society, I will say Privet. Privet. Privet. Privet. Hey there, it's Rich coming to you from the Microsoft headquarters in the middle of New York City. There's no windows in this room, so I'm just going to have to take my word for that. It's the fourth Svelte Society New York. it's been really incredible to watch the growth of the Stout community in Russia and it's awesome that you're having your first meet up and the leadership of Pavel and others in the community so I just want to say from everyone here to everyone there Dreamer! Dreamer! Dreamer! Dreamer! Thank you! Thank you! Thanks! Alright, thank you So The other day I posted a blog post about about this charting library that Michael mentioned. So what happened is a few months ago, before the new version of Layer Cake came out, I was tasked with building some charts for a story that Michael was working on, which was what delayed the release of Layer Cake in the first place. So our bank of desks at the New York Times has a very high ratio of stalled charting libraries. And so I started from scratch because Layer Cake didn't yet work with version three. and I came up with a chart and library that does a very tiny fraction of what LayerCake does but it just has one clever trick which I felt was worth putting into an NPM package and releasing, which is that Pancake, the chart and library that I'm talking about, can render charts that don't actually require JavaScript to run in the browser. What I mean by that is that you go to the website, the Pancake website. So this is an example of a Pancake chart we got a tooltip here that shows the data it changed off from But if I were to disable JavaScript then it would still work We don't get the tooltip anymore, but the chart itself is still visible. The data is still visible. And this chart is totally responsive and all the rest of it. If we had some responsive CSS on this, then that would also work. It's just the JavaScript that's missing. So this is a good example of something that is being progressively enhanced. And the same is true for the other example charts that we have here. I can't click these buttons and I can't use this filter here, but the chart itself does work. I'm going to re-enable JavaScript so that I can show you what they do. So this is a population pyramid chart. You can see that back in the 1850s, there were way fewer people. And then you kind of see here that there's more men than women in their 40s and 50s, in the 30s. And then at a certain point around 1970, all of a sudden, that flips around. there are now, like as you get older men die off a lot sooner I'm not exactly sure why that is but it's kind of interesting to see that there are fewer children flipped around ah is that a story? probably that's a pretty good hypothesis it's interesting to see how that's flipped around between 1930 and the present day and then this life expectancy chart we've got some interactivity here where it'll find the nearest point to where the mouse is and then highlight that line. You can filter a specific country like that. This is the kind of thing, you saw that Vega chart configuration earlier, that giant blob of JSON. You can't imagine trying to do all of the little micro-interactions and customizations that you can so easily do with JavaScript through the component library using some sort of configuration type approach. Because it's spelled, we can also do nice motion and transitions and stuff, all of that, without having to put that in the charting library as well I not gonna talk too much about how this works because I covered it very briefly in a previous society and also I've written this blog post so if you are interested in how it works without JavaScript then it's all written down there one last thing I'll say about this I'm actually using the same technique in a mapping context we're doing these charts at the moment tracking the outbreak of coronavirus and these charts need to work on mobile and on desktop. Completely responsive. But it also works without JavaScript. An earlier version did use JavaScript and it meant that the first thing that you saw when this page came to life was this. Like you would see some text and then you would see a header and then you would see a footer and then you would see some more text. And you had to wait for all of the analytics code and the ag code and the comment code and all of that to get out of the way before our JavaScript would run and then D3 would load and then we would load some geodata and then we would construct a map and put it into the DOM. But now that we're using this JavaScript-free technique, as soon as you load the page, the map is already there. So it's doing a better job of conveying information to our users. That's enough to talk about charts for one night. I wanted to make some announcements about a tool called DGIT, which is not technically part of Svelte, but it's what you see when you first visit Svelte.dev under the Getting Started section. npxdgit, Svelte.js slash template, my Svelte project is how you start a new Svelte project by default. MPX, for those of you who aren't familiar is a tool that downloads and executes packages from NPM so dgit is a thing that you could install globally you can just type dgit, spell.js slash template, my spell project but MPX means that you don't have to have it installed globally and whenever you use it you'll get the latest version spell.js slash template is the repo on GitHub where this project lives and then my spell project is just a new directory So this is, to my mind, the simplest possible way that you can scaffold a new project. And it's a little bit different from how this stuff normally works. In React land you have Create React App. In Vue land you have Vue CLI. Angular has its own CLI as well. And this is how most front-hand frameworks handle project scaffolding.

 is by having these sorts of opinionated tools. There's a few pros and cons to doing it that way. On the pro side, you can be extremely opinionated when you're building tools like this. You can have all sorts of nice error messages, give the user lots of good feedback. After you've created a project, like we create React app, you can then maintain it later if there are updates to the project template, new version of Webpack, whatever it is, then you can add that even after you've made changes to your project. You can do things like add new routes to your app if you're using the Angular CLI. And you can have wizardy-style interfaces where you'll ask a question like, are you using SAS? Do you want to use Babel? And you can say yes or no, and it will configure your project accordingly. But there are some pretty concrete downsides as well. There's a lot of complexity. There's a lot of stuff that you need to try and learn and understand in order to deal with these CLIs. The tool itself is under constant pressure to encompass more responsibility. A lot of people will be like, why doesn't Create React App use TypeScript? So the CRA team has to consider adding TypeScript and then it just becomes this ballooning thing of like addition after addition after addition. The third one I think is crucial. You can't make your own templates. My idea about how to create a self-project might be very different from yours and if you need to do something equivalent to create React App or the Angular CLI in order to customize these tools, then I think that's a pretty major downside. And the last one, you're going to eject anyway. The point about being able to update stuff after you've created it, only applies until you eject from the project, which is the thing that happens when you need to add some customization that the tool did not anticipate, and then you just turn it into a regular project and then start editing it. And at that point, you can no longer use the tool to maintain the project. So I prefer a much simpler approach, which is just cloning it. And from that point forward you can make any changes unless you want to faff around with the Git history but you probably not going to need to So dgit is a tool which allows you to clone a git repo without also cloning all of the git history And it's faster, and it works offline, and there's less to type, because you just need to type mgit.git.js.template. instead of git clone and then a fully qualified git url and then like dash dash depth equals one or whatever to stop with the history and it seems to work pretty well there are some downsides to this approach but it does seem to work pretty well the reason I'm talking about it tonight is because as of today there's some new stuff in DeGit which will make it nicer to start a new self project firstly faster installation through bundling I can demonstrate this. So if I were to do npx Can you make it far bigger? Yes I can. It's bbps Hang on 2.6.0 So that's the unbubble version You see it took 3.274 seconds to install there, and then if I get the most recent version... Hopefully this is going to work. Yes it did, okay. Okay, so way faster to install, and the reason for that is because dgit no longer has any dependencies. Instead, all of the dependencies are def-dependencies, which means that they that they get bundled into the package, which means that you're only requesting one thing from NPM. You're not requesting one thing and then requesting all of that thing's dependencies and all of their thing's dependencies until you've got the entire graph. There's just one blob of JavaScript that takes care of the whole thing. It also works with private repos thanks to yes You still have their CDN and YAR install right Yeah so if I go into that directory then I would still need to do MPM install I was going to say, if you saw MPM install in one second, I would be on your pre-trip right here. Yeah, and honestly, we can probably make the project template a little bit simpler so that we're not having to do any of this no-chip stuff. Oh, God. That took 20 seconds. Well, my first thought, sorry, I can ask you about another thing. No, no, no. Keep going. Well, I was just quickly going to say, like, my first thought when I saw this was it was a good way to, like, if you want to reproduce something, like if you wanted to, like, maybe not even for a project, but like, let's say you wanted to create a spell starter or something that people could create to reproduce an issue before opening an issue. It seems like a really good way to do that. And what if you could, like, cache the node modules there? So it's basically just a really easy way to get that on my computer and I can reproduce my issue, upload it, and then, like, post it. As an open source maintainer, I have the same problem where people don't, it's hard to get people to reproduce things. Yeah, one thing that we can do with DGIT is add what I call actions. This is where it gets slightly opinionated. An actions is actually a micro-color idea. Where after you've cloned the repo, you can then do something like remove some files or add some new files. You can conceivably add an NPM install set there that would do that automatically. The way that it's implemented is it just goes and fetches the latest for whatever you've specified, using the local cache if that fails for some reason. And then it's just extracting that table. So you wouldn't have node modules inside that, unless we changed the architecture a bit. But it definitely an idea Yeah So the other change is it now works with private repos It used to only work with public repos but thanks to a pull request it can fall back to using Git clone So if you have your own private project template, it will work with it. And perhaps the most exciting new feature is we now have an interactive mode. So I can just do npx ggit, and it will give me a list of all of the things that I have cloned already in reverse order of how recently I used them. So because the last thing that I cloned was the Svelte template, I can just hit enter, destination directory. I can decide whether I want to use the cached version. I don't. And then off it goes. So cloning Svelte projects just got, or creating new Svelte projects rather, just got a little bit easier. Again, thanks to a brilliant pull request from this person's... I don't know how that sounds. Yeah, that is it. New version of Digit. You'll like it. That's all for me. Cool. So basically it's four books and now it's time to hack it. No, it probably would be so fun the people who haven't even thought about stuff... the top 2 , remove the top 4, 5, 6, 8, 11, 11, 12, 13, 14, 15, 16, 16, 17 18 April Fourth Yay!