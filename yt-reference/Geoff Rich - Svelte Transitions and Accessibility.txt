 Thank you. Hello, I'm Jeff. I'm a software engineer at Alaska Airlines, and today I want to talk about Svelte transitions. Svelte transitions are amazing. I love that with only a few lines of code and no additional dependencies, you can add some animation that can really make your app stand out. However, you need to be careful. Some people are sensitive to motion. If you use these transitions irresponsibly, they can trigger headaches, dizziness, and even nausea. and this is not how people should feel when they visit your website. Remember, to quote the official Svelte transition tutorial, with great power comes great responsibility. In this talk, I'll talk about the types of animation that can cause accessibility issues, how to detect if the user has requested reduced motion, and how to apply these concepts to Svelte transitions. First, let's talk about motion and accessibility. So who does this affect? Well, the largest group affected by animation on the web is people with vestibular disorders. The vestibular system controls your body's sense of balance. If it doesn't function properly, you could experience dizziness, loss of balance, and vertigo, among other symptoms. And animation can often be a trigger for these effects. According to the National Institute on Deafness and Other Communication Disorders, 4% of American adults report a chronic problem with balance. millions of people, many of whom could be using your website or app. So what kinds of animation can cause issues? Well, there are a few factors. In general, you want to avoid large amounts of movement. So a button moving a few pixels when you hover it is okay. Something flying across the entire screen could cause an issue. You also want to be careful with multiple elements moving at the same time, especially if they're moving in different directions or at different speeds such as parallax movement. Tying any movement to the user scroll position could be problematic especially if the element is moving at a different speed or direction from how the user is scrolling I recommend the A List Apart article Designing Safer Web Animation for Motion Sensitivity from Valhead if you want more detail on this. So with that in mind, what Svelte transitions deserve extra caution? Well, of the seven built-in Svelte transitions, five of them involve motion. Those would be fly, slide, scale, draw, and crossfade. Transitions like fade and blur that do not involve motion are unlikely to cause issues. This doesn't mean that all uses of these transitions are problematic. What you should look out for is the amount and direction of the motion. So does that mean if you care about accessibility, you're not allowed to use these transitions? Of course not, but you should provide an alternate experience for users who are sensitive to motion. That's where prefers reduced motion comes in. So operating systems have started to add ways for users to request reduced motion. Here's where you can find it on iOS and Mac, where it's called Reduced Motion. Here's where it is on Windows under Show Animations in Windows. Chrome also lets you set it directly in DevTools, so you can emulate that experience without having to adjust your OS settings. Here's a video of how iOS behaves when you have the setting enabled. Motion warning for the next few seconds. Normally, opening an app triggers a zooming animation where the app expands into view. However, if you turn on this setting, apps fade in and out instead. Originally, the setting was just for users to control their operating system, but it's also available as a media query in web browsers, and it has great browser support. So we can detect if a user has requested reduced motion and adjust our site accordingly. So let's recap. We know that large amounts of motion can trigger dizziness and nausea in some of our users. We have a media query that can detect if they've requested reduced motion. But how do we apply that to transitions in our Svelte application? Well, there's a few different options. Enough slides, let's jump to some code. First, let me show you where we're starting. We have a checkbox here that will hide and show this box. The box is apply transition applies that flies in and out. I set the Y parameter very low to minimize any triggering motion. Here's what the transition looks like with reduced motion disabled. So the first way to respect reduced motion is to disable all animation entirely Svelte built transitions are applied using native CSS animations so this snippet will prevent those animations from playing if Reduced Motion is turned on Because Svelte transitions use inline styles, we need to use important here so that this override applies. So this seems to work. If I enable prefers Reduced Motion in Chrome, then the fly animation doesn't play. Is that all there is to it? Well, this approach has some drawbacks. It's definitely better than not respecting motion preference at all. However, we use animation for a reason. Animation is often essential to make your interface understandable, so we don't want to turn it off entirely. Remember, it prefers reduced motion, not prefers no motion. Instead, we can behave more like iOS does. If reduced motion is requested, change the animation we use to have less motion. On iOS, they changed the zoom to a fade instead when an app opens. We could do the same, fade the element in instead of flying it in. Of course, this approach requires more vigilance on the part of the developer. You need to be intentional when implementing animation and choose what the fallback should be for users with motion sensitivities. But this approach will result in a richer experience for those users as well. Even if you do choose to globally disable animation like this, Remember that some salt animations are applied purely through JavaScript, not CSS. Custom JavaScript transitions and animation using the spring or tween stores won't be affected by a CSS-only solution, so it's worthwhile to consider other methods as well. Now, let's look at how we can detect reduced motion in JavaScript and change the transition we use accordingly. This is the same component as before, except now the transition we use is stored in a variable. Transition to use will reactively update based on the value of reduced If reduced motion is true, we'll use the fade transition. Otherwise, we'll use the fly transition. But for that to work, we need to set reduced motion properly. First, we'll call window.matchMedia to get a media query list that will tell us if the reduced motion media query applies. We can also add an event listener to this list so that if the user changes their motion preference, we can immediately react to it instead of only checking on initial load. Just like any time when we add an event listener manually, we need to remove it when the component is destroyed. Finally, if you're doing this in a server-side rendering context like SvelteKit, you need to make sure we in the browser so we can use a function from the window That all there is to it When we set refers reduce motion the box now fades in After we unset it, the box flies in. This works great. Now let's make it more reusable. Stores are a great way to extract reactive logic in Svelte. I've updated this example to use a store instead of a local variable, but we still need to implement it. First, we'll get the initial value of the store using the query from before, defaulting to false if we're not in the browser. Then, we'll pass a function as the second argument to the store. This function will be called when the store gets its first subscriber, so it's a great place to set up event listeners. We'll add the listener from before to react to preference changes. We can return a cleanup function to remove the event listener when there are no more subscribers. Just like before, we only want to run this code in the browser. There you have it, a reactive, reusable store to detect the user's motion preference. Writing all this code begs the question, could Svelte make any of this easier? My answer is maybe. At minimum, I think it would be good to document the need to respect motion preferences when using Svelte transitions. However, I think it's tricky to figure out just how much of what I showed could or should be integrated into Svelte itself. For instance, I wouldn't want to add that animation disabling CSS snippet into the template and call it a day. As I talked about earlier, there's a lot more nuance involved there. At its core, this is a design question, and there isn't going to be an answer that's the same for every app. But maybe there's a way to make it easier to adjust animation based on motion preference by adding similar code to what I showed you. There is an open GitHub issue around this already. If you have thoughts or suggestions as to how to make this sort of thing easier, go comment over there. But at the end of the day, it's our responsibility to make sure the code be right is accessible. Anything Svelte does won't change that. Thanks for watching. If you want to learn more, here are some resources I found helpful when preparing for this talk, by designers and developers much more knowledgeable about this than I am. At the bottom are two articles I wrote on my personal blog about this topic earlier this year. They form the foundation for this talk. You can find me on Twitter at Jeff Rich with an underscore at the end, or at my personal site, jeffrich.net, where I regularly write about Svelte. If you have any questions, feel free to reach out on Twitter. Thanks again.