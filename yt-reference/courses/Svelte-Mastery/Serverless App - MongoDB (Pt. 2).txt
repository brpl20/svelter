 Okay, hi there. So in this video, we are going to set up MongoDB with our little CRUD function that we wrote with Vercel serverless functions. This is going to be a very simple way to set up with MongoDB, not production ready. I'm not a MongoDB expert, but this will get you up and running and you can start learning with it. Okay, so last time we made this little guy right here. And if you haven't seen that video, there should be a link in the description. In this video, what we're going to do is set up MongoDB with this API. So we're not going to do any Svelte code or anything, just that'll come next video. Okay, so we got to set up our database in the MongoDB website and then we have to basically get the URI so we can connect to our database and put that as an environment variable in Vercel and then we will set up the API. Okay, so let's see how quick we can do this. So first you want to sign in or sign up. Once you do that, you're going to be here. You want to create a new cluster. So I already have one, but you should see this page and I don't really know what this is doing very well so I just go down and create cluster with the default. So that will start your cluster, it's going to take a few minutes. So while we're waiting we're going to go to database access and we're going to create a user who has access to our clusters. So add new database. Okay so I'm just going to do something very simple, like I said this is not production ready but I'm just going to make the name Svelte and also the password is Svelte. Keep it simple. Okay, read and write to any database. So they have full range, do whatever they want, and add user. Okay, so now we have a user and then we need network access. So which IP addresses can access our database? And again, just setting this up so we can practice. It's going to be allow access from anywhere and then confirm. Cool. So we have that set up. Going to come back to clusters and it still might not be ready but once it is you're going to connect and then connect your application and we're going to take this right here and put this as an environment variable in Vercel. Okay so come to your dashboard and then go to your site we're just doing practice as our site and then go to settings and come to environment variables. Okay so So what you're going to do is plain text and what do we want to call it? You could say dburi maybe and then we paste that in here So there a few things we need to fill in ourselves So right here the password So remember I did Svelte and Svelte as the password and then the database name So since we haven't actually created a database yet, we can put anything we want here. So I'm just going to call it Svelte as well. So our database name, how about Svelte DB? There we go. Okay. And which environments should I put this in? I'm just going to put them in all environments. Cool, safe. And somehow it will just automatically is going to work in our dev environment too. So here's new crud. This is where we're going to be working with everything. So npm install mongoose, and then up here we're going to require it. And then we're going to get that, after you've done that, we're going to get that environment variable. So it's going to be process.env.dburi. So now we have that URI there. And with that, we can connect to our database. Okay. And it's going to be this right here. So mongoose.connect.uri. And then we got some config right here, which to be honest, I'm not completely sure what it does, but this is what I saw. And then an error function in case the connection fails. Okay. So that is going to connect us. And then finally, we want to create a schema. So basically, what types of documents are we adding to this database? So we're just going to have a simple one of name string. So last time, all we did was name string, but I'm going to add age in to make it a little more interesting. So now we have that. And then we just sort of initialize our schema as a model. Okay, and this variable right here, person, is what we're going to use to interact with the database. Okay, so we can't quite see if everything is working yet. We're just going to have to write some of our functions and then get it started and see if they work. So we're going to Vercel dev. So this is all sort of the boilerplate that we have. Now, first thing is person.find. So basically we have four things. Person.find, newperson.save after creating a new person, person.findById and update, and then person.findById and delete. So we're going to go through each of those. Okay, so person.find is just going to find all the people in this collection, this database. I'm sort of, I'm not quite using those terms correctly, I think, but... Okay so person and then after you find them it going to pass you the people and we going to send that back to the uh client okay so let try that so basically it should be empty i going to come here to insomnia so get items localhost api slash crud but this is new crud i think yeah that's what i called it okay so send let's see if this works okay cool so we're getting nothing which is what we're expecting because we haven't uh put anything in there yet but let's see i'm actually not sure if we come to our cluster and you click on collections, that's where we can see the data in our databases. So it might be nothing because we haven't added anything. No, it's nothing yet. Okay, these are from before, so you should have nothing. Let us put something in the database and then we'll see something. Okay, so remember the name of our database is SvelteDB. So that SvelteDB should pop up here. Okay, so for post, what you do is basically you take from the client. So you could probably check, you probably want to check that the client passes the right things, but basically client has to pass in a name and an age object. And then we take that, we pass it into new person, and then we call on this new person dot save. And once we've done that, we'll get the new person and return them back to the client. So let's try that here. come to insomnia, create item. Okay, so sandy 16. Oops, shouldn't be crud, should be new crud. Send that, cancel request, cancel. Nope. No, okay, that's wrong. Wrong, wrong, wrong. Okay, cool. So we have just added sandy, and if we come to get items here, and we try that again, cool. So we have Sandy. I guess I added Sandy twice somehow by clicking it twice or something. But we come here to our UI and here we go. So it added SvelteDB, our people, and we have under people, oops, that was practice.people. We have Sandy and then Sandy again. Okay, cool. So notice SvelteDB and then people. People comes from this up here. So the name of this model is person. I use the person schema. And then the plural is people, which is what our collection is called. So I'm pretty sure this is the database. And then this is the collection. Okay, so if we come down here a bit, now we want to update these people. So I accidentally added two Sandys So now let try to update one of them to Bob Okay so we gonna get a person and an ID So the ID of the object we want to update So if we come to Insomnia we see we have this underscore ID So let update this one to Bob. Okay, so update item. Going to give it this and also needs an age. I don't really know how old they are. 15. Okay, so what's it? Oh, okay, I'll run it and then... Oh, crap, I keep doing that one. Okay, so what it's going to do is take person and ID off of the body, so ID here and person, and then it's going to pass that into person.findByIdAndUpdate. And then we do return original false because we want it to return the updated person after they've been updated. If you don't have this, then it'll turn the person before they were updated, which is what we're doing here. Okay, so here we go. And now we have Spongebob age 15 instead of Sandy age 16. So if I refresh this, so Sandy Sandy, Spongebob age 15. Cool. So that update worked. And then finally, we have our delete down here. So this you just need to supply an id and find it'll person.findbyid and delete that id and then it'll pass back the deleted person. Okay so notice all of them start with person.something except for the create. So first you have to create the person and then do new person.save. Okay so find by id and delete. Let's delete sandy. So take this id here here. And I won't forget this time, new crud. Okay, so we pass in this ID and send that. Okay, cool. So we should only have one bob right now. Basically, it should just say Spongebob. Yep, so it's just one Spongebob there. Cool. So that is pretty much it. So you can play with around with this. So I have a very basic error handling, but you will want to look up a better way to do error handling. Basically, you want to check to make sure the client passes the right stuff into your API, return like a 400 error. I was going off of this article, like I mentioned before, they do a bit more error handling, you could check that as well. But it's always nice to have good error handling. Okay, that is the end of this video. Let me know what you think. And in the next video, I will add some Svelte code on top of this API. Okay, have a good day.