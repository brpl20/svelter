 Hey, welcome back. In this section, we're going to learn how to add a tweet using the post request. So far, we can only read hot text, but we can't post any. This requires urgent fixing. So first, we're going to create a composed swell component inside components, and then we're going to import it inside the home index swell. So here, we just have a simple component. We're going to bind the value of tweet. Here we have the max characters. Then we have here a reactive value characters left. That's equal to the max characters minus the tweet length. and we have some markup here and that's pretty much it. There's nothing complicated here. So we can go to the source. We can create it under components. So you can say compose. Let me close the sidebar and then let's add a script tag. We can say language type script. Then let's add the tweet. Say max characters 140 like on Twitter. Then we're going to have a reactive value. characters left equal to max characters minus the tweet length and then let's add the markup we can then compose here we have an image that's going to be profile the hard-coded username but you can get it from the session right avatar type p the description is going to be avatar and then so it's more readable let me do it like this the action is home remember the endpoint we created method is going to be post and also I'm going to disable autocomplete because it's really annoying and that's my highly technical reason for it right so we can say input type text but we can add an aria label because we don't have a label so we can say enter your tweet say bind value to the tweet right so it matches this so we know what the user typed and we can track it. And then the most important part, we have to give it the name of tweets. We can grab the value and then let's give it the placeholder. What your hot take right So let me save this and we get auto formatting which is nice and then let add the submit so we can say class button we going to give it a class of error if characters left is less than zero then we're going to add disabled for a nice user experience i'm going to say characters left less than or equal to zero and then this is optional i want to be explicit type submit so for example if you had any other buttons in your forms you would have to specify type button otherwise it would add like a submit yeah so we can just type submit and then you can just add the text right i should let me just undo this quickly so we can do this yeah just add characters left sometimes prettier works against you right max characters you're going to say the text should be tweet or just return the characters left and that's pretty much it for our component we're going to copy the styles again nothing special some layout and basic styles here's our error that's the color of tomato so let's just save it and we just need to import it right so let's go back to home in our roots home here is our index So right here we're in Home Index and this is the responsive view because we have this narrow window. If I zoomed out we would see the desktop layout right. Let me put it at 100%. And depending how we see the data your user ID might be different so you might post as Bob or as me or as anyone else you added right. But you can go inside Prisma Studio and change it or you can just re-seed it but it's not really that important right. Yeah so let's just add it here below the title. Start typing compose and then you can import it. press enter let me close it here it's at the top so let's see it here it should appear and that's awesome so we can see it has this awesome ability to add the tweet so let see error message and is disabled so here another important thing why do we do client navigation and server navigation so for example client navigation is mostly for the user experience If the user didn have this feedback that they exceeded the tweet limit it would be really frustrating when they go to submit it and then they get an error. But we can get a nice user experience this way. And another thing is that anyone can open developer tools, they can go to this button, and they can literally remove disabled, and they can submit it. And then if we don't account for it on the server, we're screwed right so you have to do proper validation on the server so yes let me close this and refresh this for good measure so if I go here we're going to add the post endpoint to our shadow endpoint so if we go to the routes home index DS remember here we're fetching the tweets we can add the post endpoint here we can say export const post not have the same type request handler make it async then we're going to the structure request and then let's get the form which is going to be await request form data and it's much easier with typescript now say const tweet you can say form get tweet and this part is only for typescript because typescript freaks out it's like oh what is this tweet this really isn't a string what are you talking about it's a form data entry value and And then you can just say here, if you're lazy to string, or I want it to be more specific, I want to say string. So yeah, so TypeScript is going to be happy. So here is the validation I was talking about. So we can add some naive validation here, but you should probably use a validation library like Zod, Joy, or whatever. And Zod is really great because it also gives you TypeScript schema validation. So you can have a nicer API to work with instead of doing it by hand like this. But of course, it's up to you. So we can add something naive, like we can say tweet length is higher than 140. And then we can return a bad status like 400. Then for the body we can say maximum tweet length exceeded And this is going to get called by our error page right So it going to output this and then we just want to redirect back to home and that it So we need to add this to the Prisma database, right? So we need to say await Prisma, tweet, create, and then we can just pass it the data. So we can say posted, new date for the URL. I'm going to use math random. We're going to get a hex value and we're going to cut off the first two numbers. So we get a neat looking cool URL, right? So for the content, we can say it's going to be the tweet. Likes by default is going to be zero. And this is the interesting part. So how do we connect this tweet we're creating to the user? So we can say user connect where the ID is equal one. So of course this is hard-coded, but you can get this from the session. And since we're using a shadow endpoint, we can return nothing so the post is going to redirect to the page itself right and not anyone else yeah so this should work so if we save this and we go straight to twitter and give us our hot take so you can say pineapple belongs on pizza and we can add it and it works awesome so before i leave i think i could have done a better job last time explaining more about shadow endpoints because for example maybe it's really confusing like if we have our feed here how does this update exactly right so for example here we have our value tweets that's going from the shadow endpoint so it goes from the tweets but then i just did the post and then this maybe looks like magic to you so it's post here but we're not really updating here anyway so how does this happen so basically when we post like we've seen here we add the value we post and when the page refreshes the default value is going to do is going to get the content right so our component is going to have tweets updated right and that's how we get the fresh tweets so i hope that's more clear to you and of course if you have any feedback for me i would appreciate it besides the thing i can change like for example my perfect english accent so yeah thank you and see you in the next one