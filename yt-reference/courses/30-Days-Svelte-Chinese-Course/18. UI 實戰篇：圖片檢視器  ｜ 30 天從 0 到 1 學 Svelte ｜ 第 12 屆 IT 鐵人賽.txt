哈囉大家好 我是凱凱歡迎收看凱凱寫程式今天是IT田的賽的第18天那麽呢 UI的專篇也快到結尾了那麽今天我們要挑戰的主題是圖片檢視器那我們先來看一下這個圖片檢視器應該會有的功能圖片檢視器在前端也是很常見的一路來可能你點了一張縮圖 然後按下去之後這個縮圖放大了你可以看到一個比較清楚的圖片然後呢 在這個減視器當中你可能還可以切換上下一張功能等等所以我們今天就要來實作一下這樣的功能好 那我們一樣回到我們的REPL裡面資料我已經先準備好 是純淨態的那麼在這個實戰 就是在實際的場景裡頭你可能会想要比如说你的图片是从API呼叫然后回来的那这时候呢你可能还会想要用await或者是利用store等等的我们之前介绍过的技巧呢来确保这个效能的部分当然还有比如说你可能就是不可能一次呼叫然后就把全部的资料全部载入进来你可能还要做这个无线滚动啊等等之类的那这边呢我們就不會再額外的去實作對好 那我們就開始吧那這是我們的資料就是有一個名字跟這個URL好 那我們首先呢 先把最簡單最基本的功能實作出來首先呢我們先把Data引入進來data.bannerImage然後呢我們先看一下效果是怎樣data.bannerImage好 這樣就有九張圖片了不過現在看起來圖片太大了所以我們先把圖片的寬度限制在100%最高最大寬度這樣看起來比較好一點這樣我們就可以開始做了首先我想要把它做成一個九宮格的形狀看起來比較像圖片檢視器Gallery container我們這邊就用GridGridTemplate Columns這邊讓它做三格然後100px它這邊就是說每個row裡面有三個column每個column都是100px然後我的gridgap我們給10px然後呢 background的部分我想要讓它是centerposition centerbackground-size-coverlow-pix好 這樣子我們把它改成用div的方式這樣我們就可以確保說每張圖片都是縮圖看起來都是正方形的然後不會因為比例的關係而跑掉那當然它的缺點就是你可能只能看到圖片的中間的部分那有可能圖片的中間不是你想要秀出來給使用者看的那這個時候呢可能就需要透過比如說後端的幫忙比如說我們要在圖片上傳的時候就先把圖片切成正方形的當作這個預覽圖來使用不過這邊應該就是存前端嘛所以我們就用這個最簡單的做法來做就好好,所以呢我們這邊欸不對不對,這個應該放在item裡面所以image這樣子然後嗯,就這樣所以我們這邊首先外面先放container進來cluster gallery container然後這裡面再放進來那這邊的話我們就把這個background image動態的塞進去這樣子d.banner image好好 這樣子照理來說應該就會有九張圖了啊 還沒有給class name把class name給進來還是沒有圖 好那我們來看一下發生什麼事了首先我的container的部分它的寬度沒有被撐開來所以我們要給它寬跟高所以這邊我們給width等於height等於100px這樣子就顯示出來了好那接下來呢當我按下去的時候我想要讓它跳出這個實際的這個圖片檢視器對不對那跳出來這個功能我們就可以用我們之前講過的CrossFlat所以我們稍微施作一下CrossFlatTransition然後一樣他會穿兩個function.send跟receiptclose that然後這邊的duration就直接一律都給350好了好然後他這邊會有一個fallback就是說當我找不到的時候我要怎麼做那我們這邊就統一用that用兼入兼出好了好 那在我點下去的時候我想要讓這個image跳出來所以我這邊再放一個這個class等於image viewer好那我們稍微給它一點style首先我想要讓整個position是固定的fixed然後with100%High 100%再来呢 Left 0Button 0Rise 0Top 0好 那Background Color 的部分我给它灰色的好了好 我们让它变透明的好了变比较透明度一点欸 100100.8好 這樣子就有一個 overlay 的效果然後在這裡面呢 我們放這個 image 在裡頭那這邊的 image 的部分我想要讓它是我給它一點Padding好了然後我們一樣把所有的這個Box sizing變成Boulder Box好,這樣比較方便OK好,那在這邊點擊我的圖片之後啊我才想要讓我的Image Viewer放出來所以我們這邊可以這樣寫這邊寫一個click然後我們把它放到上面好了這樣大家看得比較清楚放一個handle preview click那我在這邊想要做的事情是我們先圈高一個selected的變數然後selected欸我們這邊就放image url好了這樣比較方便方便一點selected等於image url這樣子好所以在這邊unclick的部分我們就直接這樣寫handle.preview.click然后这边写DataBannerImage然后我们在Selected有值的时候我们才把ImageViewer给显示然后这边的src我们给Selected好 点点看 有了有了然後呢 當我的這個Fuel的部分被點擊的時候我就把Selected拿掉 重設Selected 空置串這樣子好 這樣就可以把它關起來了好 這樣就是一個非常簡易的實作那麼 首先呢 我們先看一下喔在這邊我想要做一些動畫的效果那我们可以透过刚刚提到的Course Fetch所以在这边我们写一个in等于receive然后key等于d.bannerImage然后out等于

send key dita banner image在下面這邊也一樣我們可以在這邊in然後receive這邊的話我們的key會是selected然後out等於send然後key的話一樣也是selected好,這樣我們再來試試看欸?好像沒有成功喔那這是這個原因是什麼呢?因為你在這邊它並沒有去觸發out的動作你看喔我在按下去的時候它並沒有觸發out也就是這個送過來的動作那這是因為呢你並沒有讓它做out的transition你看喔可是這邊的each的key也就是item並沒有做變動所以我們必須要再加上一個判斷式那這邊的判斷式就是說d.bannerImage是不是等於selected呃 不等於不等於的話我們再去顯示這樣子好 這樣子我們再試一遍你有沒有看到所以你會發現喔他的Transition現在會從他的位置跳出來雖然看起來有點不太明顯好不過你可以發現一個問題就是你如果有看背景的話你會發現欸好像因為我們把這個Image拿掉了嘛所以你會看到他的背景好像有跳動那在這邊我們並不想要這樣子做所以一個方式是我們稍微改變一下CSS然後讓整個這個實作裡面是可以保有這個placeholder的感覺好那我們就這樣子寫看看好了elseplaceholder好 這樣子再試試看好像效果還是沒有那麼好好,那如果這樣子效果不好的話另外一個就是,你可以把這邊再放一個所以呢,每次做transition的時候欸,看起來是怪怪的這樣子每次做transition的時候,我們只讓內部的地方去做transition那外部因為有一個這個我調一下喔有一個這個diff包住所以它外面的那個item還是在還是一樣有9個圖片然後你會發現這邊這個部分它就不會做跳跳的動作好OK那以上就是這個圖片檢視器最簡單的實作好然後再來我們想要做什麼事情呢我們想要再做在這邊呢我們想要做一個小小的滾動器目的是說呢使用者可以透過這個滾動器也是一樣叫Gallery想不到什麼好秘密一樣我們在這邊把全部的Image再跑一遍我們叫Nand好了好然後這邊呢我們想要做的事也是一樣就是我們class等於image然後style一樣我們用background-image來做取代d.banner-image好,那當我們點開的時候這邊就有九張怪怪的圖片然後我們在這邊做一些調整Gallery這邊給它一個inline flexflexflex-rub-domino-rub100%OK 那我们再看一下效果你会发现它现在变成横向的然后如果overflow的话我们就让它是滚动的就给auto同时呢我想要让gallery里面的image的部分啊他們的Flux String就是不要幫我按Flux String是0然後Weave的部分我們給100100pxHigh也是給100px好 這樣子看起來效果怎麼樣好 這樣看起來就好很多了然後我們給一點Module Rans 8px讓它有一點margin那你會發現我現在點都會關掉那原因是因為這邊這個click的部分所以我們一樣給一個小判斷是說欸只有當我真的點了wrap我們才去把這個image-fueler給關掉那實作的方式是這樣子if e.target等於e.current targettarget意思講錯了current target的話呢我們才去把selected變成空置串那這個部分呢我們之前在model的部分也有講過 大家如果不知道的話可以去看一下好那這樣的話只有當我在點這邊的時候才會真的關掉好那接下來這邊呢我想讓它onclick的時候一樣嘛selected會變成會變成什麼?會變成 d.banner-image這樣子不過你會發現啊這個image的步伐太大了所以我想要讓我的image的這個高度喔小一點不要太高所以我們可以在這邊首先我們把max-width拿掉取消 text-width然後呢image-fewer 裡面的imagefewer 裡面的image 我們給他最大的高度會是80%這樣子80%好像還是太高了70%好 70%差不多啦那這邊比較詳細的這個 styling 我就可能沒辦法實作給大家看因為時間上的關係 如果在雕太久的話可能就變成一個CSS教學了好 那現在我就可以做到這樣的功能了就是,當我選item的時候它可以去變換好,這樣子我們就差不多實作了一個這個圖片檢視器的功能那麼接下來呢,當然就是比較進階的功能像是我們可能想要用這個這個keyboard來做導航不知道大家還記不記得昨天我們有試做keyboard做導航對不對所以呢我們就把昨天的這個我們寫的一個小函數我們寫的一個小函數在哪呢?這邊昨天寫的一個小函數呢把它copy過來用很好用吧use keyboard打Jazz那如果我不知道這個這個function來做什麼的話呢可以到昨天的musicplayer的單元收看的單元收看簡單講解就是我可以透過宣告Hook的方式搭配Svelte來做一些操作並且把一些常見的函數拆分到別的檔案當中一樣我們在這邊一樣是可以使用useKeyboard我們等一下再寫首先我先讓它變得可以去focus好 然後use keyboard這邊我們把它import進來keyboarduse keyboardok這邊呢我們要給一個參數是show cuts好那show cuts我還沒有定義所以我們來定義一下show cuts好那我想要做的兩件事情是arrow right 跟 arrow left我們先實作這兩個就好那我想要做的事情是說當我按下 right 的時候就切到下一張圖片然後按下 left 就切到上一張圖片好那實際上要怎麼做呢首先我們可能現在實作一樣是實作的方式也很多種不過根據現在的實作的話我先用這個reactive assignment去宣告一個current index好了那這個current index要怎麼做呢

如果有selected的話我們就去找data find indexbanner image等於selected去看一下current index等於多少不然的話就等於-1好那在這邊我想要做的事情就是current index我們 next index 等於 current index 加 1然後呢 selected 等於 data然後 next index 點 banner image好啦 這邊寫的比較沒有那麼直覺一些不過 它的意思就是說我先去把 current index 加 1然後呢 再把 selected切換到這個下一個Image的URL那一樣left一樣也是那我們這邊就做-1好那我們來試試看喔欸沒有效果這是因為我還沒有focus在這裡所以你可以發現這樣是有用的OK那一樣喔就是我們想要讓這個使用者可以做滾動啦對不對同時呢我們不想要這個预设行为发生所以我们这边就EDOP Prevent Default这边也一样我们再用EDOP Prevent Default好的这样子就做好一个功能啦同时呢你会希望使用者在滚超过的时候啊我们可以把它做这个Transform就是说自动把它做滚断這邊我們一樣是使用scrollIntoView的技巧實作的方法是首先我先在這邊去做byList等於gallery好,然後這邊我們一樣給一個class等於active然後active的判斷標準就是說現在的selected是不是等於d.bannerImage那如果是的話就幫我給active的classNet然後呢效果是我就用比較顯眼的方式把它做focus一樣我們這邊給一個data attribute所以我們在這邊就可以去找到我們在這邊就可以去找到這個被選取的圖片不過上一次我們有講解到就是因為在這個時候其實畫面沒有做更新所以我們要用tick來確保這個svelte已經幫我們更新畫面這樣我們拿到才是最新的ok所以呢在這邊我們一樣去加入async好,double way tick在這邊畫面就已經更新了我們去找gallery active等於gallery.querySelector的這個data selected等於true那如果有active的話我們就active.scrollinto field這樣子好那下面那邊也一樣不過呢這邊我們一樣要加上async好 那我们来试试看有了好 那你会发现因为我没有做这个index的边界处理所以它会冒错误那我们這邊一樣做一個邊界處理好OK 這樣就可以做左右的操作了等一下喔 我左的部分好像寫錯了嗎嗯 沒有啊 我們再看一下當我在這邊的時候是0嘛然後0-1等於-1然後-1再取餘數的話就會是-1所以這邊就會是錯的好,所以我們這邊可能要做一個處理如果current index等於0的話就給它data.length-1好,這樣子然後一樣把focus移過來這裡這樣就可以做這個功能了OK好那做完以上這些功能之後你可能想要做的一件事是說比如說我們可能想要用ESC來跳出然後這邊就不另外再做10座了因為10座很簡單就是在這邊加一個on key down那我們現在來講一下如果關於這個accessibility的部分可以怎麼樣做操作首先第一個我們可以在這邊加上一個群組也就是 rule 等於 group來代表說 欸這個是一個群組喔可以一起來看喔 這樣子同時呢在這邊我們可以再加入按鈕看一下喔這按鈕的部分的話我也不做額外的調整了就是給大家自己去做上一張然後跟下一張那可能在實際的場景你可能會把它用icon來取代那如果你用icon的話記得喔要給它一個labelL i a l a b l e來讓使用者知道說這個按鈕是做什麼用的好那onclick的時候要做什麼onclick的時候其實做的判斷跟這邊一樣ok不過我們實際要做的事情其實更簡單就是我們直接把這邊複製貼上就可以了或者是你再把它額外拆成另外一個function也可以這邊上一張handle click不要了,我們就直接寫在裡面OK,這樣子然後這邊是上一張,所以是-1然後這邊是下一張 所以就用加一好 這樣子就有效果了 OK好 然後呢 在這邊啊當你用這個fadeImageTag來做image的時候你要記得加上這個rule等於image然後再加上ali-label之類的那當然你也可以用labelBy或是describedBy那這邊我們就用ali-label那label的部分我們就直接給它name好了風景照我們這邊的name是風景照那下面這邊也一樣我們一樣給它Rule等於Image然後Aliable等於D.Name好那這邊有點跑板啦 就請大家不要太介意然後呢 還有一個你可能會希望做的事情是當我去切換圖片的時候

可能使用者第一次看到它并不知道怎么使用它所以在这边你可以做一个操作是比如说当使用者去focus进来这里的时候我们先去做一个LIA label去描述说这是什么东西那这个是图片检视器然後呢 可用這個鍵盤左右鍵導覽等等的方式來提示使用者說這個UI應該怎麼做操作好 這樣子OK 這樣子使用者進到這個頁面的時候他就可以聽到對應的聲音了 OKOK好再來呢呃當我的圖片去切換的時候啊你可能會想要通知使用者說欸圖片切換囉那現在切換圖片是什麼那如果你沒有特別做出的話呃screeeenReader是不知道這件事情的所以這個時候我們就可以加入一個我們用p好了那這邊你可以把它調一個LIA-Live等於assertive應該是這樣寫吧Aria-lifeAria-lifeAria-lifeAria-lifeAria-life我们用assertive应该是assertive我确认一下对,of, apply 跟 assertive好这个意思就是说当我這邊的值有改變的時候這個 screenreader 會自動幫我去念出改變的值所以我把這邊改成selected data current index.net這邊因為這個只是給 screenreader 用的所以你可以把這個把它在畫面上藏起來好那我們給一個 class namevisibility hidden 這樣子這樣就可以把它藏起來了欸?他說name of our define我們只當有值的時候再去把它印出來那我們來看一下是不是在畫在裡面有有 你可以看到這邊有一個風景照所以當使用者你看喔 當我改變詞的時候ScreenReader會自動唸出說欸 這個是什麼圖片風景照5等等那你也可以再做細緻一點比如說您現在正在查看這樣子 也可以好 那這部分就是交給大家做發揮好的那么透过虽然这个范例并不难然后实作也不是那么的就是UI上也不是那么的好看不过呢尽可能把这个可以实作的功能都讲解给大家听好的那么以上呢就是今天的这个图片检视器的教学了如果大家喜欢的话呢记得帮我按个赞如果你想要收看关于更多写程式的影片的话呢记得订阅我的频道我是凯凯我們下次再見囉掰掰