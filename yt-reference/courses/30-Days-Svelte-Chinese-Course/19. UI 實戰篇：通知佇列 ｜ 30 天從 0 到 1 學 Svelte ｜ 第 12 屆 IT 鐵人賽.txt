哈囉大家好 我是凱凱歡迎收看凱凱寫程式今天是IT貼文賽的第19天啦我們今天一樣是UI實戰篇今天我們要挑戰的主題是通知註列 Notification通知這件事情在前端也是一個非常常見的應用比如說當user完成貼文了你可能要挑一個通知說喔 恭喜你這個你的貼文已經完成或者是說好友好友邀請通知嘛對不對或者是遊戲邀請通知加入好友通知等等這些都很適合使用這個通知註列來實作所以我們今天就一起呢透過這個spelt來實作這個通知註列那麼大致上功能會有這些第一個當然就是UI嘛然後再來它會有這個title跟description在右上角然後呢會有一個close關閉的按鈕再來我們可以客製化部分的UI好那我們等一下會看到OK那我們就馬上來實作吧首先我們先開一個這個新的元件叫做notification然後呢我們直接在這邊持座好了首先我會有一個class notification container那這個container我想要它固定在右半部就是靠右的部分所以我們可以這樣寫那因為我想要它是顯示在最前面嘛所以我们可以用position fix的方式把它定位住然后index我们给它高一点rights的部分我们给0然后top的部分我们也给0然后button我们也给0high的话我们给100%然後一樣我們給box-sizing方便做定位border-box這樣子好那麼這樣這邊就會在右半部這邊就會有一個這個diff那我們寬度的部分的話我們給它一個150好了讓它的寬度都是在150好 然後我們給一點padding10px上下左右的10px好 這樣子我們就可以來實作我們的notification就是裡面的部分首先呢我們給它一個background-color等於白色然後我們給一個box-shadow讓它有那種浮起來的感覺1px然後3px9px然後RGBA我們給比較亮一點的顏色200然後不透明度我們給0.8好然後裡面的部分的話呢padding我給上下我們給8px那左右的話我們給高一點我們給15px然後font-size的部分我們也可以給它小一點0.75rem好了好這樣子就會有一個雛形出來了那我們先來看一下class等於note-location我想有個地方可以放我們的頭部也就是放標題的部分標題我們這邊Marcher把它重設一下同時我們在這邊把Notification引入進來Notification.files好 然後這樣子OK 這樣 這邊就可以看到一個小小飄在上面的東西這不透明度感覺好像有點高所以我們再給小一點這樣子然後呢 我們給一個Boulder Radius我們給8px讓它給4px 讓它有點圓圓的感覺好 這樣子 OK所以這邊就可以放我們的標題然後這邊可以放我們的body內容恭喜你完成貼文好,我們把寬度再給高一點好了200,200感覺比較感覺可以再長一點啊好 給240好了然後呢 我們想要在這個右半邊的部分放上一個關閉的按鈕所以我們可以這樣寫 button type button然後一樣我們用html codehtml code close這樣子這一個等一下怎麼臨時要找找不到這邊這邊這邊有一個100006好複製下來然後呢我們稍微整理一下button的style folder我們有必要了感覺這樣子還蠻顯眼的欸還是我們把背光也拿掉還是我們背光留著拿掉好了transparentok然後我們定位稍微修改一下dexplay我們給flux然後justify content我們給space between然後呢align items我們給center讓他做一下定位OK好 這樣子就有一個基本的雛形了然後再來我們這邊想要再放上一個footer那footer的部分要放什麼呢footer的部分我們想要放一個確認的按鈕這邊的話我不想要改動它的那個style所以我們這邊給一個close這樣子好確認然后footer的部分我想要让它有一点点距离让它可以跟上面的内容拉开一点这样子然后关闭好了這樣子我們就完成一個最基本的這個通知的樣式了那當然接下來就是實作跟這個原件做整合對不對所以呢這邊我們一樣會用到store來實作通過store的方式讓我們的通知註列可以被所有的原件一起共享然后原件之间也可以互相沟通那我们在这边会需要什么东西呢第一个我会希望我的notification会是一个阵列原因是因为可能同时之间你可能会不只有一个通知而已你可能会突然冒出很多个通知然后里面要有什么呢第一個我想要有ID來方便去不管是spells也好或者是找尋通知也好有一個ID可以讓我們比較容易的去找到對應的通知註列再來是title就是這邊標題的部分還有description就是內文的部分然後我想要它有一個timeout他要就是指說過了幾秒鐘之後我想要把這個貼文拿掉那我們假設當然這邊你也可以預設讓他是一直保留著或者是你也可以讓他說5秒後我自動讓這個通知消失那我們這邊一律都設成5秒好了然後呢我在這邊會想要做一個 actions跟 close當我按下XX的時候,可能我還想要做另外的事情比如說取消API的呼叫等等之類的這邊就是提供一個方法,方便做使用在Action這邊,我想要提供一個樣式是說這樣子,我可以裡面放Unclick跟Text來去操控就是這邊按鈕的部分就是我可以自己去客製化我要的按鈕然後點擊之後要做什麼事情好那大概就像這樣子OK所以呢首先我們先把Writeable給引入進來再來spell

然後我們宣告一個notification等於 writable好那在這邊呢我們notification那在這邊呢我們定義兩個方法第一個是add那add的話要add什麼呢我們直接讓它是一個notification的物件那notification的物件會長這樣子下面這些東西好我們先把ID給抽出來notification.id然後呢我們直接去呼叫這個notifications.update那這邊會是它目前的值然後呢回傳的值是你想要更新的值所以我們直接打concat然後notification好这样子之后呢它就会帮你去做更新的动作同时我们也做一个setTimeout来告诉svelte说过了几秒钟我要把它删除所以我们这边用notification.timeout然后如果没有给的话就给五秒钟那这边要做的事情是什么呢我们要做的事情是一样我们去呼叫notifications.updatenotifications.update然后里面一样是这个目前的通知然后呢我们去做filterfilter什么呢n.id不等于上面这边的id好这样子那这边呢這邊設定的目的就是說過了5秒鐘會自動讓這個通知消失好那再來呢我們這邊再設定一個新的方法叫做Dismiss那Dismiss就是你可以給你一個ID然後它就會去刪除對應ID的Notification比如說我按了這個XX好了那我就關掉這個這樣子好所以如果有ID的話我們就去找其實就是這邊的始祖那如果沒有ID的話怎麼辦呢如果沒有ID的話呢我們可以比如說我們就把最後一個給拿出來這樣子所以你可以這樣子Nonstop pop然後再回傳notification 這樣子好這樣子我們整個Store就完成了當然如果你有更複雜的使用情境的話可能你會寫得更複雜一點不過我們這邊就是把這個UI的實作變簡單一些好,那再來就是整合到這個我們的Notification當中首先呢我們在這邊改成用這個我們先把Notification的Story錄進來Notification這樣子好然後呢欸 等一下這邊怎麼多了一個因為下面這邊還沒有始作好好 那麼在這邊呢 我們去做跑一個迴圈each notifications那因為notifications是一個store所以要加前號去訂閱它us notifications然後我們這邊呢 可以用ID好,那我們一樣把這邊複製進去複製進去之後呢,我們把這邊改改的地方改一改notification.title然後,啊,這邊我們先把accessibility加進來好了現在要養成習慣喔hidden等於true然後這邊呢我們給一個Arialabel等於關閉通知然後呢可能你會想要給他titlenotification.title這樣子好然後這邊呢我們一樣給一個notification.description這樣子那這邊的話呢剛剛有定一個actionnotification.actionseachaction.text這裡面我們的button就用預設的button就好然後這邊的text我們就直接給text然後click的話就給action.clickok然後他這邊一直說notification is not defined我是不是有地方拼錯了notificationOK還有地方打錯嗎第40行好那這樣子我們就完成了這個通知的整合的部分接下來呢我們在這邊引入這個app看看notification.那我們來試試看喔我們在這邊引入一個buttonnotification然後onclick的時候我們去呼叫add那我們這邊就辛苦一點了自己打title我們叫恭喜Discretion就是鐵人賽文章完成通知然後unclose的話我們這邊就給dismiss然後還有什麼還有應該這樣就可以了啊 還要給一個IDID的部分的話你可以用這個隨機產生那我們這邊就直接把它寫死notification completedok 那我們來點點看欸 發現有錯誤那我們來看一下有什麼錯誤說 notification is not defined在哪裡呢好 那我们来看一下喔好 然后接下来它说Each only iterates好 所以我們再回到這裡他說Notifications只接受Array-like objects所以是notification.actions因為這邊有可能是undefined所以我們給一個if這樣子嗎對 這樣子就有了那我們再按然後他說會有duplicate那這是當然嘛 因為我們現在ID都是給歇斯的所以我們先隨便加一個假設Math.random然後加toString這樣子好 這樣就有了然後它這邊沒有間距嘛 對不對所以我們給一個間距讓它看起來比較順一點把tool給8px這樣子看起來比較好然後呢當然我們要再加上一點transition對不對所以透過spells就是蠻簡單的我們用fly讓他看起來有那種飛路的比較看起來有那種通知的效果spells然後transition然後在這邊我們加入transition然後flyX我們給100好這樣子這樣看起來更有感覺了對不對好然後呢你不喜歡它這樣跳跳跳的感覺了對不對所以呢我們再加入這個flip然後fromspells animate這邊一樣Animate Flip好 再試一次看看好像有點太快了Duration 我們給250好了

好那这样感觉就差不多了OK好然后呢再来我们想要有一个这个还要有什么功能呢按XX的時候它會自己我們想要它按XX的時候它會自己跳掉這樣子所以我們看一下close這邊先看一下喔close這邊還沒有給事件監聽器所以它沒有辦法好 這樣子試試看欸?他說unclosenotification.unclose嗯,好,那這邊有一個小bug就是說欸?unclose的部分啊他跟我刪除的預期不太一樣那這是因為呢我並沒有給他ID所以呢他會從最後一個開始刪不過從最後一個開始也怪怪的嘛對不對 所以呃我們這邊可能要改一下pop 所以應該要用 onShift要用shift要用shift來把第一個部分移掉不過呢 如果移到這邊還是不對因為如果你按了假設第二個的話它還是會刪第一個所以呢 我們要清楚的給定ID在裡頭再看一下喔 這邊我們要清楚的寫ID在裡頭.uncloseclose notification.id然後再回到app這邊我們要用它會傳入ID所以我們要dismiss id這樣子ok好 再試一次看看好感覺起來好像還是有點bug我看一下喔 因為因為這邊它兩個都會做把它放進來OK 這樣我們的功能就全部完成了當然最後一個還要考量的一點就是說當使用者看到這個通知的時候你可能也會想要在Accessibility的部分做對應的操作那在這邊的話你可以這樣寫比如說這邊你下一個P然後呢我們給Li等於Polite那Platts意思是說因為這是一個通知而已它不是一個非常緊急的訊息所以呢我們去告訴Screenreader說當你把現在的內容讀完之後再來讀這邊的通知叫做Platts比較有禮貌一點那如果你今天用了比較高一點的Assertive那麼Screenreader就會打斷現在正在閱讀的內容然後去閱讀這個通知所以我們直接用apply就好然後呢假設有變化的時候我們就比如說我們就只讀這個notifications打第一個內容打description那一樣就是当 if其实也不用 if 啊这样就可以了好然后他说现在是 undefined所以我们还是加 if 判断式好了会比较方便iflocation這樣子好這樣子一來呢比如說我的我把文字這邊改一下加上他怎麼寫比較好我們一樣就先隨便給一個數字好了你就會發現他的文字也會跟著做改變當然你有可能是想要說讓這個notification的部分每一次都是念最後一個讓使用者可以隨時接收到最新的訊息這樣子也OK這樣寫起來看起來比較沒那麼直覺這邊一樣就會顯示最後一個通知這邊就是看大家要怎麼施作好,那這樣子我們今天就完成這個通知的UI以及Accessibility的部分了好,希望大家都可以把這些技巧應用在這個UI開發當中好的,那麼今天的教學就到這邊結束啦我是凱凱,我們下次再見囉,掰掰