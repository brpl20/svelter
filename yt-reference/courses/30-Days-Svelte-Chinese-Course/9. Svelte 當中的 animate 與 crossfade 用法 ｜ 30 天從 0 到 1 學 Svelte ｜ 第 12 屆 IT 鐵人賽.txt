Hello 大家好,我是凱凱欢迎收看凯凯写程式今天是IT铁人赛的第九天了昨天我们讲到Spell当中的Transition机制今天我们要来讲Spell里头还有更进阶的Transition使用方式也就是Crossfade跟Anime这两个应用那么这些东西它在实际的场景虽然很多啦但比较少用到不过呢它能够带来的体验我自己觉得还蛮不错的然后我觉得也是一个Spherz里头一个蛮大的特色所以今天呢就会一并介绍给大家好那么把这两个东西学完之后呢我们几乎已经学了Spherz大部分的功能然后接下来还有一些像是关于Surfer Side Rendering还有Spelt一些比较进阶的应用等等我们大概会在两天之后就是再过两天会把这全部的东西都讲完然后我们就要开始做实战练习了好首先我们先来讲Crossfade那么Crossfade是Spelt里头另外一个做transition的方式然后你在呼叫crossfade的时候你可以定义第一个duration第二个是fallback那crossfade它会做的事情是把一个物件从A点送到B点然后呢svelte做了一些整合让你可以很轻松的做到这件事情我们等一下就会来看一下它的语法到底长得上什么样子当你呼叫这个方法之后呢他会回传两个transition的函数一个是send一个是receive好关于他的用法呢我们等一下会谈到好那他会做的事情呢他会做的事情是他会去侦测说现在到底是谁把这个物件给送出去也就是send然后他会去找说目前是谁正在准备接收这个物件然后他侦测到之后他感测到之后呢就会帮你做动画那receive的话就是反过来就是它會去等待說是誰去發送了這個信號然後如果偵測到的話就一樣做這個動畫把它接收過來也就是send跟receive那如果spell裡頭找不到的話怎麼辦呢它就會幫你做fallback裡面你定義的transition好我們現在就來實際看一下Crossfade的效果是什麼為了讓這個效果變得更明顯一點所以我們會花比較多一點時間來做首先我們先定義我們先定義比如說我現在有一個列表好了一個列表是全部然後另外一個列表是selected就是全部的列表跟被選到的列表好那我們列表要叫什麼內容好呢好假設我們就放很多tag很多標籤像是JavaScript然後reactfuelangular然後spells等等好了然後我們把它印出來這個是跑迴圈的用法不知道大家還記不記得那我們這邊用button好了type也是一樣給button然後這邊呢take好這樣就有很多小button跑出來了再來呢我們給他一點一點距離好了所以我們這邊Display 給他 Inline Block然後Margin Rights我們給他 8px 好了好 9px 也可以然後這邊我們給他 Class Name好這樣子這樣子應該比較好看了吧好然後呢這個是然後我們這邊再做另外一個列表就是selected好那我這邊再定義另外一個array叫selected假設它現在是一個空正列然後呢 我想要宣告一個函數是說當我每次按下button按下按鈕的時候呢我就會去看說 欸如果已經被選中的話呢 就把它放回來如果沒有被選中的話呢 就把這個標籤呢 放進去好所以我們可以這樣寫假設我們這邊都傳 text 好了然後 select it 就會等於啊 不行如果只有 text 的話就會比較麻煩一些所以我們這邊比較辛苦一點我們把每一個這個裡頭的元素呢都加上 id 好了這邊就比較辛苦一點好 text 假設叫做 java script這邊把它做整理像這樣子然後re-add也一樣然後few然後angular textandular最後一個是svelteid4svelte好這樣子這樣子一來呢我這邊都會變成object所以現在它的顯示是錯的那就是因為呢tag現在是object所以我們要把它變成顯示tags好這樣一來我在選的時候就会比较好选一点比如说如果 selected这个array已经有ID的话已经有我们的ID存在的话代表说你现在是在selected按了一下之后你想要把它从selected array拿掉那我们要怎么做呢可以在这里写selected.filter然後這邊就叫S好了這邊我們就這樣寫我們直接放ID進去好了所以就是從這邊的ID不等於tag.id那如果沒有在selectedArray裡面呢如果沒有的話我們就把它放進去就好ID tag.id好那接下來我們這邊的實作就是onclick的時候呢把我的handleclick tag放進來你會發現怎麼沒有用呢?這時候我們就要來debug了我們現在的寫法是不管怎么样我们就是会把全部的tags给印出来对不对那我们想要做的事情是第一个按下去之后我想要把这一个全部的列表按下去的这个会想要放到selected当中然后如果我在selected按的话呢它会回到all列表当中所以呢我们这边也要重新改写第一个each这边呢我们要选取被选中啊对不对所以可以用filter然後tagtag.id存在selected這個array當中然後一樣是tag然後這邊我們一樣寫同樣的東西叫什麼呢?tag.tags好現在是沒有什麼都還沒有選嘛所以我們再按按看現在跳錯誤了他說什麼include is not function所以我少打一個s還真的按下去你可以發現他跑過來了我這邊給他class name叫做tag這樣就比較好看一點但是呢我不想要這樣子我不想要這邊還繼續保留著然後做一些改寫其實這邊的改寫跟這邊就是完全照抄所以就會長這樣但是呢我這邊就改成False

好 这样就可以做到这样的效果好 那这边呢这边我还没有帮他做事件监听器嘛所以我们这边一样做就直接做同样的事情我们宣告一个onclick的事件监听器之后呢呼叫handleclick tag好这样就可以做到我们初步的效果了现在我想要做的事情就是呢我想要让它在从all这个列表送过去selected的列表的时候可以做到一个动画那这个时候呢你就可以用crossfade这个效果来做到那它也一样在spells的transition当中好然后你可以收到两个函数crossfadeCrossfade里头呢第一个参数是Duration那Duration当中你可以它会给你一个参数是DDistance的意思那我们这边呢就简单的把它做Squared然后假设250秒好了这个意思是说当我的距离越远那我的动画时间就会越长然后距离越短动画时间就会变得越来越短那这是这是避免说当我的距离很远的时候我可能会想要让动画变得慢一点让它看起来比较自然而不是每一次都是固定的时间可是如果在距离太远的话呢比如说我从A到B是这么远好了然后我每次做的时候可能都做100毫秒你这样做的时候100毫秒是蛮自然的对不对但是如果你现在在这边然后你想要做100毫秒的话可能就变超快那你可能会想要它不要那么快感觉可能就是都一样的速度好那这边想要做到的效果大概就是像这样子然后呢再来它可以定义一个函数叫做fallbackfallback的意思是说如果spell当中找不到说你今天如果去send去发送一个信号但是spell找不到对应的接收者的时候呢它就会帮你做fallback里面要做的transition那它的簽名函數會跟Svelte transition當中相同所以呢我們這邊就很簡單的來做我們就用fed就好所以就這樣偷懶好那之後我們就來試試看sendin進來的時候是receive我們去接收看有沒有人有同樣的在receive當中你要去定義一個key這個key是什麼呢?這個key是什麼都可以但是你要想辦法讓svelte知道要怎麼傳給你那我們這邊就叫tag.id然後out的時候也一樣我們要把我們的信號送出去一樣這邊tag這邊的key我們也一樣給tag.id好那这边也是我这边就直接复制贴上这边也是做一样的动作好那我们来看一下效果你会发现这个怎么长得这么奇怪好这是因为呢在svelte当中你这边定义的key它不知道要怎么传也就是说然後雖然你在這邊定義了key但是呢spills還是不知道是誰那麼在這邊呢就會提到另外一個功能就是spills的key的each的功能那這是什麼意思呢你在這個語法的最後面你可以用個括號標示起來然後呢把你想要的key輸入進來比如說你可以長這樣子那它的感覺就有點像是說array當中的key的功能就像這樣子tag.id然後tag好那有了這個定義之後呢svelte就會幫你把每一個array當中的item分別加上key這樣子spells就可以找得到對應的元素做更新好那在下面這邊我們也要做同樣的事情好,那我們再點一次試試看你可以看到有沒有看到現在的效果他是這樣子飛過去飛過去,而不是我點了他就直接直接冒到上面去而是他會在這兩個元素之間呢做一個transition的動作有沒有看到这样看起来就是会比原本我们要做的那效果好很多嘛对不对然后呢透过spelt内建的crossfade这个语法你可以很容易的达到这个效果看一下这个程式嘛51行好所以呢这就是这个spelt当中crossfade可以达到的效果那特别要注意的地方在于第一个你要在这个each的语法当中呢要记得帮你的这个所有的item加上key那加入key的方法呢就是像这样挂号包起来然后宣告你要的key的值是什么那这边也一样然后呢我们透过crossfade方法回传的send还有receive这两个transition的函数之后呢把它放进来in跟out然后透过这个key我们来传送我们要的key给对应的item好那么这就是Crossfade的原理了那么对可能现在看起来好像这个应用的case还不太多嘛对不对所以我们在之后呢也会慢慢介绍就在UI10战片的时候会慢慢介绍这个Crossfade的更多功能请大家敬请期待好接下来呢我们要来讲下一个功能下一个功能叫做Animate那Animate也是Spill当中一个内建的功能那它做的事情是什么就是当列表所谓的列表就是我们用Each语法呼叫的东西它会在这个列表当中有重新整理的动作发生的时候呢执行这些Animation那它执行的传入的参数有哪些呢第一个是Node也就是你要做Animate的元素然后再来第二个比较特别它会帮你去计算说它会从哪里然后变化到哪里也就是它这个函数呢它会帮你决定好起始点跟终点这两个位置那这时候你就可以对这两个位置做你要的计算好,然后下面呢是它想要你回传的东西其实就跟我们昨天看到的transition里面的function是非常像的几乎是一模一样Delay, Duration, Easing, CSS, Tick在Spill当中有一个预设的功能叫做FlipFlip这个概念虽然不是Spill原创的不过这个Flip的概念其实还蛮好用的它是一个四个单字的缩写First, Last, Invert, Play那这是一个做动画蛮有效的方式首先第一个呢你先计算你的起点第二个呢再计算你的终点也就是first跟last然后呢你在这边做infer也是做叉子的动作然后呢再做动画好在svelte当中呢它也有提供這個Flip功能所以我們等一下就會來看看好 那麼現在我們就要來幫這個Spilt幫我們現在做的這個功能再加入一個功能就是剛剛我們提到的Flip的功能好 首先呢要實作這個功能的話你可以從這邊spell animate裡面呢引入這個flip的參數然後你要做的事情很簡單就是直接給這個directive然後flipanimateflip這樣他就會幫你有沒有看到剛剛我們沒有做的時候他是怎麼剛剛我們沒有加的時候它是怎麼跳的你會發現它是當我的這個 transition 跑完之後呢它這邊就直接他們就直接跳到這邊然後我會把這個 transition 跳到這邊

位置就全部reset那加入之後呢他這邊也會幫你跑動畫有沒有看到那這就是flip跟animate提供的效果那你這邊也可以加入參數比如說我覺得剛剛跑太慢了想要跑快一點250然後easing覺得怪怪的假設我給一個cubic outcubic out那我這邊引入 qbit outs等一下 他說 qbit outs is not defined這邊要給 e-thin這樣看起來快多了這邊也一樣這邊也給他 direction 250e-thin用物件把它包起來好這樣子看起來是不是比較好一點的呢好那麼像這種就是物件跟物件之間可能會有這種跑來跑去的應用的時候呢你就可以用Crossfade跟Animate這個效果來做到你想要做的事情那麼Speltz本身呢他提供的这些语法让你可以比较方便的达到那可能在ReelAid当中你可能第一个你可能要用ReelAid SprintReelAid Sprint或者是ReelAid FlipEasy Flip吧对Easy Flip等等的这个函式库这边或者是这个ReelAid Flip Toolkit等等的这个Library才能做到类似的效果好的今天的内容就到这边结束了我是凯凯我们下次再见咯拜拜