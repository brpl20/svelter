哈囉大家好,我是凱開歡迎收看凱開寫程式今天是IT鐵人賽的第八天耶~~好今天我們要來繼續講跟動畫有關的東西這個東西就是Svelte裡頭的Transition機制好,那我們今天的目標就是學習Svelte裡頭各種Transition的用法那麼Transition是什麼呢在UI当中我们时常会需要做一些转场的动作比如说当你的手机可能你点了某一个页面那你到下一个页面的时候你可能会有一个滑动的动作或者是你在开启model的时候可能会有一个放大或者是滑过来然后再滑出去的动作等等或者是呢键入键出放大缩小平移等等这些呢都是在UI当中很常见的transition那么这些Transition这些过场效果用得好的话可以创造出一些蛮舒适的使用者体验比起直接很生硬的这样直接跳转页面那么在Svelte当中有内建的Transition机制也就是说你可以用相对比较简单的语法来做到Transition所以我们今天就会来介绍各种Transition的机制好 那么在进入实作之前先跟大家介绍一下Svelte Transition的特色有哪些第一个 Svelte里面的Transition是完全使用CSS动画实作的那它实作的原理是首先你给定了一个这个function你给定了一个函数去定义说你的过渡动画要怎么实作之后呢Svelte会先帮你跑一遍跑完之后它会产生出一个动态的CSS的动画的语法然后呢再把这个语法全部呢放到你的洞里面之后呢再开始播放也就是说它不会去操作任何洞上面的物件或者是用JavaScript来操作那这样有什么好处呢第一个就是你的JavaScript就不需要再多花心力去管理或者是去担心说这样子的CSS的操作会不会造成效能上的问题第二個就是使用CSS動畫實作瀏覽器會盡可能的幫你做優化所以我們就不用去太過擔心除非你的CSS動畫寫得很爛或者是計算太複雜等等不然我們是不太需要去擔心效能上的問題再來就是Spelt Transition透过简单的语法操作什么是简单的语法我们等一下会看到第三个我觉得也是一个蛮贴心的设计就是它可以搭配if语法来做transition也就是说我们在之前有教过这个template语法那template语法当中可以搭配if那么spelt在if这个condition是true的时候如果下面就是里面的东西有做transition的话呢Spelt也会一并帮你做入场出场的机制而不是直接突然消失或突然出现那么如果你本身有写过readd之类的话呢你会发现说如果要做到这样的事情的话在readd我们通常会使用一个叫做readd transition group的函数库来实作来达到类似的效果因為Reel當中如果你用if true然後random的componentrandom的元件的話它就是直接冒出來它不會再幫你做transition的動作那一樣如果是false的話這個元件就是直接不見好所以我們等一下也會來介紹這件事情再來呢spelt有內建一些transition最常見的嘛漸入漸出然後blur就是模糊flyFly就是有點像飛飛入飛出的感覺然後Slide平滑移動Scale放大跟DrawDraw這個比較特別我們今天可能沒辦法介紹Draw呢通常會跟SVG搭配做使用好那Draw的部分的話我們今天不會特別談到對之後有機會的話可能再跟大家一起談了好那這個是Spell 當中 Transition 的基本用法首先呢你可以用這個Transition 冒號有沒有看到Transition 冒號然後後面加上你要的 transition 的名稱然後呢 之後我們會講到你要怎麼給定參數再來呢 除了 transitiontransition 的意思就是說它會在進場跟出場的時候幫你做這樣的動畫做什麼樣的動畫呢做建入建出的動畫那什麼時候是進場也就是說什麼時候Svelte會在什麼時機點幫你做進場就是在原件被Mount的時候被掛載的時候然後呢什麼時候會出場也就是原件被銷毀的時候會幫你做出場好那我們等一下回來試試看再來呢除了Transition之外你也可以分別對進場出場做不同的Transition比如說在進場的時候我想要做我想要做進入然後在出場的時候我想要讓它飛動飛出去的感覺好沒關係現在感覺都很模糊了對不對我們馬上就來試試看然後最後一個就是參數呢Spelt的transition有提供兩個參數一個是delay第二個是duration第三個是easy好,那我們就來看一下吧首先呢,我們先隨便寫一個那我們這邊就先簡單做就好這個先拿掉假設imTransition然後我這邊先設定一個變數假設先等於force然後我用一個以弗的判斷式把它包起來這樣它就不會顯示了然後我在這邊加入transition也就是我們剛剛介紹的語法同時我們引入一個fade漸入的效果然後我把condition改成true會發生什麼事呢?你會發現,怎麼 transition 的效果沒有出來當 spell 當中,如果你是第一次掛載的時候比如說像是 server-side rendering 的時時候你可能不需要或者是不想要第一次的時候有這個Transition的效果因為可能你不想要讓User turn所以呢預設來說Felds不會去做動畫那比如說你還是想要做的話你要怎麼做你可以用SetTimeout的方式也就是說我剛開始就設成False然後呢可能我過了0.2秒然后再做mouse的动作这样子一来spells就会帮你做有没有看到建成再看一次有没有看到有了就会帮你做动画好那什么时候会消失呢也就是让当这个原件被销毁的时候我们会做出场的机制什麼時候會被銷毀呢?也就是讓condition為false那我假設過了兩秒鐘之後我把它變成false好了看一下它會不會跑走跑走哎呦有沒有看到所以這個呢就是transition的效果那麼如果你想要分別對進場跟出場做不同的效果的話你可以這樣做你就改成in然後outfly好了好,等我一下Fly里面我们可以设定x0,y0好,那這個是第二個參數你可以設定的東西那麼針對每一個TransitionFields 都有一些不同的就是對應的參數你可以去參考那麼相關的文件都寫在這邊API 當中的這個Transition找一下這裡好,那Fields它有Delay 跟Duration然後Blur有這些東西然後Fly的話有這些東西等等所以如果有需要

大家可以去參考回到我們的範例當中所以我這樣的定義就是說出場的時候請幫我的Y移到100然後它好像Fly的效果還會同時幫你做建出的動作其實還蠻不錯的嗯 等等 好OK这样我们就介绍完这边的transition的机制了那么在这边呢你也可以引入easing的function那我们等一下会介绍到好我们接下来就来看一下easing functioneasing function是什么呢easing function是缓冻函数也就是它可以让你的物件透过特定的函数定义来让你的移动变成更加真实而且活泼比如说在真实世界当中很少几乎或者是说根本没有一样东西是它可以直线然后呢从头到尾维持同样的速度通常我们的物件的移动方式都是比如说先从零然后呢慢慢的加速到某个速度之后呢然后你快要到目的地了就是慢慢的停止然后再变成0而不是让直线突然就加速到某个速度然后再突然变成0所以这个时候有缓动函数的帮助就变得非常重要它让我们可以更有效的去模拟真实世界的移动方式也让我们的动画看起来比较活泼一点不会那么的生硬好那么我们来看一下那我自己最常用的是cubic那如果不清楚這個函數的樣子的話你可以到這邊ease visualizer然後來看一下你看它就慢慢變快或者是export然後再看你看它就慢慢變快然後再看你看它就慢慢變快然後再看你看它就慢慢變快然後再看或者是Expo也是一樣慢慢的但是它到中間這邊的速度就變化更多好那我們就用cubic好了我們試試看cubic我這邊呢一樣引入這個easing然後叫什麼 cubic outcubic然後我Fly的時候呢我這邊就給一個Cubic Out好 可能這樣感覺不出來還是它的預設就是Cubic Out好 沒關係 我們設一個比較比較看得出來一點 Elastic所以設定Elastic的時候 它應該就會比較ㄉㄨㄞㄉㄨㄞㄨㄞ的感覺吧然後這邊要import進來有比較彈跳的感覺了沒關係如果太快的話我們把Durable显示長一點讓大家看一下效果有那種跳跳跳的感覺了好那這大概就是Spill當中的transition的使用方式了除了定義spilt裡面預設的transition之外你其實也可以自己去定義你要的transition是什麼好,那麼我們先把這邊全部都拿掉全部都拿掉然後我們自己定義一個假設要rotate好了我想要讓我的進場是這個旋轉進來的裡面的參數是什麼呢?我們還不知道所以我們先binding argument in strict mode它該不會不能讓我用這樣的方式吧好沒關係那我們就它也不讓我用可以啦condition.false我們先觀察一下說我如果直接這樣塞進去會發生什麼事情chan然後呢我的名字叫Rotate好了看一下欸沒有東西耶怎麼會這樣因為現在的condition是false先改成true好了他說elastic out is not defined沒關係我們重新整理一次看一下好好然後我們看一下console裡面有沒有印出什麼東西來沒有所以從這邊你可以發現說spelt如果你剛開始if的statement是true的話它這個原件會直接掛載就算你有transition它也不會做任何事情沒關係我們就用比較不同的方式我們剛開始先設成false然後呢condition等於 true然後假設過十秒好那我們可以看到參數它這邊會傳入第一個參數是 node所以我們知道第一個參數是 node然後第二個參數是什麼呢是一個空物件所以呢這個空物件是怎麼傳過來的你可以這樣傳比如說我傳了一個叫做假设我穿一个叫做Range好了假设我要定义了我要滚我的滚动的我的旋转的范围要多大那假设我就定义一个π那这个π是什么意思呢就是π在数学里面如果用角度表达的话就是这个180度嘛对不对所以这边的意思就是说我只想要我的我的旋转的范围呢是180度好那我们来看一下是不是可以順利的把它拿出來premines所以你可以發現的確我可以拿到這個數字好的那拿到這個數字的時候嗯這個transitionspelt希望你怎麼實作它呢那我們就直接來看一下文件吧欸我們來看一下它這邊好像沒有寫欸?好沒關係他沒有寫的話怎麼可能會沒有寫呢?transitiontransition 不然看這邊好了有了有了有了他說他第一個傳的是一個 note也就是你綁定 transition 的這個 note然後第二個參數是什麼是 premiers也就是我們剛剛講的你在這邊的參數就是他這邊的第二個參數好再來呢svelte 希望你回傳什麼delayDuration, Easing, CSS, Tick那這邊全部都是可選的值那我們就來試試看吧假設Duration我們就不管怎麼樣都是一秒然後來看一下spells希望它會傳什麼第一個delay,delay的話就先不要做好了Easing,我們就用我們最喜歡的cubiccubiccubicoutfrom spelt然後Easing用這個我們最喜歡當然如果你想要讓你的這個transition變得更彈性的話你也可以讓你的這個Easing的函數從參數當中傳過來比如說可能像這樣子也可以 當然沒問題那當然就是看你的設計想要怎麼做好 再來呢Spelt希望他回傳這個CSS的屬性那這邊的T呢就是說目前的動畫執行到多少這邊的動畫都會用0到1來表示也就是說 0就是還沒有開始嘛然後到1代表這個動畫播放完畢的意思播放到最後面 也是100%的意思然後你在這邊可以定義說你每一個階段你想要回傳怎麼樣的值那我們想要做的事情是什麼當我滾到當動畫結束的時候我想要滾到180度也就是這邊我們定義的Range所以呢這邊要怎麼做比較好呢我們用TransformTransformTransformRotateRotateRange

prem.range乘以乘以多少乘以tform.rotate乘以t然後後面呢要再加上欸等一下這樣子完全打錯了要包在裡面才對然後後面還要再加上deeg喔大家有沒有看到它在動了它剛剛有動了對不對好,沒關係如果沒有看到的話再看一次有沒有轉了可是呢你會發現它轉的角度好像跟我們想的不太一樣這是因為呢我在這邊寫的是第一句嘛可是我在這邊定義的是拍那拍是進度所以我們這邊也就讓整個單位都一樣可以寫180所以你可以看到它這邊就這樣轉180這樣子就完成了我們客製化的這個客製化的Transition了那麼今天的內容就到這邊告一段落啦如果你喜歡這部影片的話呢别忘了给我一个赞如果你想要看更多有关于写程式的影片的话记得订阅我的频道我是凯凯我们下次再见拜拜