 Hello everyone. My name is Brittany Postma and I'm from the online tutorial site codingcat.dev. I'm also the co-host of the podcast perfect.dev. Today we're here to talk about persisting Svelte stores with local storage. That's a lot of words so let's break down a little bit what that means. Svelte stores are a way to manage the state of our application globally so that we don't have to pass our props around to different components that need access to it. We can put our state in one place and use it wherever we need it. Persisting that with local storage just means that we are going to use the window object local storage and save our data so that if we close our tab or close the window we're gonna be able to get that state back. So let's get into some code. Alright so we We have here an original Svelte app that I've created by running this npxdget sveltejs slash template command and I've just named mine Svelte Stores. I did start trying to run this with SvelteKit but I was running into issues with the way that local storage is rendered by SvelteKit so there's still some kinks to work out there but all of the syntax that we're using here today should be able to transfer over to SvelteKit once all the bugs are worked out of it. So that's just something to be aware of. So I have cd-ed into my project and ran npm install already. The next thing to do is to run npm run dev to get our dev server up and running. I'm going to control click on that to open that in Chrome. And we have here just our app.svelte file that comes with Svelte by default. So to get our stores working, I'm going to create a stores folder. And inside of that, I'm going to create a couple of files. I'm going to create a store.js and a persiststore.js. I know naming is one of the hardest things that we do as a dev, so name yours however you feel is best. Inside of Persist Store, we need to import a writable store from Svelte. In Svelte, there's three different kinds of stores. There's a readable, a writable, and a derived. The readable store just allows you to read the data. You can't update it from outside of it. The writable store that we're going to be using today has a subscribe, a set, and an update method that comes along with it. it so you can add to it you can change it you can do things with it that you can't do with the readable they derive store just depends on another stores value so those are the three different types but today we just going to be working with the writable So we need the writable from and it spelt spelt store spelt slash store And then the next thing that we need to do is to export a function that we're going to be able to import into any other file that we need it in. So we're going to do an export const persist store. You could do a function here as well. I just chose to do an arrow function. We need to give it two parameters. We need to give it the key that we're going to set the local storage value to and the initial value of our data. And got to do the arrows there. And inside of this function, we need to do a couple of things. We need to check to see if we can get the item from local storage, check to see if that exists, and if it doesn't, set it to that initial value, and then we need to create our store. So let's get started with that. First, we're going to create our persist variable, and that persist variable is just going to be the local storage, and we're going to see if we can get that item, try to get that key out of local storage. The next thing that we need to do is to get our data, and we're going to check to see if persist exists. So we're going to see if that key exists, and if it does, we're going to parse it. Everything inside of local storage is a string, so we need to parse it to be able to get our data back in the correct format. So we're going to parse persist here if it exists, and if it does not exist we're just going to give it this pass in some initial data, initial value there. And now we need to create our store. So we're going to say const store and we're going to use this writable that we get from Svelte. And inside of that we need to pass that data. So this is either going to receive the local storage item or our initial value and then it gets a callback function. And this callback function will allow us to unsubscribe if something happens and breaks it. So we're going to create an unsubscribe variable here and what we're going to do with that is actually just use the subscribe method that is provided by Svelte, pass in the value that it happens to be at that point and then we just going to set our local storage to that if something happens to it And as I said everything in local storage has to be a string so we are going to stringify that value before we pass it in. And then we just need to return our unsubscribe and we need to return our store. And that is it. That is all that we basically need to persist a store inside of Svelte. That's all the code. 14 lines of JavaScript and we have persisted a store. Now all we need to do is to create a store to persist. So inside of store.js, I'm going to import our function that we just exported from persist store. So we're going to get persist store from persists store and we need some default data here so we're going to create const default data date and I want it to be an array of objects and inside of these objects I'm just going to put a title title complete kind of like the start of a Kanban board here and then what we need to do is use that function that we created and pass in our key and our initial value. Over here we've got key and initial value. So we need to use, we need to export because we're going to use this inside of the component. So we're exporting a variable called store and we're setting it equal to that persist store function. That persist store function needs a key so we're just going to call it data. You can call that whatever you want. It's just what it's going to set it as inside of local storage and then we need to pass in some initial data so our initial data is going to be that default data that we just created save that and now we can use that over in app.svelte in app.svelte we don't actually need any of this except for maybe the script tag so I'll erase all of that and take that out and then I will save that and it is back to the way we need it here we just need to import our store that we just created from stores and store And then here all we have to do is you don't actually have to wrap these, but I think it's good practice to do that. So I am creating an each block with our Svelte syntax and using the special dollar sign syntax that Svelte gives us to make this variable reactive. So anytime it changes, it's going to update it on our site for us. store as, and I'm just going to call this data. And then I'm going to close my each block so I don't forget to do that and go back up, create a section tag here. And inside each of our sections, we're going to say data dot, not that. Sometimes autocomplete is not great. Data dot, and what do we call it? Title. So title here. And once we save this, we should see here we have to do in progress and complete. We can actually inspect that and see that now in local storage, we have to do in progress and complete inside of our local storage. So if something happens and I accidentally close that window, now I can go back to it. Local 5000. And we have our data still there. So this allows you to create an amazing amount of functionality. You could go on and add anything to this. I've actually created a Kanban board with this before, so I'm gonna show you that real quick. So I'm just gonna run npm run dev and open that up and see here that we have like a fully functioning Kanban board where you can delete the whole column, you can delete some cards, and check local storage. And then we're going to close it all the way out and open it back up. And we have the same thing back. So here is persisting local storage with Svelte. I hope you enjoyed it. Thanks! You can find the repo for today's demo at github.com slash brittanypostma slash spelt-stores or in the description below. The other app that I showed was Svelte Kanban if you wanted to check that out as well. Thanks so much!