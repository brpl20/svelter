 Okay, so hi everybody. My name is Matthias and I'm working as a data scientist at Karolinska Institute, where we call it bioinformatics actually, so I'm working a lot with biological data actually. And I'm also working at this small company Higgs Visuals where we create data visualizations and for both, for Karolinska Institute and for the visualization company actually, we use a lot D3. So who of you knows of D3? Yeah, most of you. That's good. Because now I'm coming here with yet another framework. Okay, Svelte is maybe not really a framework, but still. And I try to combine that. But it's really nice to speak here because usually I have the academic audience and everyone wants to see results. And when I then say, yeah, I made this visual with Svelte and that's a really cool thing, and then everyone is boring and not really listening. But here it's the other way around because you don't care about research. You care about what's on the screen, actually. So what I want to take you on a journey to an elementary fairy tale about life in transition. And that really describes what we want to do because elementary is a nice description of Svelte because Svelte lives of this modularization aspect. you'll see in a second also and yeah transitions is of course animations and effects that we want to have in data visualizations because we want to have for example let's say at Karolinska we want to have for the doctors at the hospital a nice front end where they can see their patient data and how to treat them and we cannot deliver them a black and white table they want to have really colorful things so that's where we need animations and effects and also live because data visualization is nothing else than life because it reflects life in the end. So let's see. Svelte really goes very well together with D3, what is like the state-of-the-art visualization framework. But let's go a step back and look at what we really like of Svelte. And I mean, in your talk, Kevin, we have seen some cool things that Svelte has. And for example, I like Svelte because it's very fast, because it has this compiler thinking. So it is a compiler it takes the code and makes it so that your browser can interpret it very easily It has a very cool reactivity concept so you can get reactive variables very easy in a nice way And it has built-in transitions, we saw some of them already in your talk, and I will show you some custom transitions also and a lot of more stuff, of course. But what about D3? And some of you haven't raised hands, so maybe you think, what the hell is D3. So D3 stands for the data driven documents and that is like a framework that you can use when you want to create nice data visualizations for the browser. And so let's just go to the browser and what I have here is the Svelte repl so you can go at the website there and try everything you like. And I have here a very simple application. I first show you what it does. So here is like a checkbox, show curve, and when I click that it shows a curve with a nice animation on it. And when you click it again, this curve goes away again. So how would you do that? For that it's typically to use, yeah, that's a typical D3 case because here is like a curve showing some data. You have to translate the the data into pixels and there is even an animation on it. Perfect use case. So let's see here in that main app.swelt, I just have this graph component which takes the data. The data just looks like that. So it's an array of these age and temperature objects. So apparently here we measured the body temperature over the time of some patient, for example. And the data goes into that component, and also the show, which is just a Boolean of that checkbox if it's checked or not. So let's look at the graph.swell. And here I first import a lot of D3 custom functions. So do not worry about that now. What is interesting is that here first I create an x scale and a y scale where I use the D3 function scale linear. And that just creates me a translation from the data values, so from the temperatures and the ages of this person to pixels actually. And I also have this thing which is really nice in D3 There is a line function and you can just pass your data to this function and it creates an SVG path of it so that you don have to worry about the coordinates how they are plotted in the end. And then there is this onmount function which is called when this component is mounted to the DOM and that first lets me put that path on the screen. so this is D3 again so there is a select function and I can select a DOM element so this is the SVG element down, down, down here on the very bottom you see the SVG element and with this bind this you get a variable for it and then I append the path to this element with the data and stuff like that and then there is this transition which is like shifting the path, the visible path out or in of the view so that you get this nice effect of drawing the path. It's not that important to understand, but what you see here is that this show boolean, if it turns from false to true or vice versa, it draws the path or it removes the path. So this is all D3 again. It takes the path and then this transition and duration function, this is D3 to just put this timely transition on it. It's a lot of code, and hopefully you will not leave the room now, because this lot of code makes just this one curve. And you can easily see there's no need to use Svelte actually for it, other than asking if that is true or false, the checkbox. There is no reason to use Svelte, because I used D3 for all the stuff. And what I want to do with you is to transform that into a really svelty data visualization. So let's go back. So we, or I at least, love D3 for the selection method. So you can easily select DOM elements, for example. For the scales, so there are a lot of scale functions. I just showed you the scale linear, where really your data is linearly or in a linear way translated to pixels. there is a lot more all the math behind I mean this is a simple line now but it just data and you seen that the curve was smoothed out so this is also done under the hood with D3 And transitions what we seen here also And a lot more of course But now let combine both Svelte and D3 and just take the best part from both sides. And I think Svelte is really good in DOM manipulation, in really implementing a component style in your apps, and also the actions. We've seen that before. and also inbuilt transitions, I think really cool to use together with v3, from where we could take the scales and also the shapes like this nice smooth curve and also interpolations of data are possible. So let's see how that would look like if we start transitioning this Svelte app into a better Svelte app. And let's make that a bit bigger. So nothing has changed here. I have just changed some things in this graph component. Because now, if I go to the very bottom, I have introduced a path here directly as HTML code. And I introduced a variable path, which now reflects only the path and not the whole SVG anymore. And I can pass directly the SVG path information here to the D attribute. You might know that. So this is how you can then really draw the path. And I can assign some styles to it. So in that case, it's really simple because it's a purple line with some stroke with and no fill. It does exactly the same as before. But now I got rid of appending the path in the JavaScript actually. So here it's also appended in the JavaScript, but under the hood now by Svelte. So Svelte took over that. But still I have these transition functions here that are not easy to read. And they come from D3 at the moment, but I think it's better to use Svelte here for these transitions. And I show you that in the last part. So that would be an optimal way how you use Svelte and D3 together. So maybe I'll just zoom out a little bit that you can see. That's all the code I have left here in that component.

 That is because I kept the x scale and the y scale from D3, which just translates my data to pixels. I have kept the path generator, which produces me this nice curve. But everything else is swelled now. So here, for example, this path is now within an if block. So only if show is true, show me that path, because otherwise I don't want to see it. And also on the path I have this transition colon move which says and when you show and hide the path apply a transition first and that is of course exactly what happens here. It should be shown but before showing it completely do a transition. We'll go into that in a second. And also when I toggle to false the show variable everything goes away from the DOM and a transition transition is again applied. So now the interesting thing is how does this transition function look like? And it's very similar to actions. I have this transition which is called move and that I import from move.js. So let's go to there. And this is just the whole move function. So what you see here is similar to the actions. Within the function you get the actual node. So that will be the path. That is here. That doesn't work on that. Here's the node. And then you can also use some standard parameters. Here I declare duration as 1,000 milliseconds and delay as 0 milliseconds. And then I first try to calculate the path length. That is done on line three. So I just take the node and there on the SVG path you have to get total length function that gives you the total length of a path. And then I do this node style stroke dash array and that is like the trick that I use here because I apply a dash function to this path and it's like dashed. It has a long visible dash basically as long as the path is and then a non-visible dash and that's done here. So this is like the convention in also in CSS how you apply that. And then I just return another object which has the duration and delay in it and this weird CSS parameter here And there it just says stroke That is basically how far am I in moving in my path And I set this stroke-offset to u times path length. So path length is the whole path. And t and u are two numerical variables that run through the animation. So I have 1,000 milliseconds of animations. In the beginning, t will be 0, and in the end, t will be 1, and it's running from 0 to 1 over these 1,000 milliseconds. And you will just do it the other way around. It starts with 1 and end at 0. And that means that during the animation, I run my path length from the actual path length down to 0, and that gives me this moving effect. Now, the really cool thing here, and that is specific to Svelte, is because I apply this function here, So I have this function here under the CSS property. Svelte will take that and create actual CSS with it. So it creates a CSS animation from that that is applied to my path. So what does that mean when I have a CSS animation that runs not in your JavaScript thread. So it's cool to have a smooth animation. It's cool to do it in CSS. And Svelte is actually doing this for you under the hood. And that is, I think, quite cool. by using that, so that under the hood creates you some keyframes doing the whole thing. And it works actually, as you see here. And by the way, with that implementation using this custom transition function, you also have a lot less code and a lot more readable code in the end. OK. So I mean, this is still very theoretical. So before I show you an actual example where I used exactly that line in a visualization, I just want to give you some take-home concepts that you could use in your when you want to develop something in Svelte, especially data visualizations, for example. So you can use with the componentization. That's a very nice word, but Richard is always using it. So that you really write different components. And I mean in our example it was really easy It was just this graph component But even within your SVG you can use for each group for each path or whatever what you can use a single component and stitch them together as you want. So it's really great. You use the two-way bindings, like you already showed, for values in text inputs. I usually use it for dimensions. So for example, I question in the beginning what is the width and the height of my browser window and that I store in a store so that every component can use this information, for example, to get responsive graphics in the end. Yeah, that's that. And also I use a lot of actions. I haven't shown that now because you showed already some nice examples. because you can not only use actions on regular HTML elements, but you can use actions also in SVG elements, on canvases and whatever, everything which is in the DOM. So that's a really cool possibility. Okay, so let's look at some data with examples that were created with Svelte. And so that I just have to reload. Yeah. Now it doesn't work anymore. Ah, there it is. Okay. That is an example which goes back to the body temperatures. Because in a few weeks ago, oh, you know, it was two weeks ago or so, there was a study published from researchers, and they analyzed data where hundreds of thousands of people body temperatures was measured since 1800 something and they discovered that the body temperature is actually going down over the last centuries not much but it is a measurable effect and it has maybe something to do with less infections maybe now it goes up again because of coronavirus who knows but but I found it interesting to look at individual people in study and how their body temperature changes. So I created this. This is all done with Svelte. And you can click on single humans here. So in red you have the women and blue the male persons. And then you get here their body temperature trajectory, sometimes over 10 years. And you see that it very variable Let click the man here And then you also get these blue spots That means that at that time point of measurement the person had a cold, which also can raise your temperature, of course, which was here the case, but not here. And overall, when you click through that, you see that it's very variable. And there is not this like 37 degrees is the regular temperature. So every one of us has his own basal level, basically. What you can see in the data is that the older you get, here are the 17-year-old people. The older you get, the lower is your temperature. That's for sure. Okay. And then you can also do more useful things than that. For example, this one here was a project. This is not from Karolinska, actually, but that's more a private one. That was a project because I'm from Germany, and I sometimes fly from Stockholm to Frankfurt, and I was interested how variable flight prices are over time. So if it makes a difference if you book 30 days ahead or if you book only one day before takeoff. So I measured flight prices, so I downloaded them every day from Google Flights, actually. and then for a specific date of departure, so this was last year, 24th of April, for example, you have a certain amount of flights. Usually it's six to eight flights going from Stockholm to Frankfurt. And here this is the flight price just 30 days before takeoff and then how it develops until takeoff. I mean, what you can see that is maybe quite expected is that's just before takeoff prices go up because these are people, they have no choice. They have to book it, so they pay every price, basically. But it's very variable over time. So, for example, when I go to May, and then I can select a different departure. Let's take the beginning of May. That was the Easter holiday time last year. There you see that it's quite cheap when you book early. Then it gets very expensive. And I mean, here we are talking about differences. You can click on those and see if you book 30 days before, you pay 151 euros. If you pay here 1.5 days before, you are at almost 600 euros.

 But the night before it dropped again, so bad luck for people who booked here. Yeah, and of course when you go to June and then you go for, let's take here the midsummer weekend, you see that it makes really almost no difference if you book 30 days before or at takeoff, it just stays up because that is when everyone wants to fly away. So it's summer, start of holidays, of course. So, but besides of that interesting data, this is all done with Svelte. And here it was really cool to use Svelte because in this visualization, I have mixed SVG with Canvas because here these price lines, you can have a lot of them. For example, I can select a whole month with this brushing slider. And then you get a lot of lines and it still needs to be very smoothly in the reaction behavior. This you cannot do with SVG elements, so you need to draw the pixels on a canvas. But then on top and below of that, I have some SVG graphics, for example, for this coordinate system or also the points when you click on that. This is done with actual SVG elements. So for each of these things I have a component and you can look at those, I think we share all the links right afterwards, you can look at those so it's all open, how one possibility at least is to implement such a thing. Okay, so yeah, the last one. Yeah, let's skip that for now. Also when you are more interested in going into Svelte and also in D3 at the same time, there are some very interesting resources. So there is like one guy also from the New York Times who created Layer Cake that is like a framework which uses which tried to already combine graphics and Svelte and so so that you can easily import a scatterplot component for example And there was just recently a few days ago a blog post from Rich Harris the creator of Svelte himself which is that one here. And he found out that it's quite nice to mix HTML elements with SVG to make responsive graphs that use no JavaScript at all, which is very interesting to see. and he also created immediately a library for that which is called pancake because you layer the graph components like pancakes. And so that is really nice and when we share the slides you can just click on that. And if you, I don't know if there are people working with WebGL which is then the ultimate way to do graphics in the browser using your graphics card. There is also Svelte GSGL like framework which builds on top of Svelte and really with, I don't know, 10 lines of code you can build a WebGL animation. But this is still in its infancies I would say and currently actively developed. Yeah, so this is like how you can combine D3 and Svelte to give you some starting point maybe if you want to try that on your own. And this is just another two visuals, because I mentioned the Karolinska. I have to show you one of those. That is actually one that we use at Karolinska Institute. That was like a graph where we wanted to combine an alignment of smaller pieces to one big one, and at the same time to show a network on that. So this is also built within Svelte and fully reactive. I'm not allowed to show you the full thing, of course, here, but, yeah, it's medical data. And that one is another which you can find openly in the web where I tried to visualize the childhood mortalities in different countries over the last years. So larger circles is a high childhood mortality in a certain country. We can quickly go to that So, for example, let's take Sweden. Here is Sweden. Here you see the childhood mortalities from the 1950s up to today. to today, and this is death children under five per 100,000 no, per 1,000 births, so around 0.3% die every year that's very low compared to the world so you see here very small dots and this is like today and 10 years back, 20 years back and you also see like there are these countries where you have very high childhood mortality and here on the outside you see when it's blue it's getting better and when it's red it's getting worse over time. So there is for example here Venezuela which is because of the politics crisis there where the child mortality gets worse actually. So this is also completely done with Svelte and here I also use the thing that I store the width and height of the browser window in store so that I can request that in all of these subcomponents here. So, for example, then when you make the browser window smaller, everything is adjusting to it so that it also works on the mobile phone, of course. So, that's, yeah. Yes, and with that, I want to thank you for your attention and I hope I could give you some inspiration. And if there are any questions, I'm happy to take some and also to discuss with you afterwards. Thank you. Any questions? Working with WebGL and Svelte or like DeepFree and Svelte do you think there a case for moving from like desktop applications like in vivo Wolverine et cetera into the web Thanks to Svelte. Into WebGL or what do you mean? From like desktop applications for data visualization into web. Definitely, so the easy thing with the web is it runs everywhere, you do not have to install anything. So we are actually transferring everything to the browser. It has, of course, limitations, because you cannot load a gigabyte of data into your browser. But also there is some help when you work with SQLite, also, yeah, SQLite basically we use then. But yes, we move everything to the browser because it's so easy, accessible, and runs everywhere, no matter if it's mobile or desktop or, yeah. And there, of course, Svelte is cool to use. Yeah. A related question. Is there any case where you figured, like, OK, we need to use WebAssembly for this? I didn't come across that point, no. Yes, there might be applications for it. I didn't have any of those. So, yeah. It works for graphics. For simple images, you mean? background image. Yeah, I mean you can use all the tricks you know from CSS or plain JavaScript. You can use them as well too because you are just producing plain JavaScript with it. So for images. D3. Ah, D3 for images. I would say for images you would use the standard ways of styling your DOM elements or using CSS to make it responsive. Yeah, I don't think that D3 would... D3 is good when you have data that you want to transform to visuals. If you already have an image, there's, I think, no need to use D3. Good. Thank you again. Thank you.