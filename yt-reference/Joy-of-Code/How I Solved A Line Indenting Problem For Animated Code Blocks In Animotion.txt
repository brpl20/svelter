 Hey friends, what's up? Today I want to share how to solve an interesting problem with you. So here I'm working on this awesome animated code block using ShikiMagicMove, which you can check out if one of my previous videos where we actually implement ShikiMagicMove in Swell, but you can actually see this code block animates beautifully. But the problem is right here. So for example, how this works here is this code component inside of our slide. Here we can pass the initial code block, and then we can just invoke this code.update method, and then it's going to do some diffing apply the correct syntax highlighting and that's basically it easy peasy lemon squeezy like that friends but for example why are we making the user ident this code this is something i don't like so for example if we do something like this because it's more aesthetically pleasing or we just want this code to be like that we can do something like this and you're going to see it's going to look weird because this is using a pre-tag so it's going to apply all of this white space you're going to see the animation works the same as before but now we have this slide shift and offset which we're going to explore how to solve today all right but before we write a single line of code i think what's more important is to talk through the problem so here i have this exact same snippet that has the same problem so solving problems in general is knowing about what variables you have to solve the equation right so in this case we have some text and it might look intimidating oh what kind of string parsing we have to do and etc to get the results that we want and the answer is none basically if you know how text works you know that this text has some hidden characters like newline characters, tab characters, and etc. So what we can do, for example, I'm going to go here to the settings, I'm going to enable render whitespace, and I'm going to see if we go back to the example, we're going to see the tabs here, which is hard to see. So I'm going to also enable this other option so we can change the color of those symbols. And now we're going to see them clearly. All right, so now we actually have more variables that we can use to solve this code. All right, so what do I propose to solve this? So for example, looking at the least identified line of code, we can take the number of tabs from that and based on that, we can just remove that amount of tabs from all the other lines So we can do something like this We can actually look at this first line because we actually assume that the user gave us the complete code that we going to look at So naturally the least indented line is going to be the first line So we can count 1 2 3 4 So now we know that these are 4 tabs, and now we can do a simple replace for all of the other lines. We can just remove that amount of tabs. 1, 2, 3, 4. And now we're left with one tab. So let's see how this would work. So we would remove these tabs, this is 4, right? And then we would remove 1, 2, 3, 4. Boom. 1, 2, 3, 4. Now we would remove this, and we would again remove here 1, 2, 3, 4 tabs, and so on. So now we can remove this for all of this, and now we can guarantee that the tabs are going to be consistent, like this. And that's basically how simple this solution is going to be. Alright, so now that we thought through the problem, we can actually start implementing it. Okay, so now that we don't need this, let me just revert this back, because it's annoying. so we're not going to render white space and i'm going to also disable this but you can leave this on if that's what you fancy all right cool so here i have this code component and i'm using this indent function which really isn't important where we're using it basically string goes in here we're going to work with the string and then we're going to output it okay so you might be thinking let's just log out this string so we can see the special characters and we're going to see we actually can see the special characters here but there's actually two things that you can do so for example you can actually make this into an object and then you're going to see the string here with all the special characters and another thing is that you can use jason so you can say jason stringify and you can pass it a string and boom you're going to see the same result easy peasy lemon squeezy like that friends all right so the first thing i want to do is actually know the amount of tabs that we need to remove so how can we do that well i'm just going to remove this line and if you're on the running string here so things don't explode so let me just go here and i'm going to say const tabs and here we can start doing things on the string right and let me just console.log tabs here so we can always see what's going on and let me just make space like this just so it separate cool so now we can split all of these things by a line which is based on the new line character So we can say string split new line And now if we go back to our code let me just actually clear everything just so it easier to see what's going on. So we can actually see here tabs, we split everything by a new line. And now we can start working here. So the first thing you're going to see, these are these empty spots, basically because new line got replaced. So that's just empty like this. So actually, the first thing we have to do is filter out these bad, falsy values, just so we get useful values that we can work with. So basically going back to our code, we're going to say filter, and we can just pass in the Boolean function, which is equal as, for example, saying value, and then we can say Boolean, which is the function value, but it's way easier just saying Boolean. This has a special name, I actually forgot what the name of this was, but actually we can just filter the bad falsy values. We can just save this, and now we're going to see, we're going to get back tabs again, and now we're going to see all of those falsy values are going to be filtered out. Awesome. So now actually, we want to take this first value, because again, we're naively assuming here that this is the entire call block the user is going to supply. But actually as a homework to you, maybe at this point, if you want a challenge for later, maybe you can do something more advanced, maybe use a map, reduce or whatever to find out what is actually the line with the least amount of tabs, right? That's the amount of tabs you're going to use to remove them from the other lines. But in our case, we're actually just going to assume that this is the first line and that this is the amount of tabs that you need to remove. So this is one, two, three, four, right? Alright, so how can we do that? Well, now we get back this value, and now we can just take the first one. Now we have these tabs right here, as you can see, one, two, three, four. Alright, so now all that remains is to do, we can split this again, so we have all these things separately, and then we can filter this, because we just want to get this part, tab, tab, tab, tab, tab, so we know that it's four tab, and then we're going to turn this to a string at the end. So let me show you what I'm talking about. So here we're going to say again, split, and we're going to see it's going to split it, So now we're going to get these things and we're just going to filter the tabs. That's basically it. Now we going to say filter character if character equals tab right And now if you save this if you look at this we going to get back an array of these tabs and the only thing left to do is convert this back to a string which we can do by saying join so we can say join boom and now we get the amount of tabs that we need to remove or replace in our case and we didn't even have to write any regex how beautiful is this friends all right so now that we have the amount of tabs we're going to use that to replace the tabs for the other lines so going back to our code here let me just actually remove this since we don't need it anymore here we're returning the string we can actually do the same thing here again we're going to split it so we're going to say split it by new line and now we can map over the lines and change them for example map we have access to the line we can say line replace what we want to replace tabs with what nothing that's right boom how easy peasy lemon squeezy is this friends and the last thing we have to do is join of course so we return back a string we're going to see we're actually going to get a slight problem so everything is on a single line and why did this friends well let me actually just close this so because actually when you do split on a character like this so it's just going to say yeet and boom there goes our new line so how sad is this friends all right but we can actually easily fix this so instead of just passing a string we can actually pass in a regex and it's really simple so instead of doing this let me just pass in a regex we're just going to use a capture group and then just paste it in and this is going to preserve the character all right so now we can save this and boom it works like magic right but there's actually one less thing that i want to fix so for example if i select this you're going to see we have some extra white space here which we can trim using trim how easy is this right so we can say trim and now that's basically it so now we can look back at our code so we can just animate this and it works beautifully. You can see, you can format your code now however you want, you don't have to worry about this because now I can do that for you. Alright, and that's it. If you like what you've seen, don't forget to like and subscribe and you can also support me by becoming a patron. Thank you for watching and catch you in the next one. Peace!