 Hey friends, today we're going to learn how to make your own UI components in Svelte. In this example we're going to make an awesome and accessible accordion, which is really easier to do than you think. But we're going to learn other things, for example how to compose components in Svelte, how to use context. As you can see here, this is an awesome accordion, only one can be open at a time. If we pass these collapse props, and if we don't pass it, then we can have multiple open at a time. I also have another prop here which is going to be open and since this is a loop I'm going to say if i is equal to zero so we're going to have one by default open if I refresh it you can see it works as expected then we're also going to learn something really awesome how we can pass CSS variables to swell components which makes styling and customization extremely simple so I can go here for example accordion background I can say black and then I can change the accordion item color itself say accordion color you can change it to something like aqua and how awesome is this and this is really extendable so if you're working your neural component library going to learn how you can do that so yeah I'm excited to get started if you want to follow along create a self-kit project I'm just using the basic template with TypeScript you don't have to use TypeScript it's purely optional, and you can always find the example and everything I'm saying here in the post. So as you can see here in our page, I have some items which we're going to use to loop over the accordion items. Inside our layout, I'm importing our regular CSS file, and in the CSS file, I have some basic resets. I set the height on the HTML and body element, and then I center everything using this awesome one line of CSS. And basically that's it. Alright friends, before we get started, I want to talk about something really important. I really want to focus on the techniques and how you can approach implementing this kind of things so you can apply to your own project or learn something new. Alright, so you want to make a custom UI component and basically you're replacing some functionality of the browser and no one can blame you because the browser has a lot of awful primitives. So what do you do? Well, thankfully, there is the Web Accessibility Initiative or ARIA Offering Practices Guide, APG, where you can go and you can learn how to implement these things. So you can go to the patterns. You can see here is a pattern for all the popular UI elements if you have to implement it yourself. So they're saying, okay, if you're going to do this yourself, at least do it right. And it's really nothing intimidating. So they really describe the pattern. Here we have an example you can play with They even tell you what you need to do which you going to look at This is just a lot of text but it really not that complicated And then if you go to the example they have this example And unfortunately they also included for some example a form here which makes the example complicated for no reason. But yeah, basically, that's it. So if you look at here, keyboard support, it tells you what you need to do. Space or enter should focus the accordion. Pressing tab should move the focus. And using shift tab should move the focus back. And then they even show you what role property state and tab index attribute to use so you just go here okay check check check really nothing intimidating and then they even give you some code including the javascript which isn't relevant to us because we're going to use svelte but you can see here is even the html source code so they tell you hey this is semantically correct and again this just looks like a lot of code because they included the form for whatever reason and over complicated things for no reason but yeah you can see here it is so basically this is how you can approach doing this sort of things. And there's really another awesome thing which is OpenUI. Let me just look it up. So basically OpenUI is focused on researching these design patterns and bringing them to the browser. If it ever happens, that is right, because you can also go to this page and you can look the research on, for example, let's look at an accordion. So you can see here is the research. They even link to other design libraries how they use it, so you have everything here in one place how they do it. So for example if you look at the switch. Here is from Andesign, AtlasKit, Evergreen. I haven't heard about most of this, to be honest. But yeah, you can see how others implement it if you need some inspiration. But yeah, that's basically it. So let's go build an accordion. Alright friends, let's get started. So you can do this many different ways. And what I love to do before I write any code, I like to think about a magical API I would love to use. So you can just dream it up. I can say accordion and then I can start thinking, okay, how do I want to approach this? I know that I'm going to have an accordion component, but what kind of API do I want to use? How do I want this thing to look like? And then I can walk backwards. I don't even have to understand if this is possible. If I just have an idea, I can just ask someone, hey, is this possible as well? How can you do this, right? And this is really super exciting when you start to get into that mindset and you start to realize that almost anything is possible. So what can we do? We can, for example, pass these items and then I'm thinking, okay, maybe we can loop over these items in the accordion and show them, but that's kinda meh because you have to always specify an array and then you have to pass it. But then maybe let look at another option So maybe we can use Composition as well we can create an accordion and then we can maybe have an accordion item So we can do it like this And then we can give the rendering control to the user So they can pass whatever they want. They can say title or whatever. They can insert a paragraph. Like a description. Okay, that's starting to look a lot better. And now I'm starting to think, okay, how am I going to do that? Well, basically I have an accordion. And then you're going to have to think how can we pass some state to the child elements, which is also fun. And in the case of the accordion item, how are we going to pass the data? We're using props in Svelte, of course. So if we remove this, we can just use named slot so we can place the items wherever we want. So let me just create a div, for example. And I can say slot title, so we're going to put it in the slot, which is the title. And then we'll just say item 1. Let's just copy it over. and this is going to be the content and you can also make another one for an icon if you want or etc and this is already starting to look good to me so you can remove this one and of course we didn't create anything yet so that's going to be a problem if we save right and now this is starting to get real right so we're thinking about this api we're also thinking okay if i have an accordion the default behavior i want is that you can open each one but maybe if you can pass some magical prop like collapse you can only have one open at a time which is really cool but what if I want to have an accordion item open by default how can I specify that well for that accordion item I can pass a prop such as open and that's going to be really cool but let me just remove that and let's go to implementing the accordion so I'm going to open the sidebar in source lib folder which is default by alias I'm going to create new file which is going to create a folder using this neat trick so I'm going to say components accordion and then I'm going to create the first file which is going to be index.ts actually because we're going to export the components so let me show you something cool now I can go here and I can create an accordion and by the way it's really not important if you use lowercase or uppercase for the cell component name that's really relevant I prefer lowercase so I can do this I can create a new one I'm also going to have an accordion and I can close this. So what if I create this index.ts file? So we can export these components and we can just use one import for them. So you can for example do import accordion from now we can get autocomplete and now I can say accordion item from accordion item, and now we would have to say export, and then you can do accordion, accordion item, which would work great, but there's another syntax you can use, so instead of doing this, you can say export. Since this is a default export, we can say default as accordion from accordion svelte. Let's just copy this over. So we can say accordion item. Same thing. We can remove this. And now we have our export. So we can close this file. We just go here. And now we can import it. So we can say import accordion and accordion item from, since this is alias, we can use lib. We can say components, accordion, and that's going to be it. And if you just created the lib folder and SwellKit has issues recognizing it, just restart the development service. You can go to your terminal, control dot, control C to stop it, and you can say ppm run dev, and everything should work. And awesome, we don't get any errors, and we can start working on the accordion. alright so let me just rename this to content2 and I'm just going to duplicate this over so we have more things to work with I'm going to say item2 and content2 alright so let's create the accordion item we're going to go here I'm just going to create a regular div and I'm just going to give it a class name accordion and then we can pass anything we have here so if you don't know what a slot is basically here we have an accordion so we can say, okay, everything inside of here is like a black hole, so Svelte is going to slip it up. Basically, that's what a slot is. So anything else you're going to show here or just pass it to another component, just like you have in regular HTML, right? Because a parent can have children. So I'm going to go here and I'm going to add a simple script. And now we're just going to say export let collapse. And by default, we're going to say false. This is going to be our prop, which is going to collapse all the other accordion if it's specified. And then let's add some simple styles. So here I'm going to say accordion, and we're going to do something cool. So I'm going to use a CSS variable, I'm going to name it accordionWith, and then we can specify a fallback value, it's going to be 60 characters.

 padding, same thing, accordion, padding, one RAM by default, and then for the color, you can say accordion, color, I'm going to say HSL, 10%, 10%, because I really like this color. Now I'm going to say background color accordion background and I'm going to use let's see 2020 10 percent 10 percent and of course these secondary or default values can also be CSS variables which I encourage you to do but for the sake of the tutorial I'm just going to hard-code it like this. Alright, then I'm going to have a border radius, accordion radius, I'm going to say 4 pixels, and then I'm going to have a box shadow, accordion shadow, make sure you spell it right, and the default value is going to be 0 pixel, 1 pixel, 20 pixel, So, HSL is going to be 2020, 10, and 8% for the shadow. And you can also pass it opacity, which actually if you say slash, you can do something like 10%, but I already picked the color I want, so everything works great. Awesome. And basically, we can pass these CSS variables to the component in Swell to override them. And how awesome is this? You don't even have to do that. You can just define these variables in your global styles or whatever. As you can see, we already have the element here. So let's start working on the accordion item so we can show it on the page. Let me also save this. And now we're going to go here. I'm going to create a script. And by default, the first prop we're going to do, export, let open, false, just so we know each one is open or not. And because each one of those is a component, this state is specific to that component. So if you change open, it's not going to change the open state for any other value, but only for that instance of the component. All right, so let's create an accordion item like this. then we're going to have a button which is going to have a class accordion toggle and inside of here we're going to have a title so we're going to say accordion title and this is the slot we're going to pass so you would do something like this but you can also pass multiple slots if you want and you can give it a name so this is going to be the slot name title and then we going to add the caret or the pointy symbol i actually don know what the name of that is but I just going to name it accordion caret You can paste in an SVG or whatever else you want an icon here That really up to you And then I also going to use an emoji So I'm going to say point. So let's save it and we should see our two items. How beautiful is that, friends? So now after the button, this is going to be our item. We can say if open, and then we can give it a class of accordion content so you can autocomplete it and now we can give this a slot right so how do we do it we say name and we're going to give it a name of content so as you can see nothing shows up right here but if we say true then you can see here is the text which you have to add some styles so let's do that quickly so i'm going to go to the styles here i'm going to say accordion toggle with 100% padding. So again, since the CSS variables cascade, it's CSS, right? We can override these values here. So we can say accordion padding, and we're also going to give it a default. We can say color var accordion color, and we can say inherit, and we need to override some styles for these ugly buttons by default. So I'm going to say font inherit. Font weight is going to be 600. Border none. Background none. And since we also want a cursor pointer here, when you hover over it, you can say cursor pointer. Let's also give it a border radius. You can say accordion. radius and you can specify a default value. And now let's see, so we can specify, let's see, we can also say display flex justify content space between, so I want this text to be on the left and the pointy boy to be on the right, so we can do that. And then since you're going to use a hover later I'm just going to say transition background color 0.1 second ease let's save that and awesome this already looks better so let give it a hover accordion save accordion say accordion hover is going to be a new value but we can use a default one which is going to be 20 20 20 percent and 20 percent and then for the accordion content we also want to give it the same padding so i think we can even go here, let's just do this. So we can say accordion padding 1rem. Alright, and let's see why we don't have our color, so it inherits it from this color, so let's see, I probably did a mistake here. Here is color, oh this shouldn't be dark, this shouldn't be a light value, like 90 and. So if we save this, really awesome, and of course nothing works yet, but as you can see, now we're starting to see some results, and our wish top code is now reality. So another thing you can do if we inspect this element right now, you can see all of these elements here are going to have a wrapper, but there is this really useful thing in Svelte if you don't want an extra wrapper, you can use Svelte Fragment. So let's just select all of these divs, Ctrl D, now I'm going to say Svelte Fragment. And this is going to just remove those extra wrappers. And awesome, now we don't have those extra divs. But of course this is optional, we don't have to do this. Alright, so let's first toggle these open so we can go to the button. Here it is. So you can say on click. You can say toggle open. And now you can just specify a function here. Function toggle open. And now we're just going to flip the boolean. So we can say open equals to whatever is the opposite. So we can save this. And just close the developer tools. So now we should see that this works. And this is really awesome. Alright, so this works great. But let's get to the brain twisty part. So we have our component here, and then we have an accordion here, and we have our prop collapse, right? And this is really great. We can pass the prop and we can receive it here. But how do we actually pass this data to your child elements? Of course, you can pass it using props. So you can say here, collapse if you want. But now we have to use collapse for every item, and you have to keep track somewhere is this updated or not. And this would get really tedious. So what we can do is use the Svelte Context API. So let me open tldraw. This is turning into a tldraw tutorial So we have your parent here child and of course there plenty of ways of doing it You can use a store but that global right And we going to use a store with context actually So basically your goal is to somehow pass data to your child components without using props, and that's basically where the context API comes in. So you can come here, and then you can use the context API. So you can set it in your parent, and maybe you're familiar with context from React, it's really similar to that, probably inspired by that to be honest. So you can set the context here in the parent and now you can just access this data inside any of your child components. You can go as deep as you want. But there's a problem. How do we know which id is active? For this id to be active we somehow need to assign it an id right which is going to be really easy. Then we can use the context to keep the track of the active id and we're going to need to use a store because the values in context aren't reactive so we can update the currently active component and then we can say hey if this is the currently active component then it should be only open one at a time all right so how can we do that well inside of the accordion here let me just save this file we're going to go to the accordion and now we can just import first we're going to import our writable from swelt it's Svelte store, and then we're going to import the context. So we can say set context from Svelte. So how do you set the context? Well, it's really simple. You can just say set context, and you can just pass it a value. So for example, we can say collapse, and now we want to pass it to the children, right? So you can also pass collapse, and after you specify collapse, you can say set context active, and we're going to create the active one right now. so this is going to be the active component id and this needs to be a store because it's not reactive right so you need to always update this value so you can say const active component id is going to be of writable and by default is going to be null and i'm going to type it right now for people who don't care about TypeScript so we're going to do that a bit later and also now we can save this and now we can go to the accordion item let's just copy this import over so you can go to the top here, and now how you have setContext, you have getContext. And now when you're here, you can say collapse, you can say getContext. Now you can use the key to get the value. We can do the same for the activeComponentId.

 we can say getContext, we named it active, and awesome, and now let me just go to the developer tools, control shift I, inside the console, so just log these values, collapse, activeComponentId, and because activeComponentId is a store, we have to use the dollar sign, so you can see it's default null. Alright, but remember we also need to set a unique ID for the component, so how can we do that? We can go here, we can say cons component ID. And now we can use math random or whatever you want, but I'm going to use the built in crypto module. So this is built into node and the browser. So we can say crypto random UUID. So this is going to give a random name to our component. If we log in component ID, so you can see every component is going to have a random ID. Now we can know which one is active. So let's define a couple of functions. Just remove this. So we're going to have a function set active. this is going to be really simple as saying active component id we need to subscribe to it with this dollar symbol because this is a store but if you were not in a spell component in another file you have to use the method of the store so you can say set and then you can set it to the component id but since we're using stores in a cell component we can use this sugar active component id and you can just set it to the component id and this is going to be updated and if you're curious this is complaining because it doesn't have a type which we're going to cover later. So here we have toggle open, but I'm going to make another function, function handle click. So here I'm going to say, hey, if the user passed collapse, then we're going to set this component to active. Otherwise, we're just going to use the default behavior toggle open. So now let's also define some reactive variables here. So this is the accordion item to be opened by default. so we can say open if that is true and collapse is true then we're just going to short circuit it and set it to active so this is going to set the default item to be opened so now let's have another reactive variable is active so we can look if the active component active component id matches the component id and also be careful to not do the same mistake I do all the time, don't say equals because this always trips me up when I type something quick, make sure that you're comparing it. So you saying hey active component ID if equals to component ID hey this is the active one And based on that we going to have our reactive value isOpen So if collapse is passed then we going to look at this value isActive Otherwise, we're going to look at the value of Open that is passed. And now we can change this onClick here to handleClick. And here, instead of Open, we can now say isOpen. let's save this and everything should work the same as before but now if we go here let me see page so again we have collapse you can see it already works it's one at a time if we remove collapse ah how beautiful is this so let's see if we pass in collapse and now we had a value open right so if this is open let me just refresh everything so this is the first one, let me specify it for the second one. Oh, now the second one is going to be open by default, and everything else works the same. Alright, so since we have a list of accordion items here, we can loop over them, so let's do that instead. I'm going to cut this. And then we can say each, I have this candy snippet, now we can say items as item, and let me just paste this over. so we just need to pass in the values this is going to be item title this is going to be item content alright let's save everything and now we should have everything working how beautiful is this friends alright so let me just close this and let's add an animation so we can go here so we can go to the bottom and let's just specify the rotation so we're going to have a class of open and we're going to have a class of close. So let's say transform rotate 90 degrees. You can also use the single value if you want. It also works. So you can say transition transform 0.3 seconds ease. Now we copy over the same thing because you want one for the enter animation, one for the exit animation. Now instead of 90 degrees you're going to rotate it back So we can go to our caret and we can use the class directive So this is really slick Let me just do it like this Prettier is going to ruin it but it going to be easier to see for now So we can use a class directive. So hey toggle this open class if what? If it's open. How awesome is this? And then toggle the close animation if it's not open. Awesome. Let's save this and now let's look okay now how awesome it is now it works now when it's closed it's toggles ah just that little touch of whimsy is what makes my day but if you notice there's one problem well it isn't a problem this works great but how do we animate this and animating the height is historically very difficult recently it's very easy you can do it using css grid but Svelte has this awesome slide transition for us. So we can say import slide, if I can type, from Svelte transition. So let's put it here. And now we can go to the item. Now we can say transition slide. Look at this. How awesome is this, friends, right? There's one more thing we have to do. You have to specify the transition to be local because local transitions only play when the block they belong to is created or destroyed. So for example, the problem would be, let's say that you have a page navigation here, and since you're using the page navigation, it would trigger all of these transitions, right? So we're just saying, okay, just keep it local to this block. And this is simple as just saying local. And awesome. How beautiful is this, friends? All right, friends, so we're almost done, but let's look again at the Y-Area specification. So if you remember, let me just pump the font size down, we need all of these attributes, so let's just add it quickly. All right, so it's really simple. First, you need to go to the button here, and then I'm just going to add some ARIA roles here. So we have onClick, we have the class, and now we have to say area expanded, and now for the area expanded, we can just say is open, which is easy because we're using Svelte. Then we have to specify ARIA controls. And we have to give it the same name. So it has an identifier for the screen reader. We're going to use the component ID. You can name this whatever you want. Banana. It really important that you match As you can see here it tells you what to do Expand the true controls And that it for the button So now we just need to do it for our content Here is our content Let me just make space here So it tells you that you should use role region. We can also say aria hidden when it's not open. But I'm not sure how useful this is because it's not even rendered on the screen. But if you're not using Swell for the transition in CSS, this is then required. I think. And then you can say labeled by, as it says right here, labeled by, and we give it the same ID. So you can say accordion component ID. So we can save everything. And if you go back here, let me just show you. So now we have it here in our element. So we have the accordion, the toggle button, caret. As you can see here is the area expanded, area controls. So the screen readers are going to have an easier time. But you, if you just tap here, then you have focus. If you press tap again, it's going to go to the second item, third item, fourth item. Shift tab should bring the focus back right here. Pressing enter should expand it. That works as extended. So as you can see here, it's not really that bad. All right, so we're almost done, but let's clean up the code a bit. I'm going to make the context code a lot nicer, and I'm going to show you the types. So what I'm going to do, I'm going to open the sidebar here in our accordion. I'm going to create two files. I'm going to say context.ts just so everything is neat and tidy. Then I'm going to create types.ts and first I'm going to include the types here. So I'm going to say type accordion options which is only collapse and it's a boolean. Then I can say type active id which is going to be a string or null. And I can say type collapse context. And you're going to see how you're going to use this right now. And this is going to be really a neat way to keep everything in one place because you're going to have to import your types everywhere for the context to be happy. So we can say active ID context. And this is going to be a writable, which is going to be imported as a type from Svelte. So you can say writable. Since it's a generic, we can say active ID Yeah, and now we just need to export these values. Awesome. And basically that's all the types done, so now let's go back to the context file. And basically instead of having things all over the place, we're going to have everything in one single file. So if you remember,

 Remember we have const activeComponentId, which is a writable, so let's import that from self. So what type is that going to be? ActiveId, which is going to get imported from the types. We're going to pass defaultNull, and then I'm going to define two functions. I'm going to say function setAccordionOptions, and then I'm going to have another function getAccordionOptions. options. And you can do this however you want, but this is really neat. So what are the options you're going to pass? There's only one, which you're going to pass as an object. Collapse. And now we can just give it a type of accordion options. It's going to get imported from our types. How awesome is this? And now we can do the same thing we've done before. We can say set context. We're going to set it to collapse. The collapse we passed. And then we're going to also say set context, we should probably import it from Svelte, right? Let's just move this to the top. So this is going to be the active ID. Let's say active component ID. And now we can also pass it a type here, like this, set context. So this is going to be the collapse context. And this is going to be the active ID context which really isn that intimidating There just really a lot of letters on the screen As you can see even the auto import moved up So you can just clean this up You can say import type. And let's see why this was important. So if you specified set context just here, then you would have to import this type again in this file where you consume it, right? But instead, we can just do everything here. So you can just say const collapse, and now you can say get context. How awesome is that? We can say collapse What type is that? Collapse context This is really awesome We can say active Component ID Get context And we can get active And we can pass it the generic type Which is going to be active ID Context Awesome, and now we can return it So we can destructure it So we can return collapse Active component ID and don't forget to export these functions. Save. And that's basically it. Alright, so now we're going to see how clean things become. So we can just remove this. We don't need all of this junk. We can remove the writable and context and let's see if the auto import works. So we want to set accordion options Ah awesome It imports this And now what options do we want to set We want to set collapse We want to pass an object That really awesome We can save that. So now this becomes much easier. So now we can go here and we can remove all of this junk also. So we need the component ID, but we can remove collapse and this for now. All right, so let's also import it. Get accordion options. How beautiful is this? So let's just remove this. I'm going to remove this and this is an option actually a function, my bad so we can destructure it, we can say const and now since we typed everything we get great autocompletion we press control spacebar, we get collapse active component id so now we have everything in place so now this stops complaining because it knows what type it is, right? and let me just do it like this and basically that's it, really nothing intimidating if this is the first time you're doing it it's probably a little bit confusing but just give it a try, practice it on something maybe simpler so you understand what context is, just pass some data like a hot potato through your components. So let's see if all of this works. How beautiful is this, friends? So everything works the same as before, we just made it a lot cleaner. So as you can see, this is a start of a great UI component library. You can use yourself or make one for the public to consume And also remember the variables from before So let me just first try this out Let me just do this And I going to say open This is zero. Then if I refresh this, awesome. It works. Just close this. And now remember we also have access to the customization. So you can say accordion background. You can make it white. And then you can say accordion color, I think. You can say black. And awesome. Now we have this. And now we can change the hover style. So you can say accordion. Hover. So let's see. Let's give it a white color. And then we're not going to see it anywhere. Let's give it something random like aqua. I'm a genius, friends. Awesome. How beautiful is this, friends? Chef's kiss. Alright, so that's it. If you like what you've seen, don't forget to like and subscribe. and you can support me by becoming a patron and join the discord. Thank you for watching and catch you in the next one. Peace.