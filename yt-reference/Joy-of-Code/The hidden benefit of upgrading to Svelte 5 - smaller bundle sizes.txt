 Hello and welcome to the video. So in today's video I wanted to talk about something that I feel like has gone a little bit under the radar when it comes to Svelte 5. So people have been talking a lot about the new syntax in Svelte 5, about runes, we've been discussing performance improvements that Svelte 5 will bring using the signals runtime, the syntax is more clear, there's less foot guns, but something that we haven't talked that much about is the massive bundle size improvements in Svelte 5, meaning how much code you actually end up shipping to your users. So I've been experimenting with this in some of my apps and what I've seen is an up to 50% bundle size decrease, meaning you know you ship half as much code as you used to your users just by upgrading to Svelte 5. So we're not talking about rewriting the application in Svelte 5, we're talking about just basically you know upgrading your package to JSON to use Svelte 5, building your app and you have can have up to 50% less code. And how this works is that in Svelte 4 we had a complete compiler architecture. So your code would be compiled, the Svelte components would be compiled into individual components, individual JavaScript modules I should say, and that was it. There was no runtime. But now in Svelte 5 there is actually a small signals runtime, which is about three or four kilobytes in size. So even though that's a little bit more code and even though some of Svelte's reactivity moves to the kind of the runtime and not the compile time. It means that if you have many components, each one of the components you have can actually be much much smaller now because it doesn't need as much boilerplate as was required in Svelte 4. We can see here we have a little framework comparison that I was doing a couple days ago and we can see that even though Svelte Kit is not the smallest framework out of the box now, there are some specialized frameworks, for example like Astro that really like server first and don't ship any client-side JS by default. Out of the kind of top three where we have you know React, Vue, and Svelte, SvelteKit is by far the smallest framework out there. So what I thought I'd do today is to kind of just give you a short demo of one of the apps I'm working on and try to upgrade it to Svelte 5 and just look at what kind of bundle size improvements we can get without changing any code at all. Let's go. All right, So I have an app here that I'm working on that is still a work in progress. It's an iOS and Android app called Inner Circle and it's built with SvelteKit, of course. And what this app does is it allows you to add your friends in the sort of circle that you see here, and you can kind of move them around and they are represented here, your friends are represented here by different animals, and you can also keep track of your friends' birthdays and your check-ins with them and stuff like that. But we're not here to talk about this app. We're here to talk about the bundle size improvements you can get from applying Svelte 5 to a real project that you already have in Svelte 4 So let start by looking at the project configuration right now So we running Svelte 4 here and I can verify that by calling npmls Svelte 4 All right and I can also build the project. This project is using adapter static because it's going to be packaged as a capacitor app. All right and so one thing to keep in mind is that even on adapter static at any time you build SvelteKit it's going to build a server chunk or like a server build and a client build so we need to scroll up here past the server build to see what the client build looks like so one thing that SvelteKit does by default is it spreads your files out in multiple chunks and I have so many chunks here because this project has you know a lot of routes a lot of and a lot of different components. So you can see here, so maybe like 15 components and a bunch of different routes. So one thing that we would like to do is to make a little bit clearer what kind of bundle size improvements we're talking about, is to actually build just one chunk. And historically this is a little bit tricky in Svelte, but it's SvelteKit I should say, but there is a few approaches now there is this github thread and one of the approaches that is probably the easiest one is to just ask Vite to build only a single chunk for you. So let me go ahead and do that just so we can get a little bit more visibility of the differences between SELT4 and SELT5. So I'm gonna go to the Vite config and I'm gonna paste in this little extra configuration. It's a roll-up configuration where you configure a manual chunk and in this function it's gonna pass every module like the path to every module and we're just gonna say here that I'm gonna build just one chunk by always returning inner circle here so let's go ahead and build again and see how this change has affected the the application and I'm gonna scroll past the server routes again alright so now we we can see that we got a few more JavaScript files, but the main stuff, the R code is mainly in this one bundle called inner circle and it's 261 kilobytes. Now what I can do also is run the preview here and if I go to the preview URL, you see the app and if I check the inspector here, you know we would expect to see the same, like 260 something kilobytes, but we actually see a different number here. We see 78 kilobytes. And the reason for that is that the previous server, and probably your production web server, uses gzip or some other type of compression to minimize the amount of JavaScript that is delivered So let just have this in mind that when we build with the build command we going to see the uncompressed full size of the bundle. So that's what we're going to relate to, even though that gets a little bit smaller once you compress it. So that is great. So let's now upgrade to Svelte 5. Keeping in mind, this is a Svelte 4 application and I haven't done anything to kind of make it it work with Svelte. So let's just go ahead and do this. I'm gonna npm update. All right, let's check again which version we are running. We can see that we're running the next 244 version. Great. Now let's build again. without changing any code at all. Let's go back up here to the client build. Now the client build is only 181 kilobytes. So already we decreased it by like 80 kilobytes, right? That's not exactly 50%, but this actually includes also a bunch of the other, like all of these dependencies we have, right? So everything that is not Svelte is also included in this number. So let's split that up into two different places, right? Well, first let's check that the application is still working. So let's run MPM run preview again. Let's reload it, and yes, it works exactly the same, but now the bundle size is only 61 kilobytes, so that's the compressed size. So already we see the improvement. Now, don't just blindly upgrade your huge application to Svelte 5 without testing anything and just roll it out to production. Don't do this before Svelte 5 has released, but do feel free to play around with it and test it. All right, so now what I want to do is to actually split this into two chunks, not just one chunk. So if it's one of our dependencies, like something from node modules, I'm going to split it into this vendor chunk. And if it is part of our app, you know, basically anything other than that, that's going to be in the inner circle chunk. All right. So let's again run the build just to see how that turns out. So now we see that the inner circle build that is our, the basic, basically our application is 74 kilobytes, and the vendor chunk is 108 kilobytes. We can't really affect the vendor chunk that much because those are our libraries that we're using but 74 kilobytes let's keep this in mind let's go back and downgrade svelte again to svelte 4. and let's build this again and what do we get now 154 kilobytes so in svelte 4 this project takes takes 154 kilobytes. And with Svelte 5 it takes 74 So that more than 50 And this is a small project right This is not that many components You might have projects with hundreds of components and then the wins will be even bigger than here. Finally, I just want to show you something that I usually do in my project that I really like, and that is to add this Vite plugin called Rollup Plugin Visualizer, which is a great way to see how much different packages take up in your bundle when you want to lower how big your application is. So let's go ahead and install it first. And I know it's called a roll-up plugin visualizer, but it does actually work as a VIT plugin. So I'm going to install it. I'm gonna import it. Import visualizer from Rolla plugin visualizer, that's fine. And then I'm going to add it to the plugin array. There we go. And these are some of the default config options that I mean I think you need these. So you need to to emit the file and you need to give it the file name. So now we're gonna go ahead and build again and now we don't see any difference here but when we go to the build folder we see that there's a new file called stats.html and this is actually the visualization so let's go ahead and load this visualization up and it's a little bit small I can't really make it that much bigger I think or a little bit here so here you can kind of see now you see the two different builds that we made, right? The vendor and the inner circle build. So here you can see all the different libraries that are coming that I'm using here, like Svelte French Toast, stuff from Capacitor, NeoDrag, which is a really cool plugin that is very small that enables the dragging in the app. And then here you can see all the different components. So you can see that are bundled with the size does not really correspond to anything. I think the size is a little bit weird so I wouldn't count here but you can kind of see the relative sizes of the different components. So you see this heading component and the select component and you can see where that component is being used so you can kind of identify if you have any quote-unquote bad components or libraries that is taking up like a lot of your bundle. Alright so that was a short demo of the really cool bundle size improvements that you can see by upgrading to Svelte 5. I hope you liked the video. Let me know what you thought about this. Have you tried it in your apps? And let me know if you have some more topics that you want me to cover about Svelte or web application development with Capacitor. I'm all ears, so please provide your feedbacks in the comments below. And don't forget to subscribe. Thank you for watching.