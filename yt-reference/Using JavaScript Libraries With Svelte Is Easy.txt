 Hey friends! Today we're going to talk about how to use third-party JavaScript libraries in Svelte. Unlike some other JavaScript frameworks, in Svelte you don't need special wrappers around third-party JavaScript libraries because you don't have to think about re-renders and effects meaning you can take advantage of the entire JavaScript ecosystem. And Svelte makes this really easy. In this video I'm going to cover how to use third-party JavaScript libraries in SvelteKit and ways to solve problems you're going to encounter along the way. That being said, of course, you can Sveltefy any JavaScript library and publish it as a package, which I'm going to cover in another video. Alright, so before we get started, don't forget to like and subscribe, because it helps me out a lot, and you can also become a patron. Alright friends, so before we get started and get into an actual example, I want to show you how to fix some common problems you might encounter in SvelteKit. Well, not might, you're probably going to encounter them 100%. So SvelteKit is the recommended way to build Svelte apps, and you don't have to use SvelteKit. Of course, the kit part is basically a server and it uses Svelte for the templating. So basically, SvelteKit is just a glorified server, right? But it's a lot more. You can check out my complete free course on SvelteKit. That being said, you're going to run into some weird issues when you have like a server where your code runs first on the server and the client, and then you get errors like window is not defined and etc, which I'm going to show you. So this assumes that you're using SvelteKit, but if you're not using SvelteKit, then these problems don't apply to you. But regardless, I think you're going to learn a lot. Alright, so to get started, I just have a regular SvelteKit project here. Let me go to my editor. I'm going to open the sidebar and nothing special here in the source. I just have a single page. So if I go to routes, I'm going to open page Svelte and then inside of a library, I'm just going to have a fake library here where I export some function. So that's basically it. Nothing special. And then I'm going to import it inside of my project here. So it's going to be greet. So let's invoke it. greet is going to auto import it for us which is really awesome so you might notice something i haven't saved yet but let's look at what happens so i'm here inside of my editor i press save and then it just works and you're like okay what are you talking about server and etc everything looks great right well yeah because we're in the browser context still but look what happens when you refresh the page your code is going to run on the server and which is going to cause an error so if you open the console this might look confusing to you right fail to load resource like this is some useless junk like who can decipher what's going on here but the thing is that this is happening on the server so this error is going to be inside your terminal here because it's the server reference error let's just zoom in it says reference error window is not defined and why is that well we have this library here which uses window alert and that's what libraries do they might use some browser api whatever and etc and then you're screwed all right so what is the first thing you can do well we can use on mount so we can wait for the dom to be loaded for the component to mount and then we can invoke the function so we can say on mount if you start typing it press enter you should have really great auto import so we can also pass it a callback here like this and now we can say greet let's invoke the function i'm going to place this here and now if we go here this is the previous one so let me just refresh for good measure and you can see it says high and we don't have any problems anymore all right so this works great but sometimes a library does some really weird things in their initialization because they don't expect their code to be running on the server right so you might have a library that does something like window alert so you have their initialization phase now you have a setup and now when you save it the problem you're going to see when you refresh is the import itself is going to cause an error because it's trying to use this browser api that doesn't exist on the server that is all right so how can you solve this problem if you run into something like this well you can use dynamic imports so i'm going to just comment this out and to use dynamic imports as simple as saying cons so you can say cons module equals actually let's just say import so we can also use the slip alias and let's console.log module i'm going to console.log it out so now we can see it's a promise pending so now we can go here let's say await and we can also make this async so now let's go here and now you can see module and you can see our function is going to look different if it uses a default export so you can just destructure that or whatever So back in our code to use this we can just destructure this function for this case So we can say greet, and now you can invoke it. So now you can say greet. Let me just save this, and now you can see it works high. Let me just refresh, and everything works great. And that's basically how you solve that problem. But let's say for example that you're working on a single page application and you don't really care about server-side rendering, we can disable server-side rendering. And not only that, but maybe just one part of your app doesn't use server-side rendering so you can disable it for a specific page or across your entire app. So let's see how we can do that. So I'm going to open my sidebar and inside of here we can just create a plusPage.ts for the current page, whatever route you're currently on, or if you want you can just rename this to layout like this you can use to layout and if you specify anything inside of here that is going to apply to your entire app but in this case maybe i just want to disable server-side rendering just for this specific route so i'm going to rename it back to page ts so how do we do that well it's really simple so we just open page ts we can go inside of here and then you can say export const SSR false. Alright, sweet. So now when we go here, let's go back to our editor. So now we can just import this. And let me just remove all of this code. We don't really need this to be async anymore. So now first we don't get any errors, right? So if I go here, let me just refresh everything. Awesome. Setup and etc. And now use a grid here. It even works without on mount, right? But you have to be careful if you're going to do some curing and etc. that you still place this inside of on mount. But right now server-side rendering is disabled. So this works as expected. And how beautiful is this, friends? Alright, friends. So let's look at using third-party JavaScript libraries. I'm going to use the framework-agnostic-javascript-library-motion1. So we can go to the motion1 page like this. So let me show you the thought process. So here we are on this page. And then we can just go to the quick start. I already installed it. if you want to follow along you can install it using npm install motion or pnpm whatever else you're using so we can look at the docs nothing special here but let's see how do we use it right so let's see creating an animation so you can see if i zoom in you can see it uses document query selector all and okay let's do the naive approach right so we can go here to our project and then let me just close all of these tabs which you don't need anymore so i'm also going to remove this import and let's remove this just so we start fresh all right so first thing we just look at the docs import animate from motion and that's basically it and if you're wondering i just have here a simple sentence or word that i'm going to split into letters and i just loop over them so we can do a cool animation and here are styles so i just have some letters here which i'm spacing out it's really important when you do something like this that you set the letter to be display block or in this case inline block if you want so basically that's that setup if you're curious all right so besides animate motion really makes it easy to use stagger so i'm going to also import that since we're going to use that and again let's just go from the start so we wait for the dome to load so we can say on mount we should get really great auto completion so now we're going to do the same thing pass it a callback because we really need this we need to wait for the dom to load right so the elements are on the page okay so we look at the docs right as i mentioned previously so we can say document query selector all in this case we want to select multiple elements we want to select the letters so we can worry the dom right nothing special we can say const letters and we can say document query selector all and I named it letter so we can do it like this let's log them out so we can say letters save this and go to our site we should see here we have all the letters how beautiful is this friends all right so now we can just use the API as normal so I can go here I'm going to say animate and then I going to pass some things so first we can pass the letters but I going to keep it on separate lines so it more readable So this is going to be the first argument And now here we're going to tell it what it needs to do. So we're going to transition the color to orange-red. And then on the Y we can specify a keyframe. So we can say 0, 30. And it's going to go to minus 60, then back to 0 again. And I also want rotate. So we can say 360 degrees. And awesome. Now we can also pass it options. So I can say duration. One second. So for the delay, we're going to use that stagger. Point one. And for the repeat, we can set infinity. Awesome. So let's save this and let's look at this cool effect. How cool is this, friends? They look like happy little letters. Alright, so now we can go back here. And now as you can see, everything works. we just looked at the documentation for motion one right and we implemented it without a problem and that's how simple things are using Svelte but of course this works but querying the DOM yourself is not a great idea and I advise against doing it outside Svelte actions maybe because as your app grows it's hard to reuse and this might cause problems so basically when you're using a JavaScript framework like Svelte you rarely want to touch the DOM yourself in these instances but But as you can see, doing something like this isn't bad. Alright, so what is the Svelte way of doing this? Well, the Svelte way of doing this is using the bind directive. So instead of querying the DOM yourself, you can use the bind element directive to get a reference to a DOM node. So for example, here for this particular letter, if you want to query this, you can say bind this, and then you bind it to a variable letter. But this is more than one letter, right? These are letters. Wow. So we can use an array actually. okay so let's just go here and then i'm going to remove letters like this and let me just also remove this comment since we don't need it then i'm going to go here and then i can say let letters and i can even give it a type html span element which is optional if you're not using typescript just ignore it so you can say hey this is an array we can also initialize it to an empty array so now here where we have letters we can pass it the index from the each loop so i'm going to use i and then i'm going to pass it like this so we can say letters so don't make this mistake all right so let me just console log it out as you can see here we already query them so i'm going to say console log letters and since they're not going to be immediately queried we can give it a reactive declaration like this okay so let's save it and now we should see it works the same as before and now we're querying the same element since we binded them and how beautiful is this friends And this is the Svelte way how to do things, but there's even a better way. So instead of using the bind directive, we can use one of my favorite Svelte features, which are Svelte actions. A Svelte action is just a reusable piece of code used to attach some behavior to an element. Of course, you can turn this into a component, but instead of turning it into a component, we can turn it into a simple reusable Svelte action. So let's see how we can do that. And I'm just going to cut the animate part. And now we don't even need on mount, because we're going to use a Svelte action which only runs when the component is mounted. So we don't need this. And now to create a Svelte action, which is just a regular function. So you can say function animate text. You can name it whatever you want. We also pass the element here or node. So I can say HTML, let's say div element. So we can do it like this. And I'm just going to cut animate here. And let me just comment this out for a second. so I want to log out element so you can say console log element just to see what's going on so how do we use this well basically instead of binding this we can just use this action on the container and now you can do whatever you want to get access to the node and this is just another simple way to get a reference to the node so we can say use so this is how we know it's a svelte action use animate text now we can save this let's go here so now let me just clear everything so things are easier to read. So now you can see we get the reference to the element itself. No weird wrappers no weird effects right We just get access to the pure DOM How beautiful is that friends And basically instead of console log let just say console derp so you can see what going on or console derp as i love to call it so now we can see here we have let me just see i'm going to do a find and we can see what we have here oh what is this children oh and you have also child notes but i'm going to use children so now we can go here and let me just remove this console log now i'm going to remove the comment from here. So now instead of letters, we can say, guess what? Element children. If you're using TypeScript, it's going to complain about this type being a HTML collection. So if you want to satisfy TypeScript, we can just turn it into an array so it's happy. Okay, let me just save this. And our animation works the same as before. How beautiful is this, friends? And that's how simple it is to use a svelte action. But we can take this a step further and encapsulate the entire logic inside the animate text svelte action because it's just JavaScript, right? We have a reference to the node. We can use JavaScript however we want. You can query things inside. You can do all sorts of crazy things. All right, so let me show you how simple that is actually. So I'm just going to go here and first we want to get the text from the node so we get the reference to the element, right now we can say const text equals element so now we want to get the inner text and let's also trim the white space just in case and now we can split it again the same as before again this is just javascript how beautiful this so now we can remove whatever value inside of the element we have so we can say element in our html or text whatever you want we just set it to blank so now we can loop over each letter and do something so now we can say for each letter and we can say element in our html we're just going to add to it so i'm going to use backticks here and i'm just going to create the same thing i have here with the spans so i'm going to say span i'm going to give it a class of letter we just do this and i'm going to close the span and right inside of here we're just going to interpolate the letter so we get that and basically that's it we don't have to change anything look how simple this is friend we just encapsulated the entire logic here so how do we use this i can just even delete this entire thing with confidence and how we can use a h1 for example which is going to be swelled so now we don't even have to loop over it right we can use an action use animate text let's give it the class letters and you can also have the styles inside of here but i don't want to in this example so as you see we created this simple action we just get the text we set it to blank then we loop over each letter we create the letters and then we just animate them as usual so look how beautiful this friends are going to save it and let's see if it works how beautiful is this friends look how simple this is and of course you can also pass parameters to the action so if we go here we can say for example color and then we can set some default value so we can say color orange red and then instead of setting the color here ourselves we can just pass the color so by default is going to be orange red but we can set something else so for example let's go here and then for anime text we can just do it like this we can set the color to something like spread. So let's see if it works. And how beautiful is this, friends? So you can see how simple this is. So Svelte actions are just another simple way to get a reference to an element, and then inside your action, you can do regular DOM manipulation, since it's just JavaScript. And of course, we can go here and reuse this. So let's just pop it over. And since I'm using CSS Grid for the main layout, let's just use it inside of a div here. And of course, you're going to have more semantic markup than this, right? Right? So I'm going to do it like this. And how beautiful is this, friends, right? Alright, so if you like what you've seen, don't forget to like and subscribe. And you can support me by becoming a patron. Thank you for watching and catch you in the next one. Peace. you